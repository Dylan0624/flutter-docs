<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flutter Development Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Add pako for decompression -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@4.0.12/lib/marked.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            line-height: 1.6;
            user-select: none;
        }
        
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            position: relative;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
            display: inline-block;
        }
        
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .secret-icon {
            position: absolute;
            top: 20px;
            right: 25px;
            color: transparent;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .secret-icon:hover {
            color: rgba(255, 255, 255, 0.03);
            transform: scale(1.1);
        }
        
        .nav-tabs {
            border-bottom: 3px solid #dee2e6;
            margin-bottom: 25px;
            background: white;
            border-radius: 10px 10px 0 0;
            padding: 5px 5px 0 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .nav-tabs .nav-link {
            border: none;
            color: #495057;
            font-weight: 500;
            padding: 15px 20px;
            margin-right: 5px;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
        }
        
        .nav-tabs .nav-link:hover {
            background-color: #f8f9fa;
            color: #667eea;
            transform: translateY(-2px);
        }
        
        .nav-tabs .nav-link.active {
            background-color: #667eea;
            color: white;
            font-weight: 600;
            box-shadow: 0 -2px 10px rgba(102, 126, 234, 0.3);
        }
        
        .tab-content {
            background-color: white;
            border-radius: 0 0 15px 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            min-height: 500px;
        }
        
        .content-wrapper {
            line-height: 1.7;
        }
        
        .content-wrapper h1 {
            color: #2c3e50;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
            margin-bottom: 25px;
            font-weight: 700;
        }
        
        .content-wrapper h2 {
            color: #34495e;
            margin-top: 35px;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .content-wrapper h3 {
            color: #5a6c7d;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .content-wrapper pre {
            background-color: #2d3748;
            border-radius: 10px;
            padding: 25px;
            overflow-x: auto;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .content-wrapper code {
            background-color: #f1f3f4;
            padding: 3px 8px;
            border-radius: 5px;
            font-family: 'Courier New', Courier, monospace;
            color: #d63384;
            font-size: 0.9em;
        }
        
        .content-wrapper pre code {
            background-color: transparent;
            padding: 0;
            color: #e2e8f0;
        }
        
        .encrypted-content {
            text-align: center;
            padding: 50px 20px;
        }
        
        .password-input-container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .password-input-container h4 {
            color: #e74c3c;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .password-hint {
            margin-bottom: 25px;
        }
        
        .password-hint .alert {
            text-align: left;
            border-radius: 10px;
            border: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .password-attempts {
            margin-top: 10px;
        }
        
        .decrypted-content {
            text-align: left;
            line-height: 1.7;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .alert {
            border-radius: 10px;
            margin-bottom: 25px;
            border: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn {
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .form-control {
            border-radius: 8px;
            border: 2px solid #e9ecef;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .input-group {
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .error-shake {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .success-animation {
            animation: success 0.6s ease-in-out;
        }
        
        @keyframes success {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        @media (max-width: 768px) {
            .main-container {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tab-content {
                padding: 20px 15px;
            }
            
            .nav-tabs .nav-link {
                padding: 12px 15px;
                font-size: 0.9rem;
            }
            
            .secret-icon {
                top: 15px;
                right: 20px;
                font-size: 1rem;
            }
        }
        
        #debug-log {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: #fff;
            padding: 10px;
            border: 1px solid #ccc;
            max-height: 200px;
            overflow-y: auto;
            font-size: 0.8rem;
            display: block;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            width: 300px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <h1><i class="fab fa-flutter"></i> Flutter Development Documentation <i class="fas fa-rocket secret-icon" onclick="showSecrets()" title="Hidden Content"></i></h1>
            <p>Complete Flutter Development Experience Sharing</p>
        </div>
        
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            
                <li class="nav-item">
                    <a class="nav-link active" id="0.-overview-tab" data-bs-toggle="tab" 
                       href="#0.-overview" role="tab" aria-controls="0.-overview" 
                       aria-selected="true">
                        Flutter 開發心得總覽
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link " id="1.-getting-started-tab" data-bs-toggle="tab" 
                       href="#1.-getting-started" role="tab" aria-controls="1.-getting-started" 
                       aria-selected="false">
                        Flutter 入門指南從零開始
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link " id="2.-assets-and-config-tab" data-bs-toggle="tab" 
                       href="#2.-assets-and-config" role="tab" aria-controls="2.-assets-and-config" 
                       aria-selected="false">
                        Flutter 資源管理與配置指南
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link " id="3.-widgets-tab" data-bs-toggle="tab" 
                       href="#3.-widgets" role="tab" aria-controls="3.-widgets" 
                       aria-selected="false">
                        Flutter Widget 解析開發指南
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link " id="4.-data-type-tab" data-bs-toggle="tab" 
                       href="#4.-data-type" role="tab" aria-controls="4.-data-type" 
                       aria-selected="false">
                        Flutter Dart 資料型別與函數完全指南
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link " id="5.-project-framework-tab" data-bs-toggle="tab" 
                       href="#5.-project-framework" role="tab" aria-controls="5.-project-framework" 
                       aria-selected="false">
                        Flutter 專案架構設計模組化指南
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link " id="6.-project-design-tab" data-bs-toggle="tab" 
                       href="#6.-project-design" role="tab" aria-controls="6.-project-design" 
                       aria-selected="false">
                        Flutter 專案設計與架構管理指南
                    </a>
                </li>
            
                <li class="nav-item d-none" id="secrets-nav-item">
                    <a class="nav-link" id="secrets-tab" data-bs-toggle="tab" 
                       href="#secrets" role="tab" aria-controls="secrets" 
                       aria-selected="false">
                    </a>
                </li>
            
        </ul>
        
        <div class="tab-content" id="myTabContent">
            
                <div class="tab-pane fade show active" id="0.-overview" 
                     role="tabpanel" aria-labelledby="0.-overview-tab">
                    <div class="content-wrapper">
                        <h1>Flutter 開發心得總覽</h1>
<p>這是我在 Flutter 開發過程中累積的經驗分享。</p>
<h2>🎯 學習目標</h2>
<ul>
<li>掌握 Flutter 基礎概念</li>
<li>學會狀態管理</li>
<li>了解效能優化技巧</li>
</ul>
<blockquote>
<p><strong>💡 提醒</strong><br />
這份文檔會持續更新，記錄最新的開發心得。</p>
</blockquote>
<h2>📚 內容架構</h2>
<p>本文檔涵蓋以下主要領域：</p>
<h3>基礎概念</h3>
<ul>
<li>Widget 生命週期</li>
<li>狀態管理基礎</li>
<li>佈局系統理解</li>
</ul>
<h3>實戰經驗</h3>
<ul>
<li>專案開發流程</li>
<li>常見問題解決</li>
<li>效能優化實踐</li>
</ul>
<h3>進階技巧</h3>
<ul>
<li>自訂 Widget 開發</li>
<li>插件整合應用</li>
<li>測試策略制定</li>
</ul>
<h2>🚀 開始學習</h2>
<p>建議按照以下順序閱讀各章節：</p>
<ol>
<li><strong>基礎 Widget</strong> - 了解 Flutter 的核心概念</li>
<li><strong>狀態管理</strong> - 掌握應用程式狀態控制</li>
<li><strong>佈局設計</strong> - 學習響應式介面設計</li>
<li><strong>效能優化</strong> - 提升應用程式執行效率</li>
<li><strong>測試部署</strong> - 確保代碼品質與穩定性</li>
</ol>
<h2>💭 學習心得</h2>
<p>透過實際開發多個 Flutter 專案，我發現最重要的是：</p>
<ul>
<li><strong>理解 Widget 樹</strong> - 這是 Flutter 的核心概念</li>
<li><strong>善用狀態管理</strong> - 選擇適合的狀態管理方案</li>
<li><strong>重視使用者體驗</strong> - 流暢的動畫和響應式設計</li>
<li><strong>持續學習更新</strong> - Flutter 生態系統快速發展</li>
</ul>
<h2>🔧 開發環境</h2>
<p>推薦的開發工具和設定：</p>
<ul>
<li><strong>IDE</strong>: Visual Studio Code 或 Android Studio</li>
<li><strong>擴充套件</strong>: Flutter、Dart、Flutter Widget Snippets</li>
<li><strong>除錯工具</strong>: Flutter Inspector、Dart DevTools</li>
<li><strong>版本控制</strong>: Git 搭配適當的 .gitignore 設定</li>
</ul>
<h2>📖 參考資源</h2>
<h3>官方文檔</h3>
<ul>
<li><a href="https://flutter.dev">Flutter 官方網站</a></li>
<li><a href="https://dart.dev">Dart 程式語言文檔</a></li>
<li><a href="https://api.flutter.dev">Flutter API 參考</a></li>
</ul>
<h3>社群資源</h3>
<ul>
<li>Flutter Community</li>
<li>Stack Overflow Flutter 標籤</li>
<li>GitHub Flutter 範例專案</li>
</ul>
<h2>🌍 Flutter 跨平台優勢詳解</h2>
<h3>為什麼選擇 Flutter？</h3>
<p>Flutter 作為 Google 開發的跨平台框架，在移動應用開發領域帶來了革命性的改變。以下是選擇 Flutter 的核心優勢：</p>
<h3>📱 真正的跨平台統一</h3>
<p><strong>一套代碼，多平台運行</strong>
- <strong>iOS 和 Android</strong>: 同一套 Dart 代碼可以編譯為原生應用
- <strong>Web 應用</strong>: 透過 Flutter Web 直接部署到瀏覽器
- <strong>桌面應用</strong>: 支援 Windows、macOS、Linux 桌面應用開發
- <strong>嵌入式設備</strong>: 可運行於車載系統、智慧電視等設備</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// 一套代碼示例 - 跨平台通用</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CrossPlatformWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;跨平台應用&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">// 在所有平台都能正常顯示</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// 同樣的邏輯在所有平台執行</span>
<span class="w">            </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;按鈕點擊 - 跨平台通用&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;通用按鈕&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>⚡ 卓越的效能表現</h3>
<p><strong>接近原生的執行速度</strong>
- <strong>編譯優勢</strong>: Dart 代碼編譯為原生機器碼，而非解釋執行
- <strong>渲染引擎</strong>: 使用 Skia 圖形引擎，直接操作 GPU 進行繪製
- <strong>60fps 流暢度</strong>: 預設支援 60fps，高端設備可達 120fps
- <strong>記憶體管理</strong>: 高效的垃圾回收機制，減少記憶體洩漏</p>
<p><strong>效能數據對比</strong>:</p>
<div class="codehilite"><pre><span></span><code>原生 iOS/Android: 100% 效能基準
Flutter: 95-98% 效能 (幾乎無差異)
React Native: 85-90% 效能
Cordova/PhoneGap: 60-70% 效能
</code></pre></div>

<h3>💰 開發成本大幅降低</h3>
<p><strong>人力成本節約</strong>
- <strong>單一團隊</strong>: 不需要分別維護 iOS 和 Android 團隊
- <strong>學習成本</strong>: 開發者只需學習 Dart 語言和 Flutter 框架
- <strong>維護簡化</strong>: 一套代碼維護，bug 修復一次全平台生效</p>
<p><strong>時間成本優勢</strong>
- <strong>開發週期</strong>: 相比原生開發節省 40-60% 開發時間
- <strong>功能迭代</strong>: 新功能同步發佈到所有平台
- <strong>測試週期</strong>: 減少跨平台測試的重複工作</p>
<p><strong>實際案例分析</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="err">傳統開發模式</span><span class="o">:</span>
<span class="n">iOS</span><span class="w"> </span><span class="err">開發</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="err">個月</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Android</span><span class="w"> </span><span class="err">開發</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="err">個月</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="err">個月</span>
<span class="err">測試調優</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="err">個月</span><span class="w"> </span><span class="err">×</span><span class="w"> </span><span class="mi">2</span><span class="err">平台</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="err">個月</span>
<span class="err">總計</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span><span class="err">個月</span>

<span class="n">Flutter</span><span class="w"> </span><span class="err">開發模式</span><span class="o">:</span>
<span class="err">跨平台開發</span><span class="o">:</span><span class="w"> </span><span class="mf">3.5</span><span class="err">個月</span>
<span class="err">跨平台測試</span><span class="o">:</span><span class="w"> </span><span class="mf">0.5</span><span class="err">個月</span>
<span class="err">總計</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="err">個月</span><span class="w"> </span><span class="o">(</span><span class="err">節省</span><span class="mi">50</span><span class="o">%</span><span class="err">時間</span><span class="o">)</span>
</code></pre></div>

<h3>🎨 一致的使用者體驗</h3>
<p><strong>視覺一致性</strong>
- <strong>Material Design</strong>: 完整支援 Google 設計語言
- <strong>Cupertino Design</strong>: 完美模擬 iOS 原生設計風格
- <strong>自訂主題</strong>: 輕鬆建立品牌專屬的設計系統
- <strong>響應式佈局</strong>: 自動適應不同螢幕尺寸和解析度</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// 平台自適應設計示例</span>
<span class="n">Widget</span><span class="w"> </span><span class="n">buildPlatformButton</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Platform</span><span class="p">.</span><span class="n">isIOS</span><span class="w"> </span>
<span class="w">    </span><span class="o">?</span><span class="w"> </span><span class="n">CupertinoButton</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;iOS風格按鈕&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Android風格按鈕&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">      </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3>🔥 熱重載開發體驗</h3>
<p><strong>極速開發迭代</strong>
- <strong>毫秒級更新</strong>: 代碼修改後毫秒內看到效果
- <strong>狀態保持</strong>: 熱重載時保持應用程式狀態
- <strong>即時調試</strong>: 實時修改 UI 和邏輯，立即驗證效果</p>
<h3>🏗️ 豐富的生態系統</h3>
<p><strong>強大的套件庫</strong>
- <strong>pub.dev</strong>: 超過 30,000+ 開源套件
- <strong>官方套件</strong>: Firebase、Google Maps、相機等官方支援
- <strong>社群活躍</strong>: 持續更新和維護的第三方套件</p>
<p><strong>企業級支援</strong>
- <strong>Google 背景</strong>: 穩定的技術支援和長期發展保證
- <strong>大型企業採用</strong>: 阿里巴巴、BMW、eBay 等知名企業使用
- <strong>活躍社群</strong>: 全球開發者社群提供豐富資源</p>
<h3>📊 市場採用情況</h3>
<p><strong>知名應用案例</strong>
- <strong>Google Ads</strong>: Google 自家廣告管理應用
- <strong>阿里巴巴</strong>: 閒魚二手交易平台
- <strong>BMW</strong>: BMW 車載應用系統
- <strong>eBay Motors</strong>: eBay 汽車交易應用
- <strong>Reflectly</strong>: 獲獎的日記應用</p>
<h3>🚀 未來發展趨勢</h3>
<p><strong>技術發展方向</strong>
- <strong>Fuchsia OS</strong>: Google 新作業系統的預設開發框架
- <strong>桌面應用</strong>: Windows、macOS、Linux 桌面應用支援日趨成熟
- <strong>Web 應用</strong>: PWA 和 SPA 開發能力持續增強
- <strong>嵌入式系統</strong>: IoT 和車載系統開發支援</p>
<h3>💡 選擇 Flutter 的最佳時機</h3>
<p><strong>適合 Flutter 的專案類型</strong>
- 需要快速上市的 MVP 產品
- 預算有限但需要高品質應用
- 需要統一品牌體驗的企業應用
- 創業公司的核心產品開發</p>
<p><strong>不適合的情況</strong>
- 需要大量平台特定功能的應用
- 對效能要求極致的遊戲應用
- 團隊已有深厚原生開發經驗且時間充裕</p>
<h2>🎉 開始你的 Flutter 之旅</h2>
<p>Flutter 不僅僅是一個開發框架，更是現代移動應用開發的最佳解決方案。它完美平衡了開發效率、應用效能和使用者體驗，讓開發者能夠專注於創造優秀的產品，而非處理平台差異的技術細節。</p>
<p>透過系統性的學習和實踐，你將能夠：
- 🎯 快速建構高品質跨平台應用
- 💰 大幅降低開發和維護成本<br />
- 🚀 縮短產品上市時間
- 🌟 提供一致的使用者體驗</p>
<p>記住，學習程式設計最重要的是動手實作。理論知識固然重要，但只有透過實際編寫代碼，才能真正掌握 Flutter 的精髓。</p>
<p><strong>選擇 Flutter，就是選擇未來！</strong> 🚀</p>
                    </div>
                </div>
            
                <div class="tab-pane fade " id="1.-getting-started" 
                     role="tabpanel" aria-labelledby="1.-getting-started-tab">
                    <div class="content-wrapper">
                        <h1>Flutter 入門指南從零開始</h1>
<h2>🚀 Flutter 簡介</h2>
<p>Flutter 是 Google 開發的開源 UI 工具包，讓你可以用單一程式碼庫建構美觀、原生編譯的移動、Web 和桌面應用程式。</p>
<h3>為什麼選擇 Flutter？</h3>
<ul>
<li>⚡ <strong>快速開發</strong>：熱重載功能讓你即時看到程式碼變更</li>
<li>🎨 <strong>表現力強的美觀UI</strong>：豐富的 Material Design 和 Cupertino 組件</li>
<li>🏃 <strong>原生性能</strong>：編譯為 ARM 和 x64 原生程式碼</li>
<li>📱 <strong>跨平台</strong>：一套程式碼支援 iOS、Android、Web、桌面</li>
</ul>
<hr />
<h2>🎓 學習路徑建議</h2>
<h3>基礎概念</h3>
<ul>
<li>[ ] 完成環境設定</li>
<li>[ ] 理解 Widget 概念</li>
<li>[ ] 學會基本佈局 (Row, Column, Container)</li>
<li>[ ] 練習 StatelessWidget 和 StatefulWidget</li>
<li>[ ] 完成第一個自訂應用程式</li>
<li>[ ] 在頁面標題找彩蛋</li>
</ul>
<h3>UI 開發</h3>
<ul>
<li>[ ] 學習 Material Design Widget</li>
<li>[ ] 掌握 ListView 和 GridView</li>
<li>[ ] 理解導航和路由</li>
<li>[ ] 練習表單輸入和驗證</li>
<li>[ ] 學習主題和樣式</li>
<li>[ ] 不是這個分頁的標題</li>
</ul>
<h3>狀態管理</h3>
<ul>
<li>[ ] 理解 setState 的使用</li>
<li>[ ] 學習 InheritedWidget</li>
<li>[ ] 嘗試 Provider 套件</li>
<li>[ ] 理解狀態管理的最佳實踐</li>
<li>[ ] 是整個標題 (Flutter Development Documentation)</li>
</ul>
<h3>進階功能</h3>
<ul>
<li>[ ] 網路請求和 API 整合</li>
<li>[ ] 本地資料儲存</li>
<li>[ ] 圖片處理和快取</li>
<li>[ ] 動畫基礎</li>
<li>[ ] 對就是紫色那個底圖標題</li>
</ul>
<h3>實戰專案</h3>
<ul>
<li>[ ] 規劃一個完整的應用程式</li>
<li>[ ] 實作核心功能</li>
<li>[ ] 加入錯誤處理</li>
<li>[ ] 優化使用者體驗</li>
<li>[ ] 在背景上</li>
</ul>
<h3>部署和優化</h3>
<ul>
<li>[ ] 學習應用程式打包</li>
<li>[ ] 效能優化技巧</li>
<li>[ ] 測試策略</li>
<li>[ ] 準備發佈到商店</li>
<li>[ ] 右上角有個隱藏 icon</li>
</ul>
<hr />
<h2>📚 推薦學習資源</h2>
<h3>官方資源</h3>
<ul>
<li><a href="https://flutter.dev/docs">Flutter 官方文檔</a></li>
<li><a href="https://dart.dev/guides/language/language-tour">Dart 語言導覽</a></li>
<li><a href="https://flutter.dev/docs/development/ui/widgets">Flutter Widget 目錄</a></li>
<li><a href="https://flutter.dev/docs/cookbook">Flutter Cookbook</a></li>
</ul>
<h3>線上課程</h3>
<ul>
<li><a href="https://flutter.dev/docs/codelabs">Flutter 官方 Codelabs</a></li>
<li><a href="https://www.udemy.com/topic/flutter/">Udemy Flutter 課程</a></li>
<li><a href="https://www.youtube.com/c/flutterdev">YouTube Flutter 頻道</a></li>
</ul>
<h3>實用工具</h3>
<ul>
<li><a href="https://dartpad.dev/">DartPad</a> - 線上 Dart 編輯器</li>
<li><a href="https://flutter-widget.live/">Flutter Widget Livebook</a> - Widget 即時預覽</li>
<li><a href="https://pub.dev/">pub.dev</a> - Dart 套件庫</li>
</ul>
<h3>社群資源</h3>
<ul>
<li><a href="https://flutter.cn/">Flutter 中文網</a></li>
<li><a href="https://www.facebook.com/groups/flutter.taiwan/">Flutter 台灣社群</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/flutter">Stack Overflow Flutter 標籤</a></li>
<li><a href="https://www.reddit.com/r/FlutterDev/">Reddit Flutter 社區</a></li>
</ul>
<hr />
<h2>🏆 專案實戰建議</h2>
<h3>初學者專案</h3>
<ol>
<li><strong>個人名片應用程式</strong> - 練習基本佈局和樣式</li>
<li><strong>BMI 計算器</strong> - 學習輸入處理和計算</li>
<li><strong>待辦事項列表</strong> - 掌握狀態管理</li>
<li><strong>簡單計算機</strong> - 理解事件處理</li>
<li><strong>天氣應用程式</strong> - 學習 API 整合</li>
</ol>
<h3>進階專案</h3>
<ol>
<li><strong>記帳應用程式</strong> - 完整的 CRUD 操作</li>
<li><strong>聊天應用程式</strong> - 即時通訊功能</li>
<li><strong>電子商務應用程式</strong> - 複雜的狀態管理</li>
<li><strong>社交媒體應用程式</strong> - 圖片處理和分享</li>
<li><strong>健身追蹤應用程式</strong> - 感測器整合</li>
</ol>
<h3>專案開發流程</h3>
<h4>1. 規劃階段</h4>
<div class="codehilite"><pre><span></span><code>需求分析 → 功能規格 → UI/UX 設計 → 技術架構
</code></pre></div>

<h4>2. 開發階段</h4>
<div class="codehilite"><pre><span></span><code>專案設定 → 基礎架構 → 功能開發 → 測試 → 優化
</code></pre></div>

<h4>3. 部署階段</h4>
<div class="codehilite"><pre><span></span><code>打包應用程式 → 商店審核 → 發佈 → 維護更新
</code></pre></div>

<hr />
<h2>🛠️ 開發最佳實踐</h2>
<h3>程式碼組織</h3>
<div class="codehilite"><pre><span></span><code><span class="n">lib</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="n">main</span><span class="o">.</span><span class="n">dart</span><span class="w">           </span><span class="c1"># 應用程式入口</span>
<span class="err">├──</span><span class="w"> </span><span class="n">models</span><span class="o">/</span><span class="w">            </span><span class="c1"># 資料模型</span>
<span class="err">├──</span><span class="w"> </span><span class="n">screens</span><span class="o">/</span><span class="w">           </span><span class="c1"># 畫面頁面</span>
<span class="err">├──</span><span class="w"> </span><span class="n">widgets</span><span class="o">/</span><span class="w">           </span><span class="c1"># 自訂 Widget</span>
<span class="err">├──</span><span class="w"> </span><span class="n">services</span><span class="o">/</span><span class="w">          </span><span class="c1"># 業務邏輯服務</span>
<span class="err">├──</span><span class="w"> </span><span class="n">utils</span><span class="o">/</span><span class="w">             </span><span class="c1"># 工具函數</span>
<span class="err">└──</span><span class="w"> </span><span class="n">constants</span><span class="o">/</span><span class="w">         </span><span class="c1"># 常數定義</span>
</code></pre></div>

<h3>命名規範</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 類別：PascalCase</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{}</span>

<span class="c1">// 變數和函數：camelCase</span>
<span class="kt">String</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;John&#39;</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="n">updateUserInfo</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>

<span class="c1">// 常數：SCREAMING_SNAKE_CASE</span>
<span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">API_BASE_URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://api.example.com&#39;</span><span class="p">;</span>

<span class="c1">// 檔名：snake_case</span>
<span class="n">user_profile_screen</span><span class="p">.</span><span class="n">dart</span>
</code></pre></div>

<h3>註釋規範</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">/// 使用者個人資料 Widget</span>
<span class="c1">/// </span>
<span class="c1">/// 顯示使用者的基本資訊，包括頭像、姓名和聯絡方式</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">/// 使用者 ID</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">;</span>

<span class="w">  </span><span class="c1">/// 是否顯示編輯按鈕</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">showEditButton</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">UserProfile</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">userId</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">showEditButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// TODO: 實作使用者資料載入邏輯</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>錯誤處理</h3>
<div class="codehilite"><pre><span></span><code><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fetchUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">apiUrl</span><span class="s1">/users/</span><span class="si">$</span><span class="n">userId</span><span class="s1">&#39;</span><span class="p">));</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">User</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">HttpException</span><span class="p">(</span><span class="s1">&#39;Failed to load user: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kd">on</span><span class="w"> </span><span class="n">SocketException</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">NetworkException</span><span class="p">(</span><span class="s1">&#39;No internet connection&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kd">on</span><span class="w"> </span><span class="n">HttpException</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">rethrow</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">UnknownException</span><span class="p">(</span><span class="s1">&#39;Unknown error occurred: </span><span class="si">$</span><span class="n">e</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔍 偵錯技巧</h2>
<h3>1. 使用 Debug Console</h3>
<div class="codehilite"><pre><span></span><code><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Debug message: </span><span class="si">$</span><span class="n">variable</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="n">debugPrint</span><span class="p">(</span><span class="s1">&#39;Debug info: </span><span class="si">${</span><span class="n">object</span><span class="p">.</span><span class="n">toString</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
</code></pre></div>

<h3>2. Flutter Inspector</h3>
<ul>
<li>檢視 Widget 樹狀結構</li>
<li>查看 Widget 屬性</li>
<li>測量和對齊工具</li>
</ul>
<h3>3. 常用偵錯指令</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 開啟偵錯模式</span>
flutter<span class="w"> </span>run<span class="w"> </span>--debug

<span class="c1"># 檢視效能</span>
flutter<span class="w"> </span>run<span class="w"> </span>--profile

<span class="c1"># 檢視應用程式大小</span>
flutter<span class="w"> </span>build<span class="w"> </span>apk<span class="w"> </span>--analyze-size

<span class="c1"># 檢視相依性</span>
flutter<span class="w"> </span>deps
</code></pre></div>

<h3>4. 偵錯 Widget</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">DebugContainer</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">DebugContainer</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">child</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">        </span><span class="nl">border:</span><span class="w"> </span><span class="n">Border</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="w"> </span><span class="nl">width:</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">child</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用方式</span>
<span class="n">DebugContainer</span><span class="p">(</span>
<span class="w">  </span><span class="nl">child:</span><span class="w"> </span><span class="n">YourWidget</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div>

<hr />
<h2>📋 檢查清單</h2>
<h3>開發環境檢查</h3>
<ul>
<li>[ ] Flutter SDK 已安裝並在 PATH 中</li>
<li>[ ] <code>flutter doctor</code> 無重大問題</li>
<li>[ ] IDE 已安裝 Flutter 插件</li>
<li>[ ] 模擬器或實體裝置可正常使用</li>
<li>[ ] 能成功執行 <code>flutter create</code> 和 <code>flutter run</code></li>
</ul>
<h3>程式碼品質檢查</h3>
<ul>
<li>[ ] 程式碼格式化 (<code>flutter format .</code>)</li>
<li>[ ] 靜態分析無警告 (<code>flutter analyze</code>)</li>
<li>[ ] 測試覆蓋率足夠 (<code>flutter test</code>)</li>
<li>[ ] 效能測試通過 (<code>flutter run --profile</code>)</li>
<li>[ ] 記憶體洩漏檢查</li>
</ul>
<h3>發佈前檢查</h3>
<ul>
<li>[ ] 應用程式圖示和名稱正確</li>
<li>[ ] 版本號碼已更新</li>
<li>[ ] 權限設定正確</li>
<li>[ ] 在不同裝置上測試</li>
<li>[ ] 離線功能測試</li>
<li>[ ] 網路錯誤處理測試</li>
</ul>
<hr />
<h2>🎯 下一步計劃</h2>
<h3>立即行動</h3>
<ol>
<li><strong>完成環境設定</strong> - 確保開發環境正常運作</li>
<li><strong>建立第一個應用程式</strong> - 跟著指南建立個人名片應用程式</li>
<li><strong>學習 Dart 基礎</strong> - 如果還不熟悉 Dart 語言</li>
<li><strong>閱讀官方文檔</strong> - 深入了解 Flutter 核心概念</li>
</ol>
<h3>短期目標 (1-2 個月)</h3>
<ol>
<li><strong>掌握基礎 Widget</strong> - 能熟練使用常用 Widget</li>
<li><strong>理解狀態管理</strong> - 知道何時使用 StatefulWidget</li>
<li><strong>完成第一個實用應用程式</strong> - 如待辦事項或計算機</li>
<li><strong>學會偵錯技巧</strong> - 能獨立解決常見問題</li>
</ol>
<h3>中期目標 (3-6 個月)</h3>
<ol>
<li><strong>掌握進階概念</strong> - 導航、動畫、網路請求</li>
<li><strong>學習狀態管理方案</strong> - Provider, Riverpod, 或 Bloc</li>
<li><strong>完成複雜專案</strong> - 具有後端整合的完整應用程式</li>
<li><strong>理解效能優化</strong> - 能識別和解決效能問題</li>
</ol>
<h3>長期目標 (6 個月以上)</h3>
<ol>
<li><strong>成為 Flutter 專家</strong> - 能指導其他開發者</li>
<li><strong>貢獻開源專案</strong> - 為 Flutter 生態系統做出貢獻</li>
<li><strong>發佈商業應用程式</strong> - 在應用程式商店發佈產品</li>
<li><strong>持續學習新技術</strong> - 跟上 Flutter 發展趨勢</li>
</ol>
<hr />
<h2>🌟 激勵話語</h2>
<blockquote>
<p>「每一個專家都曾經是初學者。每一個專業人士都曾經是業餘愛好者。每一個著名的人都曾經是無名小卒。」</p>
</blockquote>
<h3>記住這些重點：</h3>
<ol>
<li><strong>學習是一個過程</strong> - 不要期望立即成為專家</li>
<li><strong>動手實作最重要</strong> - 光看不練是不夠的</li>
<li><strong>犯錯是正常的</strong> - 從錯誤中學習成長</li>
<li><strong>社群很重要</strong> - 積極參與社群討論</li>
<li><strong>持續練習</strong> - 每天寫一點程式碼</li>
<li><strong>保持好奇心</strong> - 不斷探索新功能和最佳實踐</li>
</ol>
<h3>開始你的 Flutter 之旅！</h3>
<p>現在你已經有了完整的入門指南，是時候開始動手實作了！記住，最好的學習方式就是實際建構應用程式。從簡單的專案開始，逐步挑戰更複雜的功能。</p>
<p><strong>祝你在 Flutter 開發的道路上一帆風順！</strong> 🚀</p>
<hr />
<h2>📞 需要協助？</h2>
<p>如果在學習過程中遇到問題，可以：</p>
<ol>
<li><strong>查看官方文檔</strong> - 通常有詳細的解答</li>
<li><strong>搜尋 Stack Overflow</strong> - 很多常見問題已有解答</li>
<li><strong>加入社群討論</strong> - 與其他開發者交流經驗</li>
<li><strong>查看 GitHub Issues</strong> - 可能是已知的 bug</li>
<li><strong>觀看教學影片</strong> - 視覺化學習更容易理解</li>
</ol>
<p>記住，每個開發者在學習過程中都會遇到挫折，重要的是保持耐心和持續學習的態度。Flutter 社群非常友善和樂於助人，不要害怕提問！</p>
<p><strong>開始編程，享受創造的樂趣！</strong> ✨📋 環境準備</p>
<h3>系統需求</h3>
<p><strong>Windows</strong></p>
<ul>
<li>Windows 10 或更新版本 (64-bit)</li>
<li>磁碟空間：2.8 GB (不包含 IDE/工具的磁碟空間)</li>
</ul>
<p><strong>macOS</strong></p>
<ul>
<li>macOS (64-bit)</li>
<li>磁碟空間：2.8 GB (不包含 IDE/工具的磁碟空間)</li>
</ul>
<p><strong>Linux</strong></p>
<ul>
<li>Linux (64-bit)</li>
<li>磁碟空間：600 MB (不包含 IDE/工具的磁碟空間)</li>
</ul>
<h3>必要工具安裝</h3>
<h4>1. 安裝 Flutter SDK</h4>
<p><strong>方法一：直接下載 (推薦)</strong></p>
<ol>
<li>前往 <a href="https://flutter.dev/docs/get-started/install">Flutter 官網</a></li>
<li>下載對應作業系統的 Flutter SDK</li>
<li>解壓縮到你想要的位置（例如：<code>C:\flutter</code> 或 <code>~/flutter</code>）</li>
<li>將 Flutter bin 目錄加入系統 PATH</li>
</ol>
<p><strong>Windows 設定 PATH：</strong></p>
<div class="codehilite"><pre><span></span><code># 開啟 PowerShell 或命令提示字元
# 將 Flutter 加入 PATH（替換成你的路徑）
setx PATH &quot;%PATH%;C:\flutter\bin&quot;
</code></pre></div>

<p><strong>macOS/Linux 設定 PATH：</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 編輯 ~/.bashrc 或 ~/.zshrc</span>
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export PATH=&quot;$PATH:`pwd`/flutter/bin&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
<span class="c1"># 重新載入</span>
<span class="nb">source</span><span class="w"> </span>~/.bashrc
</code></pre></div>

<p><strong>方法二：使用套件管理器</strong></p>
<p><strong>macOS (使用 Homebrew):</strong></p>
<div class="codehilite"><pre><span></span><code>brew<span class="w"> </span>install<span class="w"> </span>--cask<span class="w"> </span>flutter
</code></pre></div>

<p><strong>Windows (使用 Chocolatey):</strong></p>
<div class="codehilite"><pre><span></span><code>choco install flutter
</code></pre></div>

<h4>2. 驗證安裝</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># 檢查 Flutter 版本</span>
flutter<span class="w"> </span>--version

<span class="c1"># 執行 Flutter doctor 檢查環境</span>
flutter<span class="w"> </span>doctor
</code></pre></div>

<h4>3. 安裝開發工具</h4>
<p><strong>Android Studio (推薦)</strong></p>
<ol>
<li>下載並安裝 <a href="https://developer.android.com/studio">Android Studio</a></li>
<li>安裝 Flutter 和 Dart 插件：</li>
<li>開啟 Android Studio</li>
<li>前往 <strong>File &gt; Settings &gt; Plugins</strong></li>
<li>搜尋並安裝 <strong>Flutter</strong> 插件（會自動安裝 Dart）</li>
</ol>
<p><strong>Visual Studio Code (輕量選擇)</strong></p>
<ol>
<li>下載並安裝 <a href="https://code.visualstudio.com/">VS Code</a></li>
<li>安裝擴充套件：</li>
<li><strong>Flutter</strong> (自動包含 Dart)</li>
<li><strong>Dart Code</strong></li>
<li><strong>Flutter Widget Snippets</strong></li>
</ol>
<h4>4. 設定開發裝置</h4>
<p><strong>Android 開發設定：</strong></p>
<ol>
<li>在 Android Studio 中開啟 <strong>AVD Manager</strong></li>
<li>建立新的虛擬裝置或連接實體 Android 裝置</li>
<li>啟用開發者選項和 USB 偵錯</li>
</ol>
<p><strong>iOS 開發設定 (僅 macOS)：</strong></p>
<ol>
<li>安裝 Xcode</li>
<li>開啟 iOS 模擬器或連接實體 iOS 裝置</li>
<li>設定開發者帳號 (用於實體裝置測試)</li>
</ol>
<hr />
<h2>🎯 第一個 Flutter 應用程式</h2>
<h3>建立新專案</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 建立新的 Flutter 專案</span>
flutter<span class="w"> </span>create<span class="w"> </span>my_first_app

<span class="c1"># 進入專案目錄</span>
<span class="nb">cd</span><span class="w"> </span>my_first_app

<span class="c1"># 執行應用程式</span>
flutter<span class="w"> </span>run
</code></pre></div>

<h3>專案結構說明</h3>
<div class="codehilite"><pre><span></span><code>my_first_app/
├── android/          # Android 平台特定檔案
├── ios/              # iOS 平台特定檔案
├── lib/              # Dart 程式碼主目錄
│   └── main.dart     # 應用程式入口點
├── test/             # 測試檔案
├── web/              # Web 平台特定檔案
├── pubspec.yaml      # 專案配置和依賴項
└── README.md
</code></pre></div>

<h3>理解 main.dart</h3>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>

<span class="c1">// 應用程式的入口點</span>
<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="p">}</span>

<span class="c1">// 主應用程式 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MyApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Flutter Demo&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<span class="w">        </span><span class="nl">primarySwatch:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">MyHomePage</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Flutter Demo Home Page&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 首頁 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MyHomePage</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">MyHomePage</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">title</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_MyHomePageState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_MyHomePageState</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// 首頁狀態類別</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">_MyHomePageState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">MyHomePage</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_incrementCounter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_counter</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">title</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span><span class="p">[</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;You have pushed the button this many times:&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_counter</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">Theme</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">textTheme</span><span class="p">.</span><span class="n">headline4</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">floatingActionButton:</span><span class="w"> </span><span class="n">FloatingActionButton</span><span class="p">(</span>
<span class="w">        </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_incrementCounter</span><span class="p">,</span>
<span class="w">        </span><span class="nl">tooltip:</span><span class="w"> </span><span class="s1">&#39;Increment&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">add</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔧 開發工具使用</h2>
<h3>VS Code 快速上手</h3>
<p><strong>常用快捷鍵：</strong></p>
<ul>
<li><code>Ctrl/Cmd + Shift + P</code>：開啟命令面板</li>
<li><code>F5</code>：啟動偵錯</li>
<li><code>Ctrl/Cmd + S</code>：儲存並觸發熱重載</li>
</ul>
<p><strong>實用擴充套件：</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;recommendations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;dart-code.flutter&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;dart-code.dart-code&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;alexisvt.flutter-snippets&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;hirantha.json-to-dart&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;robert-brunhage.flutter-riverpod-snippets&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<h3>Android Studio 快速上手</h3>
<p><strong>常用功能：</strong></p>
<ul>
<li><strong>Hot Reload</strong>: <code>Ctrl/Cmd + \</code></li>
<li><strong>Hot Restart</strong>: <code>Ctrl/Cmd + Shift + \</code></li>
<li><strong>Flutter Inspector</strong>: 檢視 Widget 樹狀結構</li>
<li><strong>Flutter Outline</strong>: 檢視程式碼結構</li>
</ul>
<hr />
<h2>📱 建構你的第一個自訂應用程式</h2>
<p>讓我們建立一個簡單的「個人名片」應用程式：</p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="n">BusinessCardApp</span><span class="p">());</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">BusinessCardApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;個人名片&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<span class="w">        </span><span class="nl">primarySwatch:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">        </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Roboto&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">BusinessCard</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">debugShowCheckedModeBanner:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">BusinessCard</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">teal</span><span class="p">,</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">SafeArea</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="c1">// 頭像</span>
<span class="w">            </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">              </span><span class="nl">radius:</span><span class="w"> </span><span class="m">50.0</span><span class="p">,</span>
<span class="w">              </span><span class="nl">backgroundImage:</span><span class="w"> </span><span class="n">AssetImage</span><span class="p">(</span><span class="s1">&#39;images/avatar.jpg&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20.0</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 姓名</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;張小明&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">32.0</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Pacifico&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 職稱</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;FLUTTER 開發者&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16.0</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">teal</span><span class="p">.</span><span class="n">shade100</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                </span><span class="nl">letterSpacing:</span><span class="w"> </span><span class="m">2.5</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20.0</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 分隔線</span>
<span class="w">            </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">150.0</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">teal</span><span class="p">.</span><span class="n">shade100</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20.0</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 聯絡資訊</span>
<span class="w">            </span><span class="n">Card</span><span class="p">(</span>
<span class="w">              </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">10.0</span><span class="p">,</span><span class="w"> </span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">25.0</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                  </span><span class="n">Icons</span><span class="p">.</span><span class="n">phone</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">teal</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;+886 912 345 678&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">teal</span><span class="p">.</span><span class="n">shade900</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Source Sans Pro&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16.0</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">Card</span><span class="p">(</span>
<span class="w">              </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">10.0</span><span class="p">,</span><span class="w"> </span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">25.0</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                  </span><span class="n">Icons</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">teal</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;ming@example.com&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">teal</span><span class="p">.</span><span class="n">shade900</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Source Sans Pro&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16.0</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>新增資源檔案</h3>
<ol>
<li>在專案根目錄建立 <code>images</code> 資料夾</li>
<li>加入頭像圖片 <code>avatar.jpg</code></li>
<li>修改 <code>pubspec.yaml</code>：</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">uses-material-design</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="c1"># 加入資源檔案</span>
<span class="w">  </span><span class="nt">assets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">images/</span>

<span class="w">  </span><span class="c1"># 自訂字型 (可選)</span>
<span class="w">  </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pacifico</span>
<span class="w">      </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fonts/Pacifico-Regular.ttf</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Source Sans Pro</span>
<span class="w">      </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fonts/SourceSansPro-Regular.ttf</span>
</code></pre></div>

<hr />
<h2>🎨 Flutter 基礎概念</h2>
<h3>1. Widget 是一切</h3>
<p>Flutter 中的所有元素都是 Widget：</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// 文字 Widget</span>
<span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Hello Flutter&#39;</span><span class="p">)</span>

<span class="c1">// 按鈕 Widget</span>
<span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;按鈕被點擊！&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;點我&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1">// 容器 Widget</span>
<span class="n">Container</span><span class="p">(</span>
<span class="w">  </span><span class="nl">width:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">  </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;容器&#39;</span><span class="p">)),</span>
<span class="p">)</span>
</code></pre></div>

<h3>2. StatelessWidget vs StatefulWidget</h3>
<p><strong>StatelessWidget（無狀態）：</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">WelcomeText</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>

<span class="w">  </span><span class="n">WelcomeText</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;歡迎, </span><span class="si">$</span><span class="n">name</span><span class="s1">!&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>StatefulWidget（有狀態）：</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">Counter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_CounterState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_CounterState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_CounterState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Counter</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;計數: </span><span class="si">$</span><span class="n">count</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;增加&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>3. 基本佈局</h3>
<p><strong>Column（垂直排列）：</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Column</span><span class="p">(</span>
<span class="w">  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;第一個&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;第二個&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;第三個&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>Row（水平排列）：</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Row</span><span class="p">(</span>
<span class="w">  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">),</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;評分&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;5.0&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>

<p><strong>Container（容器）：</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">Container</span><span class="p">(</span>
<span class="w">  </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16.0</span><span class="p">),</span>
<span class="w">  </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">8.0</span><span class="p">),</span>
<span class="w">  </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">    </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8.0</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="w">  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;樣式化容器&#39;</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div>

<hr />
<h2>🔥 熱重載 (Hot Reload)</h2>
<p>Flutter 最強大的功能之一就是熱重載：</p>
<h3>什麼是熱重載？</h3>
<ul>
<li>在不重新啟動應用程式的情況下，即時看到程式碼變更</li>
<li>保持應用程式狀態</li>
<li>大幅提高開發效率</li>
</ul>
<h3>如何使用？</h3>
<ol>
<li><strong>VS Code</strong>: 儲存檔案 (<code>Ctrl/Cmd + S</code>)</li>
<li><strong>Android Studio</strong>: 點擊熱重載按鈕或 <code>Ctrl/Cmd + \</code></li>
<li><strong>終端機</strong>: 輸入 <code>r</code></li>
</ol>
<h3>熱重載的限制</h3>
<p>以下情況需要熱重啟 (Hot Restart)：</p>
<ul>
<li>修改 <code>main()</code> 函數</li>
<li>更改全域變數初始化</li>
<li>修改 enum 定義</li>
<li>更改泛型類型宣告</li>
</ul>
<hr />
<h2>📦 套件管理</h2>
<h3>pubspec.yaml 檔案</h3>
<div class="codehilite"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_first_app</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A new Flutter project.</span>

<span class="c1"># 版本資訊</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0+1</span>

<span class="nt">environment</span><span class="p">:</span>
<span class="w">  </span><span class="nt">sdk</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&gt;=2.12.0</span><span class="nv"> </span><span class="s">&lt;3.0.0&quot;</span>

<span class="c1"># 相依套件</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">flutter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sdk</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flutter</span>

<span class="w">  </span><span class="c1"># UI 套件</span>
<span class="w">  </span><span class="nt">cupertino_icons</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^1.0.2</span>
<span class="w">  </span><span class="nt">google_fonts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^2.1.0</span>

<span class="w">  </span><span class="c1"># 網路請求</span>
<span class="w">  </span><span class="nt">http</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^0.13.3</span>

<span class="w">  </span><span class="c1"># 狀態管理</span>
<span class="w">  </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^6.0.1</span>

<span class="c1"># 開發用套件</span>
<span class="nt">dev_dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">flutter_test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sdk</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flutter</span>
<span class="w">  </span><span class="nt">flutter_lints</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^1.0.0</span>

<span class="c1"># 資源檔案</span>
<span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">uses-material-design</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">assets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">images/</span>
<span class="w">  </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Roboto</span>
<span class="w">      </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fonts/Roboto-Regular.ttf</span>
</code></pre></div>

<h3>安裝套件</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 安裝 pubspec.yaml 中定義的套件</span>
flutter<span class="w"> </span>pub<span class="w"> </span>get

<span class="c1"># 新增套件</span>
flutter<span class="w"> </span>pub<span class="w"> </span>add<span class="w"> </span>http
flutter<span class="w"> </span>pub<span class="w"> </span>add<span class="w"> </span>provider

<span class="c1"># 升級套件</span>
flutter<span class="w"> </span>pub<span class="w"> </span>upgrade
</code></pre></div>

<h3>常用套件推薦</h3>
<p><strong>UI 增強：</strong></p>
<ul>
<li><code>google_fonts</code>: Google 字型</li>
<li><code>flutter_svg</code>: SVG 支援</li>
<li><code>cached_network_image</code>: 圖片快取</li>
</ul>
<p><strong>功能套件：</strong></p>
<ul>
<li><code>http</code>: HTTP 請求</li>
<li><code>shared_preferences</code>: 本地儲存</li>
<li><code>path_provider</code>: 檔案路徑</li>
</ul>
<p><strong>狀態管理：</strong></p>
<ul>
<li><code>provider</code>: 簡單狀態管理</li>
<li><code>riverpod</code>: 進階狀態管理</li>
<li><code>bloc</code>: 業務邏輯組件</li>
</ul>
<hr />
<h2>🎯 實作練習</h2>
<h3>練習 1：計算機應用程式</h3>
<p>建立一個簡單的計算機：</p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="n">CalculatorApp</span><span class="p">());</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CalculatorApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;簡易計算機&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span><span class="nl">primarySwatch:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">),</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">Calculator</span><span class="p">(),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">Calculator</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_CalculatorState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_CalculatorState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_CalculatorState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Calculator</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">num1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">num2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">shouldResetDisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">buttonPressed</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 清除</span>
<span class="w">        </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="n">num1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">num2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">        </span><span class="kd">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;+&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;×&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;÷&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 運算符</span>
<span class="w">        </span><span class="n">num1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">display</span><span class="p">);</span>
<span class="w">        </span><span class="kd">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">        </span><span class="n">shouldResetDisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 計算結果</span>
<span class="w">        </span><span class="n">num2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">display</span><span class="p">);</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="kd">operator</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;+&#39;</span><span class="o">:</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">num2</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="o">:</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">num2</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;×&#39;</span><span class="o">:</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">num2</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;÷&#39;</span><span class="o">:</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">num1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">num2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">toString</span><span class="p">();</span>
<span class="w">        </span><span class="n">shouldResetDisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 數字輸入</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">shouldResetDisplay</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">          </span><span class="n">shouldResetDisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">display</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">buildButton</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="n">color</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">        </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">            </span><span class="nl">primary:</span><span class="w"> </span><span class="n">color</span><span class="p">,</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">            </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">              </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">10</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">buttonPressed</span><span class="p">(</span><span class="n">text</span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="p">,</span>
<span class="w">            </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;簡易計算機&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">centerTitle:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 顯示螢幕</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">flex:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">black</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Align</span><span class="p">(</span>
<span class="w">                </span><span class="nl">alignment:</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="n">bottomRight</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="n">display</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">48</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 按鈕區域</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">flex:</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;±&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;÷&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;7&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;8&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;9&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;×&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">flex:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">                          </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">                              </span><span class="nl">primary:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">],</span>
<span class="w">                              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">                              </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">                                </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">10</span><span class="p">),</span>
<span class="w">                              </span><span class="p">),</span>
<span class="w">                            </span><span class="p">),</span>
<span class="w">                            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">buttonPressed</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span>
<span class="w">                            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                              </span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
<span class="w">                              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                            </span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">800</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">                      </span><span class="n">buildButton</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>練習 2：待辦事項應用程式</h3>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="n">TodoApp</span><span class="p">());</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">TodoApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;待辦事項&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<span class="w">        </span><span class="nl">primarySwatch:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">        </span><span class="nl">visualDensity:</span><span class="w"> </span><span class="n">VisualDensity</span><span class="p">.</span><span class="n">adaptivePlatformDensity</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">TodoList</span><span class="p">(),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">Todo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isCompleted</span><span class="p">;</span>
<span class="w">  </span><span class="n">DateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>

<span class="w">  </span><span class="n">Todo</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">isCompleted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="n">DateTime</span><span class="o">?</span><span class="w"> </span><span class="n">createdAt</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">createdAt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createdAt</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">TodoList</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_TodoListState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_TodoListState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_TodoListState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">TodoList</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Todo</span><span class="o">&gt;</span><span class="w"> </span><span class="n">todos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">textController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">addTodo</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">title</span><span class="p">.</span><span class="n">trim</span><span class="p">().</span><span class="n">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">todos</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Todo</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">title</span><span class="p">.</span><span class="n">trim</span><span class="p">()));</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="n">textController</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">toggleTodo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">todos</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">isCompleted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">todos</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">isCompleted</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">deleteTodo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">todos</span><span class="p">.</span><span class="n">removeAt</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;待辦事項&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">centerTitle:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 輸入區域</span>
<span class="w">          </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16.0</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">controller:</span><span class="w"> </span><span class="n">textController</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">hintText:</span><span class="w"> </span><span class="s1">&#39;19831203&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">10</span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">add_task</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="nl">onSubmitted:</span><span class="w"> </span><span class="n">addTodo</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">width:</span><span class="w"> </span><span class="m">10</span><span class="p">),</span>
<span class="w">                </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">addTodo</span><span class="p">(</span><span class="n">textController</span><span class="p">.</span><span class="n">text</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">add</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">shape:</span><span class="w"> </span><span class="n">CircleBorder</span><span class="p">(),</span>
<span class="w">                    </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">15</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 統計資訊</span>
<span class="w">          </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">16.0</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">              </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceBetween</span><span class="p">,</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;總計: </span><span class="si">${</span><span class="n">todos</span><span class="p">.</span><span class="n">length</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;已完成: </span><span class="si">${</span><span class="n">todos</span><span class="p">.</span><span class="n">where</span><span class="p">((</span><span class="n">todo</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">isCompleted</span><span class="p">).</span><span class="n">length</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">Divider</span><span class="p">(),</span>

<span class="w">          </span><span class="c1">// 待辦事項列表</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">todos</span><span class="p">.</span><span class="n">isEmpty</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                        </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                          </span><span class="n">Icons</span><span class="p">.</span><span class="n">inbox</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">size:</span><span class="w"> </span><span class="m">64</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                          </span><span class="s1">&#39;還沒有待辦事項&#39;</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span>
<span class="w">                            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                          </span><span class="s1">&#39;點擊上方按鈕新增一個吧！&#39;</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                      </span><span class="p">],</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">)</span>
<span class="w">                </span><span class="o">:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">todos</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="kd">final</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todos</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="w">                      </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Checkbox</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">value:</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">isCompleted</span><span class="p">,</span>
<span class="w">                            </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">toggleTodo</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                          </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">todo</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
<span class="w">                            </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">isCompleted</span>
<span class="w">                                  </span><span class="o">?</span><span class="w"> </span><span class="n">TextDecoration</span><span class="p">.</span><span class="n">lineThrough</span>
<span class="w">                                  </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                              </span><span class="nl">color:</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">isCompleted</span>
<span class="w">                                  </span><span class="o">?</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span>
<span class="w">                                  </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                            </span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                          </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="s1">&#39;建立於 </span><span class="si">${</span><span class="n">todo</span><span class="p">.</span><span class="n">createdAt</span><span class="p">.</span><span class="n">day</span><span class="si">}</span><span class="s1">/</span><span class="si">${</span><span class="n">todo</span><span class="p">.</span><span class="n">createdAt</span><span class="p">.</span><span class="n">month</span><span class="si">}</span><span class="s1"> </span><span class="si">${</span><span class="n">todo</span><span class="p">.</span><span class="n">createdAt</span><span class="p">.</span><span class="n">hour</span><span class="si">}</span><span class="s1">:</span><span class="si">${</span><span class="n">todo</span><span class="p">.</span><span class="n">createdAt</span><span class="p">.</span><span class="n">minute</span><span class="p">.</span><span class="n">toString</span><span class="p">().</span><span class="n">padLeft</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                            </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                          </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">delete</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">                            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">deleteTodo</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                      </span><span class="p">);</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">textController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🚧 常見問題與解決方案</h2>
<h3>1. Flutter Doctor 問題</h3>
<p><strong>問題：Android toolchain 未安裝</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 解決方案：安裝 Android Studio 並接受授權</span>
flutter<span class="w"> </span>doctor<span class="w"> </span>--android-licenses
</code></pre></div>

<p><strong>問題：iOS toolchain 未安裝 (macOS)</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 解決方案：安裝 Xcode 命令列工具</span>
xcode-select<span class="w"> </span>--install
</code></pre></div>

<h3>2. 建置問題</h3>
<p><strong>問題：Gradle 建置失敗</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 清理建置快取</span>
flutter<span class="w"> </span>clean
flutter<span class="w"> </span>pub<span class="w"> </span>get
flutter<span class="w"> </span>run
</code></pre></div>

<p><strong>問題：套件版本衝突</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 升級所有套件</span>
flutter<span class="w"> </span>pub<span class="w"> </span>upgrade<span class="w"> </span>--major-versions
</code></pre></div>

<h3>3. 模擬器問題</h3>
<p><strong>Android 模擬器太慢：</strong></p>
<ul>
<li>確保啟用 Hardware Acceleration</li>
<li>分配足夠的 RAM (建議 4GB+)</li>
<li>使用 x86_64 映像檔</li>
</ul>
<p><strong>iOS 模擬器問題：</strong></p>
<ul>
<li>重設模擬器：Device &gt; Erase All Content and Settings</li>
<li>重啟 Xcode 和模擬器</li>
</ul>
<h3>4. 熱重載不工作</h3>
<p><strong>可能原因：</strong></p>
<ul>
<li>語法錯誤</li>
<li>修改了 main() 函數</li>
<li>Widget 建構子參數型別改變</li>
</ul>
<p><strong>解決方案：</strong></p>
<ul>
<li>修正語法錯誤</li>
<li>執行熱重啟 (Hot Restart)</li>
<li>完全重新啟動應用程式</li>
</ul>
<hr />
<h2></h2>
                    </div>
                </div>
            
                <div class="tab-pane fade " id="2.-assets-and-config" 
                     role="tabpanel" aria-labelledby="2.-assets-and-config-tab">
                    <div class="content-wrapper">
                        <h1>Flutter 資源管理與配置指南</h1>
<h2>📁 專案結構概覽</h2>
<h3>標準 Flutter 專案目錄結構</h3>
<div class="codehilite"><pre><span></span><code><span class="n">my_flutter_app/</span>
<span class="n">├── android/                    # Android 平台特定設定</span>
<span class="n">│   ├── app/</span>
<span class="n">│   │   ├── src/main/</span>
<span class="n">│   │   │   ├── AndroidManifest.xml # Android 權限設定</span>
<span class="n">│   │   │   ├── kotlin/</span>
<span class="n">│   │   │   └── res/</span>
<span class="n">│   │   │       ├── drawable/   # Android 圖示和圖片</span>
<span class="n">│   │   │       ├── mipmap/     # 應用程式圖示 (各種尺寸)</span>
<span class="n">│   │   │       └── values/     # 字串、顏色、樣式設定</span>
<span class="n">│   │   └── build.gradle        # Android 建置設定</span>
<span class="n">│   └── gradle.properties       # Gradle 全域設定</span>
<span class="n">├── ios/                        # iOS 平台特定設定</span>
<span class="n">│   ├── Runner/</span>
<span class="n">│   │   ├── Info.plist         # iOS 應用程式資訊</span>
<span class="n">│   │   ├── Assets.xcassets/   # iOS 資源目錄</span>
<span class="n">│   │   └── Runner.entitlements # iOS 權限設定</span>
<span class="n">│   └── Runner.xcodeproj/      # Xcode 專案檔</span>
<span class="n">├── web/                        # Web 平台設定</span>
<span class="n">│   ├── index.html             # Web 入口頁面</span>
<span class="n">│   ├── manifest.json          # PWA 設定</span>
<span class="n">│   └── icons/                 # Web 圖示</span>
<span class="n">├── assets/                     # Flutter 共用資源 📂 重點</span>
<span class="n">│   ├── images/                # 圖片資源</span>
<span class="n">│   ├── fonts/                 # 字型檔案</span>
<span class="n">│   ├── data/                  # JSON、CSV 等資料檔</span>
<span class="n">│   ├── animations/            # Lottie 動畫檔</span>
<span class="n">│   └── audio/                 # 音效檔案</span>
<span class="n">├── lib/                       # Dart 程式碼</span>
<span class="n">├── test/                      # 測試檔案</span>
<span class="n">├── pubspec.yaml              # 專案配置檔 🔧 關鍵</span>
<span class="n">└── pubspec.lock              # 套件版本鎖定檔</span>
</code></pre></div>

<hr />
<h2>🖼️ 圖片資源管理</h2>
<h3>1. 圖片目錄結構</h3>
<div class="codehilite"><pre><span></span><code><span class="n">assets</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="n">images</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app</span><span class="o">/</span><span class="w">                   </span><span class="c1"># 應用程式相關圖片</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">logo</span><span class="o">.</span><span class="n">png</span><span class="w">          </span><span class="c1"># 應用程式標誌</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">splash</span><span class="o">.</span><span class="n">png</span><span class="w">        </span><span class="c1"># 啟動畫面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">placeholder</span><span class="o">.</span><span class="n">png</span><span class="w">   </span><span class="c1"># 佔位圖片</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">icons</span><span class="o">/</span><span class="w">                </span><span class="c1"># 自訂圖示</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">home</span><span class="o">.</span><span class="n">png</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">settings</span><span class="o">.</span><span class="n">png</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">profile</span><span class="o">.</span><span class="n">png</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">ui</span><span class="o">/</span><span class="w">                   </span><span class="c1"># UI 元素</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">buttons</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">backgrounds</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">decorations</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">content</span><span class="o">/</span><span class="w">              </span><span class="c1"># 內容圖片</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">products</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">avatars</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">banners</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">animations</span><span class="o">/</span><span class="w">           </span><span class="c1"># 動畫相關</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">loading</span><span class="o">.</span><span class="n">gif</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">success</span><span class="o">.</span><span class="n">json</span><span class="w">      </span><span class="c1"># Lottie 動畫</span>
</code></pre></div>

<h3>2. 圖片命名規範</h3>
<div class="codehilite"><pre><span></span><code>✅ 良好的命名方式：
<span class="k">-</span> app_logo.png
<span class="k">-</span> icon_home_active.png
<span class="k">-</span> icon_home_inactive.png
<span class="k">-</span> background_gradient_blue.png
<span class="k">-</span> placeholder_user_avatar.png
<span class="k">-</span> button_primary_normal.png
<span class="k">-</span> button_primary_pressed.png

❌ 避免的命名方式：
<span class="k">-</span> 1.png
<span class="k">-</span> image.png
<span class="k">-</span> 圖片1.png (避免中文)
<span class="k">-</span> My Image.png (避免空格)
<span class="k">-</span> MyImage.PNG (避免大寫副檔名)
</code></pre></div>

<h3>3. 響應式圖片 (多解析度支援)</h3>
<div class="codehilite"><pre><span></span><code>assets/
├── images/
│   ├── app_logo.png          # 基準圖片 (1x)
│   ├── 2.0x/
│   │   └── app_logo.png      # 高解析度 (2x)
│   ├── 3.0x/
│   │   └── app_logo.png      # 超高解析度 (3x)
│   └── 4.0x/
│       └── app_logo.png      # 極高解析度 (4x)
</code></pre></div>

<h3>4. pubspec.yaml 中的圖片配置</h3>
<div class="codehilite"><pre><span></span><code><span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">assets</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># 包含整個目錄</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/icons/</span>

<span class="w">    </span><span class="c1"># 包含特定檔案</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/app_logo.png</span>

<span class="w">    </span><span class="c1"># 包含子目錄</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/ui/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/content/</span>

<span class="w">    </span><span class="c1"># 支援多解析度</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/app_logo.png</span><span class="w">  </span><span class="c1"># 自動包含 2.0x, 3.0x, 4.0x</span>
</code></pre></div>

<h3>5. 程式碼中使用圖片</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 基本圖片載入</span>
<span class="n">Image</span><span class="p">.</span><span class="n">asset</span><span class="p">(</span><span class="s1">&#39;assets/images/app_logo.png&#39;</span><span class="p">)</span>

<span class="c1">// 帶快取的網路圖片</span>
<span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span>
<span class="w">  </span><span class="s1">&#39;https://example.com/image.jpg&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">loadingBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="n">loadingProgress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">loadingProgress</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nl">errorBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">asset</span><span class="p">(</span><span class="s1">&#39;assets/images/placeholder.png&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">)</span>

<span class="c1">// 圓形頭像</span>
<span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">  </span><span class="nl">backgroundImage:</span><span class="w"> </span><span class="n">AssetImage</span><span class="p">(</span><span class="s1">&#39;assets/images/avatars/user1.png&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nl">radius:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">// 自訂圖片載入 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AppImage</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">assetPath</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="o">?</span><span class="w"> </span><span class="n">width</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="o">?</span><span class="w"> </span><span class="n">height</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">BoxFit</span><span class="w"> </span><span class="n">fit</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">AppImage</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">assetPath</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">width</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">height</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">asset</span><span class="p">(</span>
<span class="w">      </span><span class="n">assetPath</span><span class="p">,</span>
<span class="w">      </span><span class="nl">width:</span><span class="w"> </span><span class="n">width</span><span class="p">,</span>
<span class="w">      </span><span class="nl">height:</span><span class="w"> </span><span class="n">height</span><span class="p">,</span>
<span class="w">      </span><span class="nl">fit:</span><span class="w"> </span><span class="n">fit</span><span class="p">,</span>
<span class="w">      </span><span class="nl">errorBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="n">width</span><span class="p">,</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="n">height</span><span class="p">,</span>
<span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">300</span><span class="p">],</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🎨 字型管理</h2>
<h3>1. 字型目錄結構</h3>
<div class="codehilite"><pre><span></span><code>assets/
├── fonts/
│   ├── Roboto/               # 字型家族目錄
│   │   ├── Roboto-Regular.ttf
│   │   ├── Roboto-Bold.ttf
│   │   ├── Roboto-Italic.ttf
│   │   └── Roboto-BoldItalic.ttf
│   ├── OpenSans/
│   │   ├── OpenSans-Regular.ttf
│   │   ├── OpenSans-SemiBold.ttf
│   │   └── OpenSans-Bold.ttf
│   └── CustomIcons/          # 自訂圖示字型
│       └── CustomIcons.ttf
</code></pre></div>

<h3>2. pubspec.yaml 字型配置</h3>
<div class="codehilite"><pre><span></span><code><span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># 主要字型</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Roboto</span>
<span class="w">      </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/Roboto/Roboto-Regular.ttf</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/Roboto/Roboto-Bold.ttf</span>
<span class="w">          </span><span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">700</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/Roboto/Roboto-Italic.ttf</span>
<span class="w">          </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">italic</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/Roboto/Roboto-BoldItalic.ttf</span>
<span class="w">          </span><span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">700</span>
<span class="w">          </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">italic</span>

<span class="w">    </span><span class="c1"># 次要字型</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OpenSans</span>
<span class="w">      </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/OpenSans/OpenSans-Regular.ttf</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/OpenSans/OpenSans-SemiBold.ttf</span>
<span class="w">          </span><span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">600</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/OpenSans/OpenSans-Bold.ttf</span>
<span class="w">          </span><span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">700</span>

<span class="w">    </span><span class="c1"># 自訂圖示字型</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CustomIcons</span>
<span class="w">      </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/CustomIcons/CustomIcons.ttf</span>
</code></pre></div>

<h3>3. 程式碼中使用字型</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 直接指定字型</span>
<span class="n">Text</span><span class="p">(</span>
<span class="w">  </span><span class="s1">&#39;Hello Flutter&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">    </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Roboto&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span>
<span class="w">    </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">)</span>

<span class="c1">// 使用主題統一管理</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AppTheme</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">TextTheme</span><span class="w"> </span><span class="n">textTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextTheme</span><span class="p">(</span>
<span class="w">    </span><span class="nl">headline1:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">      </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Roboto&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">32</span><span class="p">,</span>
<span class="w">      </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="nl">bodyText1:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">      </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;OpenSans&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 應用主題</span>
<span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">  </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<span class="w">    </span><span class="nl">textTheme:</span><span class="w"> </span><span class="n">AppTheme</span><span class="p">.</span><span class="n">textTheme</span><span class="p">,</span>
<span class="w">    </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Roboto&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// 預設字型</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">)</span>

<span class="c1">// 自訂圖示字型</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomIcons</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">IconData</span><span class="w"> </span><span class="n">home</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IconData</span><span class="p">(</span><span class="mh">0xe900</span><span class="p">,</span><span class="w"> </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;CustomIcons&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">IconData</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IconData</span><span class="p">(</span><span class="mh">0xe901</span><span class="p">,</span><span class="w"> </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;CustomIcons&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 使用自訂圖示</span>
<span class="n">Icon</span><span class="p">(</span><span class="n">CustomIcons</span><span class="p">.</span><span class="n">home</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">24</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2>🎬 動畫資源</h2>
<h3>1. 動畫目錄結構</h3>
<div class="codehilite"><pre><span></span><code><span class="n">assets</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="n">animations</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">lottie</span><span class="o">/</span><span class="w">               </span><span class="c1"># Lottie 動畫</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">loading</span><span class="o">.</span><span class="n">json</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">success</span><span class="o">.</span><span class="n">json</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="n">json</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">splash</span><span class="o">.</span><span class="n">json</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">gifs</span><span class="o">/</span><span class="w">                 </span><span class="c1"># GIF 動畫</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">tutorial_step1</span><span class="o">.</span><span class="n">gif</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">tutorial_step2</span><span class="o">.</span><span class="n">gif</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">loading_spinner</span><span class="o">.</span><span class="n">gif</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">sequences</span><span class="o">/</span><span class="w">            </span><span class="c1"># 序列圖片動畫</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">frame_001</span><span class="o">.</span><span class="n">png</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">frame_002</span><span class="o">.</span><span class="n">png</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">frame_003</span><span class="o">.</span><span class="n">png</span>
</code></pre></div>

<h3>2. Lottie 動畫使用</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># pubspec.yaml</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">lottie</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^2.0.0</span>

<span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">assets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/animations/lottie/</span>
<span class="l l-Scalar l-Scalar-Plain">import &#39;package:lottie/lottie.dart&#39;;</span>

<span class="l l-Scalar l-Scalar-Plain">// 基本 Lottie 動畫</span>
<span class="l l-Scalar l-Scalar-Plain">Lottie.asset(</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&#39;assets/animations/lottie/loading.json&#39;,</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">width</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200,</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">height</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200,</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">fit</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BoxFit.fill,</span>
<span class="l l-Scalar l-Scalar-Plain">)</span>

<span class="l l-Scalar l-Scalar-Plain">// 可控制的 Lottie 動畫</span>
<span class="l l-Scalar l-Scalar-Plain">class AnimatedIcon extends StatefulWidget {</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">@override</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">_AnimatedIconState createState() =&gt; _AnimatedIconState();</span>
<span class="err">}</span>

<span class="l l-Scalar l-Scalar-Plain">class _AnimatedIconState extends State&lt;AnimatedIcon&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">with TickerProviderStateMixin {</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">late AnimationController _controller;</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">@override</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">void initState() {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">super.initState();</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">_controller = AnimationController(vsync</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">this);</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">@override</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">void dispose() {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">_controller.dispose();</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">super.dispose();</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">@override</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Widget build(BuildContext context) {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">return GestureDetector(</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">onTap</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">() {</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">if (_controller.isCompleted) {</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">_controller.reset();</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">_controller.forward();</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">},</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">child</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Lottie.asset(</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&#39;assets/animations/lottie/heart.json&#39;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">controller</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_controller,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">width</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">height</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">onLoaded</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(composition) {</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">_controller.duration = composition.duration;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">},</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">),</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">);</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="err">}</span>
</code></pre></div>

<h3>3. GIF 動畫使用</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 基本 GIF 顯示</span>
<span class="n">Image</span><span class="p">.</span><span class="n">asset</span><span class="p">(</span><span class="s1">&#39;assets/animations/gifs/loading_spinner.gif&#39;</span><span class="p">)</span>

<span class="c1">// 可控制的 GIF 動畫</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">GifImage</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">gifPath</span><span class="p">;</span>

<span class="w">  </span><span class="n">GifImage</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">gifPath</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_GifImageState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_GifImageState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_GifImageState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">GifImage</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">TickerProviderStateMixin</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">AnimationController</span><span class="w"> </span><span class="n">_controller</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="n">_controller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AnimationController</span><span class="p">(</span>
<span class="w">      </span><span class="nl">duration:</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">      </span><span class="nl">vsync:</span><span class="w"> </span><span class="k">this</span><span class="p">,</span>
<span class="w">    </span><span class="p">)..</span><span class="n">repeat</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">AnimatedBuilder</span><span class="p">(</span>
<span class="w">      </span><span class="nl">animation:</span><span class="w"> </span><span class="n">_controller</span><span class="p">,</span>
<span class="w">      </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">asset</span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">gifPath</span><span class="p">);</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔊 音效資源</h2>
<h3>1. 音效目錄結構</h3>
<div class="codehilite"><pre><span></span><code>assets/
├── audio/
│   ├── sounds/               # 音效檔
│   │   ├── button_click.mp3
│   │   ├── notification.wav
│   │   ├── success.ogg
│   │   └── error.aac
│   ├── music/                # 背景音樂
│   │   ├── background_1.mp3
│   │   └── background_2.mp3
│   └── voice/                # 語音檔案
│       ├── welcome_en.mp3
│       └── welcome_zh.mp3
</code></pre></div>

<h3>2. 音效檔案使用</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># pubspec.yaml</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">audioplayers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^1.0.0</span>

<span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">assets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/audio/</span>
<span class="l l-Scalar l-Scalar-Plain">import &#39;package:audioplayers/audioplayers.dart&#39;;</span>

<span class="l l-Scalar l-Scalar-Plain">class AudioManager {</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">static final AudioPlayer _player = AudioPlayer();</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">// 播放音效</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">static Future&lt;void&gt; playSound(String soundPath) async {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">await _player.play(AssetSource(soundPath));</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">// 播放背景音樂</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">static Future&lt;void&gt; playBackgroundMusic(String musicPath) async {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">await _player.play(</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">AssetSource(musicPath),</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">mode</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PlayerMode.mediaPlayer,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">);</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">await _player.setReleaseMode(ReleaseMode.loop);</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">// 停止播放</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">static Future&lt;void&gt; stop() async {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">await _player.stop();</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">// 設定音量</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">static Future&lt;void&gt; setVolume(double volume) async {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">await _player.setVolume(volume);</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="err">}</span>

<span class="l l-Scalar l-Scalar-Plain">// 使用範例</span>
<span class="l l-Scalar l-Scalar-Plain">class SoundButton extends StatelessWidget {</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">final VoidCallback? onPressed;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">final Widget child;</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">const SoundButton({</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">Key? key,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">this.onPressed,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">required this.child,</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">})</span><span class="w"> </span><span class="nt">: super(key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key);</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">@override</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Widget build(BuildContext context) {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">return ElevatedButton(</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">onPressed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">() {</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">AudioManager.playSound(&#39;audio/sounds/button_click.mp3&#39;);</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">onPressed?.call();</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">},</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">child</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">child,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">);</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="err">}</span>
</code></pre></div>

<hr />
<h2>📋 資料檔案管理</h2>
<h3>1. 資料目錄結構</h3>
<div class="codehilite"><pre><span></span><code>assets/
├── data/
│   ├── json/                 # JSON 資料
│   │   ├── countries.json
│   │   ├── cities.json
│   │   └── app_config.json
│   ├── csv/                  # CSV 檔案
│   │   ├── products.csv
│   │   └── users.csv
│   ├── translations/         # 多語言檔案
│   │   ├── en.json
│   │   ├── zh_TW.json
│   │   └── ja.json
│   └── mock/                 # 模擬資料
│       ├── api_responses.json
│       └── test_data.json
</code></pre></div>

<h3>2. JSON 資料讀取</h3>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/services.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">DataService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 讀取 JSON 檔案</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">loadJsonData</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">rootBundle</span><span class="p">.</span><span class="n">loadString</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 讀取並解析為物件列表</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">loadDataList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">path</span><span class="p">,</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">fromJson</span><span class="p">,</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">jsonData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">loadJsonData</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dataList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonData</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dataList</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fromJson</span><span class="p">(</span><span class="n">item</span><span class="p">)).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">Country</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">code</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">flag</span><span class="p">;</span>

<span class="w">  </span><span class="n">Country</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">flag</span><span class="p">});</span>

<span class="w">  </span><span class="kd">factory</span><span class="w"> </span><span class="n">Country</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Country</span><span class="p">(</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
<span class="w">      </span><span class="nl">code:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">],</span>
<span class="w">      </span><span class="nl">flag:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;flag&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 載入國家資料</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Country</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">loadCountries</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">DataService</span><span class="p">.</span><span class="n">loadDataList</span><span class="o">&lt;</span><span class="n">Country</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="s1">&#39;assets/data/json/countries.json&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">Country</span><span class="p">.</span><span class="n">fromJson</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3>3. 多語言檔案</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// assets/data/translations/en.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;app&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;My Flutter App&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;welcome&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Welcome&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;buttons&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;save&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Save&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;cancel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cancel&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;delete&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Delete&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;messages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Operation successful&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;An error occurred&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// assets/data/translations/zh_TW.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;app&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;我的 Flutter 應用程式&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;welcome&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;歡迎&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;buttons&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;save&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;儲存&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;cancel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;取消&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;delete&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;刪除&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;messages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;操作成功&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;發生錯誤&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>⚙️ 平台特定配置</h2>
<h3>1. Android 配置</h3>
<h4>AndroidManifest.xml 權限設定</h4>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- android/app/src/main/AndroidManifest.xml --&gt;</span>
<span class="nt">&lt;manifest</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
<span class="w">    </span><span class="na">package=</span><span class="s">&quot;com.example.myapp&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 網路權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 儲存權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 相機權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.CAMERA&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-feature</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.hardware.camera&quot;</span><span class="w"> </span><span class="na">android:required=</span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 定位權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_FINE_LOCATION&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_COARSE_LOCATION&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 麥克風權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.RECORD_AUDIO&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 通知權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.WAKE_LOCK&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.VIBRATE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 藍牙權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.BLUETOOTH&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.BLUETOOTH_ADMIN&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 聯絡人權限 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.READ_CONTACTS&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_CONTACTS&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;application</span>
<span class="w">        </span><span class="na">android:label=</span><span class="s">&quot;My Flutter App&quot;</span>
<span class="w">        </span><span class="na">android:icon=</span><span class="s">&quot;@mipmap/ic_launcher&quot;</span>
<span class="w">        </span><span class="na">android:requestLegacyExternalStorage=</span><span class="s">&quot;true&quot;</span>
<span class="w">        </span><span class="na">android:usesCleartextTraffic=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>

<span class="w">        </span><span class="nt">&lt;activity</span>
<span class="w">            </span><span class="na">android:name=</span><span class="s">&quot;.MainActivity&quot;</span>
<span class="w">            </span><span class="na">android:exported=</span><span class="s">&quot;true&quot;</span>
<span class="w">            </span><span class="na">android:launchMode=</span><span class="s">&quot;singleTop&quot;</span>
<span class="w">            </span><span class="na">android:theme=</span><span class="s">&quot;@style/LaunchTheme&quot;</span>
<span class="w">            </span><span class="na">android:configChanges=</span><span class="s">&quot;orientation|keyboardHidden|keyboard|screenSize|smallestScreenSize|locale|layoutDirection|fontScale|screenLayout|density|uiMode&quot;</span>
<span class="w">            </span><span class="na">android:hardwareAccelerated=</span><span class="s">&quot;true&quot;</span>
<span class="w">            </span><span class="na">android:windowSoftInputMode=</span><span class="s">&quot;adjustResize&quot;</span><span class="nt">&gt;</span>

<span class="w">            </span><span class="cm">&lt;!-- 啟動 Intent --&gt;</span>
<span class="w">            </span><span class="nt">&lt;intent-filter</span><span class="w"> </span><span class="na">android:autoVerify=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;category</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/intent-filter&gt;</span>

<span class="w">            </span><span class="cm">&lt;!-- 深度連結 --&gt;</span>
<span class="w">            </span><span class="nt">&lt;intent-filter&gt;</span>
<span class="w">                </span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.action.VIEW&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;category</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.category.DEFAULT&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;category</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.intent.category.BROWSABLE&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;data</span><span class="w"> </span><span class="na">android:scheme=</span><span class="s">&quot;myapp&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/intent-filter&gt;</span>
<span class="w">        </span><span class="nt">&lt;/activity&gt;</span>

<span class="w">        </span><span class="cm">&lt;!-- Firebase 推送通知服務 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;service</span>
<span class="w">            </span><span class="na">android:name=</span><span class="s">&quot;.MyFirebaseMessagingService&quot;</span>
<span class="w">            </span><span class="na">android:exported=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;intent-filter&gt;</span>
<span class="w">                </span><span class="nt">&lt;action</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;com.google.firebase.MESSAGING_EVENT&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/intent-filter&gt;</span>
<span class="w">        </span><span class="nt">&lt;/service&gt;</span>
<span class="w">    </span><span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</code></pre></div>

<h4>build.gradle 配置</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// android/app/build.gradle</span>
<span class="nx">android</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">compileSdkVersion</span><span class="w"> </span><span class="mi">33</span>
<span class="w">    </span><span class="nx">ndkVersion</span><span class="w"> </span><span class="nx">flutter</span><span class="p">.</span><span class="nx">ndkVersion</span>

<span class="w">    </span><span class="nx">compileOptions</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">sourceCompatibility</span><span class="w"> </span><span class="nx">JavaVersion</span><span class="p">.</span><span class="nx">VERSION_1_8</span>
<span class="w">        </span><span class="nx">targetCompatibility</span><span class="w"> </span><span class="nx">JavaVersion</span><span class="p">.</span><span class="nx">VERSION_1_8</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">defaultConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">applicationId</span><span class="w"> </span><span class="s">&quot;com.example.myapp&quot;</span>
<span class="w">        </span><span class="nx">minSdkVersion</span><span class="w"> </span><span class="mi">21</span>
<span class="w">        </span><span class="nx">targetSdkVersion</span><span class="w"> </span><span class="mi">33</span>
<span class="w">        </span><span class="nx">versionCode</span><span class="w"> </span><span class="nx">flutterVersionCode</span><span class="p">.</span><span class="nx">toInteger</span><span class="p">()</span>
<span class="w">        </span><span class="nx">versionName</span><span class="w"> </span><span class="nx">flutterVersionName</span>
<span class="w">        </span><span class="nx">multiDexEnabled</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">signingConfigs</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">release</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">keyAlias</span><span class="w"> </span><span class="nx">keystoreProperties</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">keyAlias</span><span class="err">&#39;</span><span class="p">]</span>
<span class="w">            </span><span class="nx">keyPassword</span><span class="w"> </span><span class="nx">keystoreProperties</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">keyPassword</span><span class="err">&#39;</span><span class="p">]</span>
<span class="w">            </span><span class="nx">storeFile</span><span class="w"> </span><span class="nx">keystoreProperties</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">storeFile</span><span class="err">&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="nx">file</span><span class="p">(</span><span class="nx">keystoreProperties</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">storeFile</span><span class="err">&#39;</span><span class="p">])</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">null</span>
<span class="w">            </span><span class="nx">storePassword</span><span class="w"> </span><span class="nx">keystoreProperties</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">storePassword</span><span class="err">&#39;</span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">buildTypes</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">release</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">signingConfig</span><span class="w"> </span><span class="nx">signingConfigs</span><span class="p">.</span><span class="nx">release</span>
<span class="w">            </span><span class="nx">minifyEnabled</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="nx">shrinkResources</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">dependencies</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">implementation</span><span class="w"> </span><span class="s">&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version&quot;</span>
<span class="w">    </span><span class="nx">implementation</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">androidx</span><span class="p">.</span><span class="nx">multidex</span><span class="p">:</span><span class="nx">multidex</span><span class="p">:</span><span class="m m-Double">2.0.1</span><span class="err">&#39;</span>
<span class="p">}</span>
</code></pre></div>

<h3>2. iOS 配置</h3>
<h4>Info.plist 權限設定</h4>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- ios/Runner/Info.plist --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span>
<span class="nt">&lt;plist</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;dict&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- 應用程式基本資訊 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>CFBundleName<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>My<span class="w"> </span>Flutter<span class="w"> </span>App<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>CFBundleDisplayName<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>My<span class="w"> </span>Flutter<span class="w"> </span>App<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>CFBundleIdentifier<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>com.example.myapp<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>CFBundleVersion<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>1.0.0<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>CFBundleShortVersionString<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>1.0.0<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 權限說明 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSCameraUsageDescription<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>此應用程式需要相機權限來拍攝照片<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSPhotoLibraryUsageDescription<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>此應用程式需要存取照片庫來選擇圖片<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSMicrophoneUsageDescription<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>此應用程式需要麥克風權限來錄製音頻<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSLocationWhenInUseUsageDescription<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>此應用程式需要定位權限來提供位置服務<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSLocationAlwaysAndWhenInUseUsageDescription<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>此應用程式需要定位權限來提供背景位置服務<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSContactsUsageDescription<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>此應用程式需要聯絡人權限來同步聯絡人<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSCalendarsUsageDescription<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;string&gt;</span>此應用程式需要行事曆權限來管理事件<span class="nt">&lt;/string&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 網路安全設定 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>NSAppTransportSecurity<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;dict&gt;</span>
<span class="w">        </span><span class="nt">&lt;key&gt;</span>NSAllowsArbitraryLoads<span class="nt">&lt;/key&gt;</span>
<span class="w">        </span><span class="nt">&lt;true/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/dict&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- URL Scheme --&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>CFBundleURLTypes<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;array&gt;</span>
<span class="w">        </span><span class="nt">&lt;dict&gt;</span>
<span class="w">            </span><span class="nt">&lt;key&gt;</span>CFBundleURLName<span class="nt">&lt;/key&gt;</span>
<span class="w">            </span><span class="nt">&lt;string&gt;</span>myapp.deeplink<span class="nt">&lt;/string&gt;</span>
<span class="w">            </span><span class="nt">&lt;key&gt;</span>CFBundleURLSchemes<span class="nt">&lt;/key&gt;</span>
<span class="w">            </span><span class="nt">&lt;array&gt;</span>
<span class="w">                </span><span class="nt">&lt;string&gt;</span>myapp<span class="nt">&lt;/string&gt;</span>
<span class="w">            </span><span class="nt">&lt;/array&gt;</span>
<span class="w">        </span><span class="nt">&lt;/dict&gt;</span>
<span class="w">    </span><span class="nt">&lt;/array&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 支援的介面方向 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;</span>UISupportedInterfaceOrientations<span class="nt">&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;array&gt;</span>
<span class="w">        </span><span class="nt">&lt;string&gt;</span>UIInterfaceOrientationPortrait<span class="nt">&lt;/string&gt;</span>
<span class="w">        </span><span class="nt">&lt;string&gt;</span>UIInterfaceOrientationLandscapeLeft<span class="nt">&lt;/string&gt;</span>
<span class="w">        </span><span class="nt">&lt;string&gt;</span>UIInterfaceOrientationLandscapeRight<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;/array&gt;</span>
<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</code></pre></div>

<hr />
<h2>🎯 應用程式圖示設定</h2>
<h3>1. Android 圖示</h3>
<div class="codehilite"><pre><span></span><code><span class="n">android/app/src/main/res/</span>
<span class="n">├── mipmap-mdpi/              # 48x48 px</span>
<span class="n">│   └── ic_launcher.png</span>
<span class="n">├── mipmap-hdpi/              # 72x72 px</span>
<span class="n">│   └── ic_launcher.png</span>
<span class="n">├── mipmap-xhdpi/             # 96x96 px</span>
<span class="n">│   └── ic_launcher.png</span>
<span class="n">├── mipmap-xxhdpi/            # 144x144 px</span>
<span class="n">│   └── ic_launcher.png</span>
<span class="n">├── mipmap-xxxhdpi/           # 192x192 px</span>
<span class="n">│   └── ic_launcher.png</span>
<span class="n">└── mipmap-anydpi-v26/        # 自適應圖示 (Android 8.0+)</span>
<span class="n">    ├── ic_launcher.xml</span>
<span class="n">    └── ic_launcher_background.xml</span>
</code></pre></div>

<h3>2. iOS 圖示</h3>
<div class="codehilite"><pre><span></span><code><span class="n">ios</span><span class="o">/</span><span class="n">Runner</span><span class="o">/</span><span class="n">Assets</span><span class="p">.</span><span class="n">xcassets</span><span class="o">/</span><span class="n">AppIcon</span><span class="p">.</span><span class="n">appiconset</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-20</span><span class="n">x20</span><span class="mi">@1</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">20</span><span class="n">x20</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-20</span><span class="n">x20</span><span class="mi">@2</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">40</span><span class="n">x40</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-20</span><span class="n">x20</span><span class="mi">@3</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">60</span><span class="n">x60</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-29</span><span class="n">x29</span><span class="mi">@1</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">29</span><span class="n">x29</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-29</span><span class="n">x29</span><span class="mi">@2</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">58</span><span class="n">x58</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-29</span><span class="n">x29</span><span class="mi">@3</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">87</span><span class="n">x87</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-40</span><span class="n">x40</span><span class="mi">@1</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">40</span><span class="n">x40</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-40</span><span class="n">x40</span><span class="mi">@2</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">80</span><span class="n">x80</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-40</span><span class="n">x40</span><span class="mi">@3</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">120</span><span class="n">x120</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-60</span><span class="n">x60</span><span class="mi">@2</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">120</span><span class="n">x120</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-60</span><span class="n">x60</span><span class="mi">@3</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">180</span><span class="n">x180</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-76</span><span class="n">x76</span><span class="mi">@1</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">76</span><span class="n">x76</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-76</span><span class="n">x76</span><span class="mi">@2</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="mi">152</span><span class="n">x152</span><span class="w"> </span><span class="n">px</span>
<span class="err">├──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mf">-83.5</span><span class="n">x83</span><span class="mf">.5</span><span class="mi">@2</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="mi">167</span><span class="n">x167</span><span class="w"> </span><span class="n">px</span>
<span class="err">└──</span><span class="w"> </span><span class="n">Icon</span><span class="o">-</span><span class="n">App</span><span class="mi">-1024</span><span class="n">x1024</span><span class="mi">@1</span><span class="n">x</span><span class="p">.</span><span class="n">png</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="mi">1024</span><span class="n">x1024</span><span class="w"> </span><span class="n">px</span>
</code></pre></div>

<h3>3. 自動生成圖示工具</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># pubspec.yaml</span>
<span class="nt">dev_dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">flutter_launcher_icons</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^0.11.0</span>

<span class="nt">flutter_icons</span><span class="p">:</span>
<span class="w">  </span><span class="nt">android</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;launcher_icon&quot;</span>
<span class="w">  </span><span class="nt">ios</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">image_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;assets/icon/app_icon.png&quot;</span>
<span class="w">  </span><span class="nt">min_sdk_android</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">21</span>
<span class="w">  </span><span class="nt">web</span><span class="p">:</span>
<span class="w">    </span><span class="nt">generate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">image_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;assets/icon/app_icon.png&quot;</span>
<span class="w">  </span><span class="nt">windows</span><span class="p">:</span>
<span class="w">    </span><span class="nt">generate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">image_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;assets/icon/app_icon.png&quot;</span>
<span class="w">    </span><span class="nt">icon_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">48</span>
<span class="w">  </span><span class="nt">macos</span><span class="p">:</span>
<span class="w">    </span><span class="nt">generate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">image_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;assets/icon/app_icon.png&quot;</span>
<span class="c1"># 執行圖示生成</span>
<span class="l l-Scalar l-Scalar-Plain">flutter pub get</span>
<span class="l l-Scalar l-Scalar-Plain">flutter pub run flutter_launcher_icons:main</span>
</code></pre></div>

<hr />
<h2>🚀 啟動畫面設定</h2>
<h3>1. flutter_native_splash 套件</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># pubspec.yaml</span>
<span class="nt">dev_dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">flutter_native_splash</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^2.3.0</span>

<span class="nt">flutter_native_splash</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># 背景顏色</span>
<span class="w">  </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#42a5f5&quot;</span>
<span class="w">  </span><span class="nt">color_dark</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#042a49&quot;</span>

<span class="w">  </span><span class="c1"># 啟動圖片</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/splash_logo.png</span>
<span class="w">  </span><span class="nt">image_dark</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/splash_logo_dark.png</span>

<span class="w">  </span><span class="c1"># 圖片設定</span>
<span class="w">  </span><span class="nt">fill</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="c1"># Android 特定設定</span>
<span class="w">  </span><span class="nt">android_gravity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">center</span>
<span class="w">  </span><span class="nt">android_12</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/splash_logo_android12.png</span>
<span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#42a5f5&quot;</span>

<span class="w">  </span><span class="c1"># iOS 特定設定</span>
<span class="w">  </span><span class="nt">ios_content_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">center</span>

<span class="w">  </span><span class="c1"># Web 設定</span>
<span class="w">  </span><span class="nt">web</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">web_image_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">center</span>
<span class="c1"># 生成啟動畫面</span>
<span class="l l-Scalar l-Scalar-Plain">flutter pub get</span>
<span class="l l-Scalar l-Scalar-Plain">flutter pub run flutter_native_splash:create</span>

<span class="c1"># 移除啟動畫面</span>
<span class="l l-Scalar l-Scalar-Plain">flutter pub run flutter_native_splash:remove</span>
</code></pre></div>

<h3>2. 自訂啟動畫面 (Android)</h3>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- android/app/src/main/res/drawable/launch_background.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;layer-list</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- 背景顏色 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">android:drawable=</span><span class="s">&quot;@android:color/white&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 啟動圖示 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;item&gt;</span>
<span class="w">        </span><span class="nt">&lt;bitmap</span>
<span class="w">            </span><span class="na">android:gravity=</span><span class="s">&quot;center&quot;</span>
<span class="w">            </span><span class="na">android:src=</span><span class="s">&quot;@drawable/splash_logo&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/item&gt;</span>
<span class="nt">&lt;/layer-list&gt;</span>
<span class="cm">&lt;!-- android/app/src/main/res/values/styles.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;style</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LaunchTheme&quot;</span><span class="w"> </span><span class="na">parent=</span><span class="s">&quot;@android:style/Theme.Light.NoTitleBar&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:windowBackground&quot;</span><span class="nt">&gt;</span>@drawable/launch_background<span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;/style&gt;</span>

<span class="w">    </span><span class="nt">&lt;style</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;NormalTheme&quot;</span><span class="w"> </span><span class="na">parent=</span><span class="s">&quot;@android:style/Theme.Light.NoTitleBar&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;android:windowBackground&quot;</span><span class="nt">&gt;</span>?android:colorBackground<span class="nt">&lt;/item&gt;</span>
<span class="w">    </span><span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre></div>

<hr />
<h2>🌐 Web 平台配置</h2>
<h3>1. Web 目錄結構</h3>
<div class="codehilite"><pre><span></span><code>web/
├── index.html                # 主頁面
├── manifest.json            # PWA 設定檔
├── favicon.png              # 網站圖示
├── icons/                   # PWA 圖示
│   ├── Icon-192.png         # 192x192 px
│   ├── Icon-512.png         # 512x512 px
│   └── Icon-maskable-192.png
├── splash/                  # 啟動畫面圖片
│   ├── img/
│   │   ├── light-1x.png
│   │   ├── light-2x.png
│   │   ├── dark-1x.png
│   │   └── dark-2x.png
│   └── splash.js
└── sw.js                    # Service Worker
</code></pre></div>

<h3>2. index.html 配置</h3>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">base</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;$FLUTTER_BASE_HREF&quot;</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;IE=Edge&quot;</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;X-UA-Compatible&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;description&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;我的 Flutter Web 應用程式&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>

  <span class="cm">&lt;!-- Apple meta tags --&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;apple-mobile-web-app-capable&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;yes&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;apple-mobile-web-app-status-bar-style&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;apple-mobile-web-app-title&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;My Flutter App&quot;</span><span class="p">&gt;</span>

  <span class="cm">&lt;!-- Favicon --&gt;</span>
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;apple-touch-icon&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;icons/Icon-192.png&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;icon&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;image/png&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;favicon.png&quot;</span><span class="p">/&gt;</span>

  <span class="cm">&lt;!-- PWA manifest --&gt;</span>
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;manifest&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;manifest.json&quot;</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My Flutter App<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

  <span class="cm">&lt;!-- 自訂 CSS --&gt;</span>
  <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="w">    </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="nb">linear-gradient</span><span class="p">(</span><span class="mi">45</span><span class="kt">deg</span><span class="p">,</span><span class="w"> </span><span class="mh">#1e3c72</span><span class="p">,</span><span class="w"> </span><span class="mh">#2a5298</span><span class="p">);</span>
<span class="w">      </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">      </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Roboto&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">      </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">hidden</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">.</span><span class="nc">loading</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">      </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">      </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">      </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">      </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">vh</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">.</span><span class="nc">loading-logo</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="kt">px</span><span class="p">;</span>
<span class="w">      </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="kt">px</span><span class="p">;</span>
<span class="w">      </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">      </span><span class="k">animation</span><span class="p">:</span><span class="w"> </span><span class="n">pulse</span><span class="w"> </span><span class="mi">2</span><span class="kt">s</span><span class="w"> </span><span class="kc">infinite</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">@</span><span class="k">keyframes</span><span class="w"> </span><span class="nt">pulse</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">0</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="nt">50</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.1</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="nt">100</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">.</span><span class="nc">loading-text</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
<span class="w">      </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">.</span><span class="nc">loading-spinner</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
<span class="w">      </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
<span class="w">      </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">);</span>
<span class="w">      </span><span class="k">border-top</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">      </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">      </span><span class="k">animation</span><span class="p">:</span><span class="w"> </span><span class="n">spin</span><span class="w"> </span><span class="mi">1</span><span class="kt">s</span><span class="w"> </span><span class="kc">linear</span><span class="w"> </span><span class="kc">infinite</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">@</span><span class="k">keyframes</span><span class="w"> </span><span class="nt">spin</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">0</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">rotate</span><span class="p">(</span><span class="mi">0</span><span class="kt">deg</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="nt">100</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">rotate</span><span class="p">(</span><span class="mi">360</span><span class="kt">deg</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="cm">&lt;!-- Loading Screen --&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;loading&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;loading&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;icons/Icon-192.png&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;App Logo&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;loading-logo&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;loading-text&quot;</span><span class="p">&gt;</span>正在載入應用程式...<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;loading-spinner&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

  <span class="cm">&lt;!-- Flutter App Container --&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;app&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

  <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">    </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 隱藏載入畫面</span>
<span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">loading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;#loading&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">loading</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;none&#39;</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// Download main.dart.js</span>
<span class="w">      </span><span class="nx">_flutter</span><span class="p">.</span><span class="nx">loader</span><span class="p">.</span><span class="nx">loadEntrypoint</span><span class="p">({</span>
<span class="w">        </span><span class="nx">serviceWorker</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">serviceWorkerVersion</span><span class="o">:</span><span class="w"> </span><span class="nx">serviceWorkerVersion</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">onEntrypointLoaded</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">engineInitializer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">engineInitializer</span><span class="p">.</span><span class="nx">initializeEngine</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">appRunner</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">appRunner</span><span class="p">.</span><span class="nx">runApp</span><span class="p">();</span>
<span class="w">          </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<h3>3. manifest.json PWA 配置</h3>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;My Flutter App&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;short_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Flutter App&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;start_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;display&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;standalone&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;background_color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#1e3c72&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;theme_color&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#2a5298&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;我的 Flutter Web 應用程式&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;orientation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;portrait-primary&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;prefer_related_applications&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;icons&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;src&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icons/Icon-192.png&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sizes&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192x192&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;src&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icons/Icon-512.png&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sizes&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;512x512&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;src&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icons/Icon-maskable-192.png&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sizes&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192x192&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;purpose&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;maskable&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;shortcuts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;首頁&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;short_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Home&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;icons&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;src&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icons/Icon-192.png&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;sizes&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192x192&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔧 環境變數與配置管理</h2>
<h3>1. 環境配置檔案</h3>
<div class="codehilite"><pre><span></span><code>config/
├── dev.json                 # 開發環境
├── staging.json             # 測試環境
├── prod.json               # 生產環境
└── local.json              # 本地環境
// config/dev.json
{
  &quot;apiBaseUrl&quot;: &quot;https://dev-api.example.com&quot;,
  &quot;enableLogging&quot;: true,
  &quot;enableAnalytics&quot;: false,
  &quot;features&quot;: {
    &quot;newFeature&quot;: true,
    &quot;betaFeature&quot;: false
  },
  &quot;keys&quot;: {
    &quot;googleMaps&quot;: &quot;dev_google_maps_key&quot;,
    &quot;firebase&quot;: {
      &quot;appId&quot;: &quot;dev_firebase_app_id&quot;,
      &quot;apiKey&quot;: &quot;dev_firebase_api_key&quot;
    }
  }
}

// config/prod.json
{
  &quot;apiBaseUrl&quot;: &quot;https://api.example.com&quot;,
  &quot;enableLogging&quot;: false,
  &quot;enableAnalytics&quot;: true,
  &quot;features&quot;: {
    &quot;newFeature&quot;: true,
    &quot;betaFeature&quot;: false
  },
  &quot;keys&quot;: {
    &quot;googleMaps&quot;: &quot;prod_google_maps_key&quot;,
    &quot;firebase&quot;: {
      &quot;appId&quot;: &quot;prod_firebase_app_id&quot;,
      &quot;apiKey&quot;: &quot;prod_firebase_api_key&quot;
    }
  }
}
</code></pre></div>

<h3>2. 配置管理類別</h3>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/services.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">AppConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">AppConfig</span><span class="o">?</span><span class="w"> </span><span class="n">_instance</span><span class="p">;</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">AppConfig</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_instance</span><span class="o">!</span><span class="p">;</span>

<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">apiBaseUrl</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">enableLogging</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">enableAnalytics</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">features</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keys</span><span class="p">;</span>

<span class="w">  </span><span class="n">AppConfig</span><span class="p">.</span><span class="n">_</span><span class="p">();</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">initialize</span><span class="p">({</span><span class="kt">String</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;prod&#39;</span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AppConfig</span><span class="p">.</span><span class="n">_</span><span class="p">();</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">_instance</span><span class="o">!</span><span class="p">.</span><span class="n">_loadConfig</span><span class="p">(</span><span class="n">environment</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadConfig</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">environment</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">configPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;assets/config/</span><span class="si">$</span><span class="n">environment</span><span class="s1">.json&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">configString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">rootBundle</span><span class="p">.</span><span class="n">loadString</span><span class="p">(</span><span class="n">configPath</span><span class="p">);</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">configString</span><span class="p">);</span>

<span class="w">      </span><span class="n">apiBaseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;apiBaseUrl&#39;</span><span class="p">];</span>
<span class="w">      </span><span class="n">enableLogging</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;enableLogging&#39;</span><span class="p">];</span>
<span class="w">      </span><span class="n">enableAnalytics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;enableAnalytics&#39;</span><span class="p">];</span>
<span class="w">      </span><span class="n">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">];</span>
<span class="w">      </span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;keys&#39;</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s1">&#39;Failed to load config for environment: </span><span class="si">$</span><span class="n">environment</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 功能開關</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isFeatureEnabled</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">featureName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">features</span><span class="p">[</span><span class="n">featureName</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 取得 API 金鑰</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">getApiKey</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">keyName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">keys</span><span class="p">[</span><span class="n">keyName</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 取得嵌套金鑰</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">getNestedKey</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">parentKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keys</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;?</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">parentKeys</span><span class="o">?</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// main.dart 中初始化</span>
<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">WidgetsFlutterBinding</span><span class="p">.</span><span class="n">ensureInitialized</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 根據建置模式載入不同配置</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">String</span><span class="p">.</span><span class="n">fromEnvironment</span><span class="p">(</span><span class="s1">&#39;ENV&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">defaultValue:</span><span class="w"> </span><span class="s1">&#39;prod&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">AppConfig</span><span class="p">.</span><span class="n">initialize</span><span class="p">(</span><span class="nl">environment:</span><span class="w"> </span><span class="n">environment</span><span class="p">);</span>

<span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="p">}</span>

<span class="c1">// 使用範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AppConfig</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">apiBaseUrl</span><span class="p">;</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">logEvent</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">AppConfig</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">enableAnalytics</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 傳送分析事件</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>3. 建置指令</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 開發環境</span>
flutter<span class="w"> </span>run<span class="w"> </span>--dart-define<span class="o">=</span><span class="nv">ENV</span><span class="o">=</span>dev

<span class="c1"># 測試環境</span>
flutter<span class="w"> </span>run<span class="w"> </span>--dart-define<span class="o">=</span><span class="nv">ENV</span><span class="o">=</span>staging

<span class="c1"># 生產環境</span>
flutter<span class="w"> </span>build<span class="w"> </span>apk<span class="w"> </span>--dart-define<span class="o">=</span><span class="nv">ENV</span><span class="o">=</span>prod
flutter<span class="w"> </span>build<span class="w"> </span>ios<span class="w"> </span>--dart-define<span class="o">=</span><span class="nv">ENV</span><span class="o">=</span>prod
</code></pre></div>

<hr />
<h2>🔐 安全性配置</h2>
<h3>1. API 金鑰保護</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// lib/config/secrets.dart (不提交到版本控制)</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">Secrets</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">googleMapsApiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">String</span><span class="p">.</span><span class="n">fromEnvironment</span><span class="p">(</span>
<span class="w">    </span><span class="s1">&#39;GOOGLE_MAPS_API_KEY&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nl">defaultValue:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">firebaseApiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">String</span><span class="p">.</span><span class="n">fromEnvironment</span><span class="p">(</span>
<span class="w">    </span><span class="s1">&#39;FIREBASE_API_KEY&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nl">defaultValue:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 使用方式</span>
<span class="n">GoogleMap</span><span class="p">(</span>
<span class="w">  </span><span class="nl">onMapCreated:</span><span class="w"> </span><span class="n">_onMapCreated</span><span class="p">,</span>
<span class="w">  </span><span class="nl">initialCameraPosition:</span><span class="w"> </span><span class="n">CameraPosition</span><span class="p">(</span>
<span class="w">    </span><span class="nl">target:</span><span class="w"> </span><span class="n">LatLng</span><span class="p">(</span><span class="m">37.42796133580664</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">122.085749655962</span><span class="p">),</span>
<span class="w">    </span><span class="nl">zoom:</span><span class="w"> </span><span class="m">14.4746</span><span class="p">,</span>
<span class="w">  </span><span class="p">),</span>
<span class="w">  </span><span class="nl">apiKey:</span><span class="w"> </span><span class="n">Secrets</span><span class="p">.</span><span class="n">googleMapsApiKey</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<h3>2. 網路安全配置</h3>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- android/app/src/main/res/xml/network_security_config.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;network-security-config&gt;</span>
<span class="w">    </span><span class="nt">&lt;domain-config</span><span class="w"> </span><span class="na">cleartextTrafficPermitted=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;domain</span><span class="w"> </span><span class="na">includeSubdomains=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>api.example.com<span class="nt">&lt;/domain&gt;</span>
<span class="w">        </span><span class="nt">&lt;trust-anchors&gt;</span>
<span class="w">            </span><span class="nt">&lt;certificates</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;system&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;certificates</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;user&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/trust-anchors&gt;</span>
<span class="w">    </span><span class="nt">&lt;/domain-config&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 僅開發環境允許 HTTP --&gt;</span>
<span class="w">    </span><span class="nt">&lt;domain-config</span><span class="w"> </span><span class="na">cleartextTrafficPermitted=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;domain</span><span class="w"> </span><span class="na">includeSubdomains=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>localhost<span class="nt">&lt;/domain&gt;</span>
<span class="w">        </span><span class="nt">&lt;domain</span><span class="w"> </span><span class="na">includeSubdomains=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>10.0.2.2<span class="nt">&lt;/domain&gt;</span>
<span class="w">    </span><span class="nt">&lt;/domain-config&gt;</span>
<span class="nt">&lt;/network-security-config&gt;</span>
<span class="cm">&lt;!-- 在 AndroidManifest.xml 中引用 --&gt;</span>
<span class="nt">&lt;application</span>
<span class="w">    </span><span class="na">android:networkSecurityConfig=</span><span class="s">&quot;@xml/network_security_config&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/application&gt;</span>
</code></pre></div>

<h3>3. 程式碼混淆設定</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// android/app/build.gradle</span>
<span class="n">android</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">buildTypes</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">release</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">minifyEnabled</span><span class="w"> </span><span class="n">true</span>
<span class="w">            </span><span class="n">shrinkResources</span><span class="w"> </span><span class="n">true</span>
<span class="w">            </span><span class="n">proguardFiles</span><span class="w"> </span><span class="n">getDefaultProguardFile</span><span class="p">(</span><span class="s">&#39;proguard-android.txt&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;proguard-rules.pro&#39;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
#<span class="w"> </span><span class="n">android</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">proguard</span><span class="o">-</span><span class="n">rules</span><span class="p">.</span><span class="n">pro</span>
<span class="o">-</span><span class="n">keep</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">flutter</span><span class="p">.</span><span class="n">app</span><span class="o">.**</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">*</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="n">keep</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">flutter</span><span class="p">.</span><span class="n">plugin</span><span class="o">.**</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="o">*</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="n">keep</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">flutter</span><span class="p">.</span><span class="n">util</span><span class="o">.**</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="o">*</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="n">keep</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">flutter</span><span class="p">.</span><span class="n">view</span><span class="o">.**</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="o">*</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="n">keep</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">flutter</span><span class="o">.**</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="o">*</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="n">keep</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">flutter</span><span class="p">.</span><span class="n">plugins</span><span class="o">.**</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="o">*</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="o">-</span><span class="n">dontwarn</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">flutter</span><span class="p">.</span><span class="n">embedding</span><span class="o">.**</span>
</code></pre></div>

<hr />
<h2>📊 資源優化策略</h2>
<h3>1. 圖片優化</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># pubspec.yaml - 壓縮設定</span>
<span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">assets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/images/</span>

<span class="w">  </span><span class="c1"># 針對不同平台優化</span>
<span class="w">  </span><span class="nt">generate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">// 圖片快取策略</span>
<span class="l l-Scalar l-Scalar-Plain">class OptimizedImage extends StatelessWidget {</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">final String imagePath;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">final double? width;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">final double? height;</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">const OptimizedImage({</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">Key? key,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">required this.imagePath,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">this.width,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">this.height,</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">})</span><span class="w"> </span><span class="nt">: super(key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key);</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">@override</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">Widget build(BuildContext context) {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">return Image.asset(</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">imagePath,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">width</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">width,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">height</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">height,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">// 記憶體快取設定</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">cacheWidth</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">width?.toInt(),</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">cacheHeight</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">height?.toInt(),</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">// 圖片品質設定</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">filterQuality</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FilterQuality.medium,</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">// 錯誤處理</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">errorBuilder</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(context, error, stackTrace) {</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">return Container(</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">width</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">width,</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">height</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">height,</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">color</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Colors.grey[300],</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">child</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Icon(Icons.error),</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">);</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">},</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">);</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="err">}</span>
</code></pre></div>

<h3>2. 字型子集化</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># pubspec.yaml</span>
<span class="nt">flutter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">family</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CustomFont</span>
<span class="w">      </span><span class="nt">fonts</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">asset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/fonts/CustomFont.ttf</span>
<span class="w">          </span><span class="c1"># 只包含需要的字符</span>
<span class="w">          </span><span class="nt">unicode-range</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">U+0000-00FF, U+0131, U+0152-0153</span>
</code></pre></div>

<h3>3. 資源壓縮腳本</h3>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># scripts/optimize_assets.sh</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;開始優化資源...&quot;</span>

<span class="c1"># 壓縮 PNG 圖片</span>
find<span class="w"> </span>assets/images<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.png&quot;</span><span class="w"> </span>-exec<span class="w"> </span>pngcrush<span class="w"> </span>-rem<span class="w"> </span>allb<span class="w"> </span>-reduce<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="o">{}</span>.tmp<span class="w"> </span><span class="se">\;</span><span class="w"> </span>-exec<span class="w"> </span>mv<span class="w"> </span><span class="o">{}</span>.tmp<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>

<span class="c1"># 壓縮 JPG 圖片</span>
find<span class="w"> </span>assets/images<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.jpg&quot;</span><span class="w"> </span>-exec<span class="w"> </span>jpegoptim<span class="w"> </span>--strip-all<span class="w"> </span>--max<span class="o">=</span><span class="m">85</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>

<span class="c1"># 壓縮 JSON 檔案</span>
find<span class="w"> </span>assets/data<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.json&quot;</span><span class="w"> </span>-exec<span class="w"> </span>jq<span class="w"> </span>-c<span class="w"> </span>.<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="o">{}</span>.tmp<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mv<span class="w"> </span><span class="o">{}</span>.tmp<span class="w"> </span><span class="o">{}</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;資源優化完成！&quot;</span>
</code></pre></div>

<hr />
<h2>🎨 設計系統資源</h2>
<h3>1. 設計代幣 (Design Tokens)</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// assets/design/tokens.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;colors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;primary&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;50&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#e3f2fd&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;100&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#bbdefb&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;500&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#2196f3&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;900&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#0d47a1&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;neutral&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;50&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#fafafa&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;100&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#f5f5f5&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;500&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#9e9e9e&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;900&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#212121&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;spacing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;xs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sm&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;md&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lg&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;xl&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;typography&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;heading1&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;fontSize&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;fontWeight&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;700&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;lineHeight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;body&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;fontSize&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;fontWeight&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;400&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;lineHeight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;borderRadius&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;sm&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;md&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lg&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;full&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">9999</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="c1">// lib/design/design_tokens.dart</span>
<span class="err">impor</span><span class="kc">t</span><span class="w"> </span><span class="err">&#39;dar</span><span class="kc">t</span><span class="p">:</span><span class="err">co</span><span class="kc">n</span><span class="err">ver</span><span class="kc">t</span><span class="err">&#39;;</span>
<span class="err">impor</span><span class="kc">t</span><span class="w"> </span><span class="err">&#39;package</span><span class="p">:</span><span class="kc">flutter</span><span class="err">/ma</span><span class="kc">ter</span><span class="err">ial.dar</span><span class="kc">t</span><span class="err">&#39;;</span>
<span class="err">impor</span><span class="kc">t</span><span class="w"> </span><span class="err">&#39;package</span><span class="p">:</span><span class="kc">flutter</span><span class="err">/services.dar</span><span class="kc">t</span><span class="err">&#39;;</span>

<span class="err">class</span><span class="w"> </span><span class="err">Desig</span><span class="kc">n</span><span class="err">Toke</span><span class="kc">ns</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="err">s</span><span class="kc">tat</span><span class="err">ic</span><span class="w"> </span><span class="err">la</span><span class="kc">te</span><span class="w"> </span><span class="err">Map&lt;S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="p">,</span><span class="w"> </span><span class="err">dy</span><span class="kc">na</span><span class="err">mic&gt;</span><span class="w"> </span><span class="err">_</span><span class="kc">t</span><span class="err">oke</span><span class="kc">ns</span><span class="err">;</span>

<span class="w">  </span><span class="err">s</span><span class="kc">tat</span><span class="err">ic</span><span class="w"> </span><span class="err">Fu</span><span class="kc">ture</span><span class="err">&lt;void&gt;</span><span class="w"> </span><span class="err">i</span><span class="kc">n</span><span class="err">i</span><span class="kc">t</span><span class="err">ialize()</span><span class="w"> </span><span class="err">asy</span><span class="kc">n</span><span class="err">c</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kc">f</span><span class="err">i</span><span class="kc">nal</span><span class="w"> </span><span class="kc">t</span><span class="err">oke</span><span class="kc">n</span><span class="err">S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">awai</span><span class="kc">t</span><span class="w"> </span><span class="err">roo</span><span class="kc">t</span><span class="err">Bu</span><span class="kc">n</span><span class="err">dle.loadS</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g(&#39;asse</span><span class="kc">ts</span><span class="err">/desig</span><span class="kc">n</span><span class="err">/</span><span class="kc">t</span><span class="err">oke</span><span class="kc">ns</span><span class="err">.jso</span><span class="kc">n</span><span class="err">&#39;);</span>
<span class="w">    </span><span class="err">_</span><span class="kc">t</span><span class="err">oke</span><span class="kc">ns</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">jso</span><span class="kc">n</span><span class="err">.decode(</span><span class="kc">t</span><span class="err">oke</span><span class="kc">n</span><span class="err">S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 顏色</span>
<span class="w">  </span><span class="err">s</span><span class="kc">tat</span><span class="err">ic</span><span class="w"> </span><span class="err">Color</span><span class="w"> </span><span class="err">ge</span><span class="kc">t</span><span class="err">Color(S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">pa</span><span class="kc">t</span><span class="err">h)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kc">f</span><span class="err">i</span><span class="kc">nal</span><span class="w"> </span><span class="err">colorHex</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">_ge</span><span class="kc">t</span><span class="err">Nes</span><span class="kc">te</span><span class="err">dValue(pa</span><span class="kc">t</span><span class="err">h)</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g;</span>
<span class="w">    </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="err">Color(i</span><span class="kc">nt</span><span class="err">.parse(colorHex.subs</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g(</span><span class="mi">1</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="err">radix</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="err">)</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="mi">0</span><span class="err">xFF</span><span class="mi">000000</span><span class="err">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 間距</span>
<span class="w">  </span><span class="err">s</span><span class="kc">tat</span><span class="err">ic</span><span class="w"> </span><span class="err">double</span><span class="w"> </span><span class="err">ge</span><span class="kc">t</span><span class="err">Spaci</span><span class="kc">n</span><span class="err">g(S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">size)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="err">(_</span><span class="kc">t</span><span class="err">oke</span><span class="kc">ns</span><span class="p">[</span><span class="err">&#39;spaci</span><span class="kc">n</span><span class="err">g&#39;</span><span class="p">][</span><span class="err">size</span><span class="p">]</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="kc">nu</span><span class="err">m).</span><span class="kc">t</span><span class="err">oDouble();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 字體大小</span>
<span class="w">  </span><span class="err">s</span><span class="kc">tat</span><span class="err">ic</span><span class="w"> </span><span class="err">double</span><span class="w"> </span><span class="err">ge</span><span class="kc">t</span><span class="err">Fo</span><span class="kc">nt</span><span class="err">Size(S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">s</span><span class="kc">t</span><span class="err">yle)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="err">(_</span><span class="kc">t</span><span class="err">oke</span><span class="kc">ns</span><span class="p">[</span><span class="err">&#39;</span><span class="kc">t</span><span class="err">ypography&#39;</span><span class="p">][</span><span class="err">s</span><span class="kc">t</span><span class="err">yle</span><span class="p">][</span><span class="err">&#39;</span><span class="kc">f</span><span class="err">o</span><span class="kc">nt</span><span class="err">Size&#39;</span><span class="p">]</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="kc">nu</span><span class="err">m).</span><span class="kc">t</span><span class="err">oDouble();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 圓角</span>
<span class="w">  </span><span class="err">s</span><span class="kc">tat</span><span class="err">ic</span><span class="w"> </span><span class="err">double</span><span class="w"> </span><span class="err">ge</span><span class="kc">t</span><span class="err">BorderRadius(S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">size)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="err">(_</span><span class="kc">t</span><span class="err">oke</span><span class="kc">ns</span><span class="p">[</span><span class="err">&#39;borderRadius&#39;</span><span class="p">][</span><span class="err">size</span><span class="p">]</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="kc">nu</span><span class="err">m).</span><span class="kc">t</span><span class="err">oDouble();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="err">s</span><span class="kc">tat</span><span class="err">ic</span><span class="w"> </span><span class="err">dy</span><span class="kc">na</span><span class="err">mic</span><span class="w"> </span><span class="err">_ge</span><span class="kc">t</span><span class="err">Nes</span><span class="kc">te</span><span class="err">dValue(S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">pa</span><span class="kc">t</span><span class="err">h)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kc">f</span><span class="err">i</span><span class="kc">nal</span><span class="w"> </span><span class="err">keys</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">pa</span><span class="kc">t</span><span class="err">h.spli</span><span class="kc">t</span><span class="err">(&#39;.&#39;);</span>
<span class="w">    </span><span class="err">dy</span><span class="kc">na</span><span class="err">mic</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">_</span><span class="kc">t</span><span class="err">oke</span><span class="kc">ns</span><span class="err">;</span>
<span class="w">    </span><span class="kc">f</span><span class="err">or</span><span class="w"> </span><span class="err">(</span><span class="kc">f</span><span class="err">i</span><span class="kc">nal</span><span class="w"> </span><span class="err">key</span><span class="w"> </span><span class="err">i</span><span class="kc">n</span><span class="w"> </span><span class="err">keys)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="err">value</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">value</span><span class="p">[</span><span class="err">key</span><span class="p">]</span><span class="err">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="err">value;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用範例</span>
<span class="err">Co</span><span class="kc">nta</span><span class="err">i</span><span class="kc">ner</span><span class="err">(</span>
<span class="w">  </span><span class="err">paddi</span><span class="kc">n</span><span class="err">g</span><span class="p">:</span><span class="w"> </span><span class="err">EdgeI</span><span class="kc">nsets</span><span class="err">.all(Desig</span><span class="kc">n</span><span class="err">Toke</span><span class="kc">ns</span><span class="err">.ge</span><span class="kc">t</span><span class="err">Spaci</span><span class="kc">n</span><span class="err">g(&#39;md&#39;))</span><span class="p">,</span>
<span class="w">  </span><span class="err">decora</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="p">:</span><span class="w"> </span><span class="err">BoxDecora</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">(</span>
<span class="w">    </span><span class="err">color</span><span class="p">:</span><span class="w"> </span><span class="err">Desig</span><span class="kc">n</span><span class="err">Toke</span><span class="kc">ns</span><span class="err">.ge</span><span class="kc">t</span><span class="err">Color(&#39;colors.primary.</span><span class="mi">500</span><span class="err">&#39;)</span><span class="p">,</span>
<span class="w">    </span><span class="err">borderRadius</span><span class="p">:</span><span class="w"> </span><span class="err">BorderRadius.circular(Desig</span><span class="kc">n</span><span class="err">Toke</span><span class="kc">ns</span><span class="err">.ge</span><span class="kc">t</span><span class="err">BorderRadius(&#39;md&#39;))</span><span class="p">,</span>
<span class="w">  </span><span class="err">)</span><span class="p">,</span>
<span class="w">  </span><span class="err">child</span><span class="p">:</span><span class="w"> </span><span class="err">Tex</span><span class="kc">t</span><span class="err">(</span>
<span class="w">    </span><span class="err">&#39;Desig</span><span class="kc">n</span><span class="w"> </span><span class="err">Sys</span><span class="kc">te</span><span class="err">m&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="err">s</span><span class="kc">t</span><span class="err">yle</span><span class="p">:</span><span class="w"> </span><span class="err">Tex</span><span class="kc">t</span><span class="err">S</span><span class="kc">t</span><span class="err">yle(</span>
<span class="w">      </span><span class="kc">f</span><span class="err">o</span><span class="kc">nt</span><span class="err">Size</span><span class="p">:</span><span class="w"> </span><span class="err">Desig</span><span class="kc">n</span><span class="err">Toke</span><span class="kc">ns</span><span class="err">.ge</span><span class="kc">t</span><span class="err">Fo</span><span class="kc">nt</span><span class="err">Size(&#39;headi</span><span class="kc">n</span><span class="err">g</span><span class="mi">1</span><span class="err">&#39;)</span><span class="p">,</span>
<span class="w">      </span><span class="err">color</span><span class="p">:</span><span class="w"> </span><span class="err">Colors.whi</span><span class="kc">te</span><span class="p">,</span>
<span class="w">    </span><span class="err">)</span><span class="p">,</span>
<span class="w">  </span><span class="err">)</span><span class="p">,</span>
<span class="err">)</span>
</code></pre></div>

<hr />
<h2>🧪 測試資源</h2>
<h3>1. 測試資料目錄</h3>
<div class="codehilite"><pre><span></span><code>test/
├── fixtures/                # 測試用固定資料
│   ├── json/
│   │   ├── user_valid.json
│   │   ├── user_invalid.json
│   │   └── api_responses.json
│   ├── images/
│   │   ├── test_image.png
│   │   └── test_avatar.jpg
│   └── data/
│       ├── test_database.db
│       └── test_config.json
├── mocks/                   # Mock 檔案
│   ├── mock_api_service.dart
│   └── mock_data_service.dart
└── helpers/                 # 測試輔助工具
    ├── test_helpers.dart
    └── widget_test_helpers.dart
</code></pre></div>

<h3>2. 測試輔助工具</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// test/helpers/test_helpers.dart</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:io&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/services.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">TestHelpers</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 載入測試用 JSON 資料</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">loadJsonFixture</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;test/fixtures/json/</span><span class="si">$</span><span class="n">path</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">readAsString</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 載入測試用圖片</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Uint8List</span><span class="o">&gt;</span><span class="w"> </span><span class="n">loadImageFixture</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;test/fixtures/images/</span><span class="si">$</span><span class="n">path</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">readAsBytes</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 模擬 AssetBundle</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">mockAssetBundle</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestDefaultBinaryMessengerBinding</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">defaultBinaryMessenger</span>
<span class="w">        </span><span class="p">.</span><span class="n">setMockMethodCallHandler</span><span class="p">(</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">MethodChannel</span><span class="p">(</span><span class="s1">&#39;flutter/assets&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">(</span><span class="n">MethodCall</span><span class="w"> </span><span class="n">methodCall</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">methodCall</span><span class="p">.</span><span class="n">method</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;load&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">asset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">methodCall</span><span class="p">.</span><span class="n">arguments</span><span class="p">;</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">asset</span><span class="p">.</span><span class="n">startsWith</span><span class="p">(</span><span class="s1">&#39;test/fixtures/&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">final</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">asset</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="n">readAsBytes</span><span class="p">();</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// test/helpers/widget_test_helpers.dart</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">WidgetTestHelpers</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 建立測試用的 MaterialApp wrapper</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">wrapWithMaterialApp</span><span class="p">(</span><span class="n">Widget</span><span class="w"> </span><span class="n">widget</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span><span class="nl">body:</span><span class="w"> </span><span class="n">widget</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 建立測試用的主題 wrapper</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">wrapWithTheme</span><span class="p">(</span><span class="n">Widget</span><span class="w"> </span><span class="n">widget</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">ThemeData</span><span class="o">?</span><span class="w"> </span><span class="n">theme</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">theme</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span><span class="nl">body:</span><span class="w"> </span><span class="n">widget</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 等待動畫完成</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">waitForAnimation</span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">1</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 尋找帶有特定文字的 Widget</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Finder</span><span class="w"> </span><span class="n">findTextContaining</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">byWidgetPredicate</span><span class="p">(</span>
<span class="w">      </span><span class="p">(</span><span class="n">widget</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">widget</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Text</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">data</span><span class="o">!</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">text</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>📋 最佳實踐檢查清單</h2>
<h3>✅ 資源管理</h3>
<ul>
<li>[ ] 資源檔案使用有意義的命名</li>
<li>[ ] 圖片提供多種解析度版本</li>
<li>[ ] 大型資源檔案經過壓縮優化</li>
<li>[ ] pubspec.yaml 中正確配置所有資源</li>
<li>[ ] 刪除未使用的資源檔案</li>
</ul>
<h3>✅ 安全性</h3>
<ul>
<li>[ ] 敏感資訊使用環境變數管理</li>
<li>[ ] API 金鑰不硬編碼在程式碼中</li>
<li>[ ] 網路通訊使用 HTTPS</li>
<li>[ ] 設定適當的網路安全策略</li>
<li>[ ] 生產環境啟用程式碼混淆</li>
</ul>
<h3>✅ 效能優化</h3>
<ul>
<li>[ ] 圖片使用適當的解析度和格式</li>
<li>[ ] 實作圖片延遲載入和快取</li>
<li>[ ] 字型檔案進行子集化</li>
<li>[ ] 移除未使用的程式碼和資源</li>
<li>[ ] 設定適當的建置優化選項</li>
</ul>
<h3>✅ 平台配置</h3>
<ul>
<li>[ ] Android 權限設定正確且最小化</li>
<li>[ ] iOS Info.plist 包含必要的權限說明</li>
<li>[ ] 應用程式圖示覆蓋所有必要尺寸</li>
<li>[ ] 啟動畫面在各平台正常顯示</li>
<li>[ ] Deep Link 和 URL Scheme 設定正確</li>
</ul>
<h3>✅ 開發體驗</h3>
<ul>
<li>[ ] 環境配置管理完善</li>
<li>[ ] 測試資料組織良好</li>
<li>[ ] 建置腳本自動化程度高</li>
<li>[ ] 文檔完整且保持更新</li>
<li>[ ] 版本控制忽略敏感檔案</li>
</ul>
<hr />
<h2>🎯 常見問題解決</h2>
<h3>1. 資源載入失敗</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 問題：Image.asset() 無法載入圖片</span>
<span class="c1">// 解決方案：檢查 pubspec.yaml 配置和檔案路徑</span>

<span class="c1">// ❌ 錯誤的配置</span>
<span class="nl">flutter:</span>
<span class="w">  </span><span class="nl">assets:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">assets</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">路徑錯誤</span>

<span class="c1">// ✅ 正確的配置</span>
<span class="nl">flutter:</span>
<span class="w">  </span><span class="nl">assets:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">assets</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">正確路徑</span>

<span class="c1">// 程式碼中使用錯誤處理</span>
<span class="n">Image</span><span class="p">.</span><span class="n">asset</span><span class="p">(</span>
<span class="w">  </span><span class="s1">&#39;assets/images/logo.png&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">errorBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Failed to load image: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span>
<span class="p">)</span>
</code></pre></div>

<h3>2. 字型未生效</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 問題：自訂字型未顯示</span>
<span class="c1">// 解決方案：</span>

<span class="c1">// 1. 檢查 pubspec.yaml 字型配置</span>
<span class="nl">flutter:</span>
<span class="w">  </span><span class="nl">fonts:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">family:</span><span class="w"> </span><span class="n">CustomFont</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">確保</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="err">名稱正確</span>
<span class="w">      </span><span class="nl">fonts:</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nl">asset:</span><span class="w"> </span><span class="n">assets</span><span class="o">/</span><span class="n">fonts</span><span class="o">/</span><span class="n">CustomFont</span><span class="p">.</span><span class="n">ttf</span>

<span class="c1">// 2. 重新執行 flutter clean 和 flutter pub get</span>
<span class="c1">// 3. 重啟應用程式</span>

<span class="c1">// 4. 在程式碼中正確使用</span>
<span class="n">Text</span><span class="p">(</span>
<span class="w">  </span><span class="s1">&#39;Custom Font Text&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">    </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;CustomFont&#39;</span><span class="p">,</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">名稱必須與</span><span class="w"> </span><span class="n">pubspec</span><span class="p">.</span><span class="n">yaml</span><span class="w"> </span><span class="err">一致</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div>

<h3>3. 權限被拒絕</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 問題：執行時權限被拒絕</span>
<span class="c1">// 解決方案：</span>

<span class="c1">// 1. 檢查 AndroidManifest.xml 權限宣告</span>
<span class="c1">// 2. 檢查 iOS Info.plist 權限說明</span>
<span class="c1">// 3. 使用權限請求套件</span>

<span class="nl">dependencies:</span>
<span class="w">  </span><span class="nl">permission_handler:</span><span class="w"> </span><span class="o">^</span><span class="m">10.0</span><span class="p">.</span><span class="m">0</span>

<span class="c1">// 程式碼中請求權限</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:permission_handler/permission_handler.dart&#39;</span><span class="p">;</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requestCameraPermission</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">Permission</span><span class="p">.</span><span class="n">camera</span><span class="p">.</span><span class="n">request</span><span class="p">();</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">isGranted</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 權限已授予</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">isDenied</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 權限被拒絕</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">isPermanentlyDenied</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 權限被永久拒絕，需要引導用戶到設定頁面</span>
<span class="w">    </span><span class="n">openAppSettings</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>4. 建置錯誤</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 問題：建置失敗或資源未包含</span>
<span class="c1"># 解決方案：</span>

<span class="c1"># 1. 清理建置快取</span>
flutter<span class="w"> </span>clean
flutter<span class="w"> </span>pub<span class="w"> </span>get

<span class="c1"># 2. 檢查資源路徑</span>
flutter<span class="w"> </span>analyze

<span class="c1"># 3. 重新生成資源</span>
flutter<span class="w"> </span>packages<span class="w"> </span>pub<span class="w"> </span>run<span class="w"> </span>build_runner<span class="w"> </span>build

<span class="c1"># 4. 檢查平台特定設定</span>
<span class="c1"># Android: 檢查 build.gradle 設定</span>
<span class="c1"># iOS: 檢查 Info.plist 和 Xcode 專案設定</span>
</code></pre></div>

<hr />
<p>這個完整的資源管理與配置指南涵蓋了 Flutter 開發中的各種資源類型和配置方式。記住，良好的資源管理不僅能提升應用程式效能，還能讓開發過程更加順暢。建議將這份指南作為專案開發的參考手冊，確保每個專案都能遵循最佳實踐！</p>
                    </div>
                </div>
            
                <div class="tab-pane fade " id="3.-widgets" 
                     role="tabpanel" aria-labelledby="3.-widgets-tab">
                    <div class="content-wrapper">
                        <h1>Flutter Widget 解析開發指南</h1>
<h2>Widget 基礎概念</h2>
<h3>Widget 的本質</h3>
<p>在 Flutter 中，<strong>一切皆 Widget</strong>。Widget 是 Flutter 應用程式的基本構建塊，它們描述了用戶界面的配置和外觀。</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Widget 是不可變的描述</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Widget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Widget</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 每個 Widget 都必須實現 createElement 方法</span>
<span class="w">  </span><span class="n">Element</span><span class="w"> </span><span class="n">createElement</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 用於優化重建過程</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="o">==</span><span class="p">(</span><span class="kt">Object</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">identical</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">hashCode</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">runtimeType</span><span class="p">.</span><span class="n">hashCode</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h3>Widget 生命週期</h3>
<p>Flutter 中有三種核心概念：</p>
<ol>
<li><strong>Widget</strong>：不可變的配置描述</li>
<li><strong>Element</strong>：Widget 的實例化，管理生命週期</li>
<li><strong>RenderObject</strong>：實際的渲染對象</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1">// StatefulWidget 生命週期示例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MyWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_MyWidgetState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_MyWidgetState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_MyWidgetState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">MyWidget</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// 初始化狀態，只執行一次</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Widget 初始化&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">didChangeDependencies</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">didChangeDependencies</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// 依賴發生變化時調用</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;依賴變化&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 構建 UI，可能被多次調用</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Hello Flutter&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">didUpdateWidget</span><span class="p">(</span><span class="n">MyWidget</span><span class="w"> </span><span class="n">oldWidget</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">didUpdateWidget</span><span class="p">(</span><span class="n">oldWidget</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Widget 配置更新時調用</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Widget 更新&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 清理資源</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Widget 銷毀&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>StatelessWidget vs StatefulWidget</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// StatelessWidget - 無狀態 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">WelcomeScreen</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">WelcomeScreen</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">title</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Welcome to Flutter!&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// StatefulWidget - 有狀態 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">Counter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_CounterState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_CounterState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_CounterState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Counter</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_increment</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_count</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Count: </span><span class="si">$</span><span class="n">_count</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_increment</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Increment&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>Widget 分類體系</h2>
<h3>按功能分類</h3>
<ol>
<li><strong>基礎 Widget</strong>：Text、Icon、Image 等</li>
<li><strong>佈局 Widget</strong>：Container、Row、Column、Stack 等</li>
<li><strong>容器 Widget</strong>：Scaffold、AppBar、Drawer 等</li>
<li><strong>滾動 Widget</strong>：ListView、GridView、ScrollView 等</li>
<li><strong>輸入 Widget</strong>：TextField、Form、Checkbox 等</li>
<li><strong>互動 Widget</strong>：GestureDetector、InkWell、Button 等</li>
<li><strong>動畫 Widget</strong>：AnimatedContainer、Hero、Transition 等</li>
<li><strong>輔助 Widget</strong>：Builder、Consumer、Provider 等</li>
</ol>
<h3>按渲染特性分類</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 1. RenderObjectWidget - 有實際渲染的 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomPaint</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">RenderObjectWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">RenderObject</span><span class="w"> </span><span class="n">createRenderObject</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">RenderCustomPaint</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 2. ProxyWidget - 代理其他 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">InheritedWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ProxyWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 用於數據傳遞</span>
<span class="p">}</span>

<span class="c1">// 3. ComponentWidget - 組合其他 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">StatelessWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ComponentWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 組合其他 Widget 來構建 UI</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>佈局 Widget</h2>
<h3>Container - 最常用的佈局容器</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">ContainerExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="c1">// 尺寸約束</span>
<span class="w">      </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">      </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">      </span><span class="c1">// 邊距</span>
<span class="w">      </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="c1">// 內邊距</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">10</span><span class="p">),</span>
<span class="w">      </span><span class="c1">// 裝飾</span>
<span class="w">      </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">        </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">        </span><span class="nl">boxShadow:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">BoxShadow</span><span class="p">(</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">.</span><span class="n">withOpacity</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span>
<span class="w">            </span><span class="nl">spreadRadius:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">            </span><span class="nl">blurRadius:</span><span class="w"> </span><span class="m">5</span><span class="p">,</span>
<span class="w">            </span><span class="nl">offset:</span><span class="w"> </span><span class="n">Offset</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nl">gradient:</span><span class="w"> </span><span class="n">LinearGradient</span><span class="p">(</span>
<span class="w">          </span><span class="nl">colors:</span><span class="w"> </span><span class="p">[</span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">purple</span><span class="p">],</span>
<span class="w">          </span><span class="nl">begin:</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="n">topLeft</span><span class="p">,</span>
<span class="w">          </span><span class="nl">end:</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="n">bottomRight</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="c1">// 變換</span>
<span class="w">      </span><span class="nl">transform:</span><span class="w"> </span><span class="n">Matrix4</span><span class="p">.</span><span class="n">rotationZ</span><span class="p">(</span><span class="m">0.1</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;Container Example&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Row 和 Column - 線性佈局</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">LinearLayoutExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// Row 水平佈局</span>
<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="w">        </span><span class="c1">// Column 垂直佈局</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">stretch</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Top&#39;</span><span class="p">)),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">10</span><span class="p">),</span>
<span class="w">            </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">purple</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Bottom&#39;</span><span class="p">)),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Stack - 堆疊佈局</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">StackExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Stack</span><span class="p">(</span>
<span class="w">      </span><span class="nl">alignment:</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 背景</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">300</span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="c1">// 定位元素</span>
<span class="w">        </span><span class="n">Positioned</span><span class="p">(</span>
<span class="w">          </span><span class="nl">top:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">          </span><span class="nl">left:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">            </span><span class="nl">width:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">Positioned</span><span class="p">(</span>
<span class="w">          </span><span class="nl">bottom:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">          </span><span class="nl">right:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">            </span><span class="nl">width:</span><span class="w"> </span><span class="m">60</span><span class="p">,</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">40</span><span class="p">,</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="c1">// 居中元素</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">80</span><span class="p">,</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">80</span><span class="p">,</span>
<span class="w">          </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">            </span><span class="nl">shape:</span><span class="w"> </span><span class="n">BoxShape</span><span class="p">.</span><span class="n">circle</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">            </span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">            </span><span class="nl">size:</span><span class="w"> </span><span class="m">40</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Flex 和 Flexible - 彈性佈局</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">FlexExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// Flex Widget</span>
<span class="w">        </span><span class="n">Flex</span><span class="p">(</span>
<span class="w">          </span><span class="nl">direction:</span><span class="w"> </span><span class="n">Axis</span><span class="p">.</span><span class="n">horizontal</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">60</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Flex: 2&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">60</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Flex: 1&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">60</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Flex: 3&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="w">        </span><span class="c1">// Flexible vs Expanded</span>
<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Flexible</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">60</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Flexible&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">flex:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">60</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">purple</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Expanded&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Wrap - 自動換行佈局</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">WrapExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Wrap</span><span class="p">(</span>
<span class="w">      </span><span class="nl">spacing:</span><span class="w"> </span><span class="m">8.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// 水平間距</span>
<span class="w">      </span><span class="nl">runSpacing:</span><span class="w"> </span><span class="m">4.0</span><span class="p">,</span><span class="w"> </span><span class="c1">// 垂直間距</span>
<span class="w">      </span><span class="nl">alignment:</span><span class="w"> </span><span class="n">WrapAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Chip</span><span class="p">(</span>
<span class="w">          </span><span class="nl">label:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">          </span><span class="nl">deleteIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">close</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">18</span><span class="p">),</span>
<span class="w">          </span><span class="nl">onDeleted:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Delete item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>基礎 Widget</h2>
<h3>Text - 文字顯示</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">TextExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 基本文字</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Hello Flutter&#39;</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 自訂樣式</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;Styled Text&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">            </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="w">            </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">TextDecoration</span><span class="p">.</span><span class="n">underline</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decorationColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">            </span><span class="nl">fontFamily:</span><span class="w"> </span><span class="s1">&#39;Roboto&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">letterSpacing:</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="c1">// 行高</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// Rich Text</span>
<span class="w">        </span><span class="n">RichText</span><span class="p">(</span>
<span class="w">          </span><span class="nl">text:</span><span class="w"> </span><span class="n">TextSpan</span><span class="p">(</span>
<span class="w">            </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;Hello &#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">style:</span><span class="w"> </span><span class="n">DefaultTextStyle</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">style</span><span class="p">,</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">TextSpan</span><span class="p">(</span>
<span class="w">                </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;Flutter&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">TextSpan</span><span class="p">(</span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39; World!&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 溢出處理</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;This is a very long text that will overflow&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">overflow:</span><span class="w"> </span><span class="n">TextOverflow</span><span class="p">.</span><span class="n">ellipsis</span><span class="p">,</span>
<span class="w">            </span><span class="nl">maxLines:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 選擇性文字</span>
<span class="w">        </span><span class="n">SelectableText</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;This text can be selected and copied&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Image - 圖片顯示</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">ImageExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 網路圖片</span>
<span class="w">        </span><span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;https://flutter.github.io/assets-for-api-docs/assets/widgets/owl.jpg&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">150</span><span class="p">,</span>
<span class="w">          </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span>
<span class="w">          </span><span class="nl">loadingBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="n">loadingProgress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">loadingProgress</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">150</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">value:</span><span class="w"> </span><span class="n">loadingProgress</span><span class="p">.</span><span class="n">expectedTotalBytes</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                      </span><span class="o">?</span><span class="w"> </span><span class="n">loadingProgress</span><span class="p">.</span><span class="n">cumulativeBytesLoaded</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="n">loadingProgress</span><span class="p">.</span><span class="n">expectedTotalBytes</span><span class="o">!</span>
<span class="w">                      </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nl">errorBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">150</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">300</span><span class="p">],</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 本地資源圖片</span>
<span class="w">        </span><span class="n">Image</span><span class="p">.</span><span class="n">asset</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;assets/images/flutter_logo.png&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 圓形頭像</span>
<span class="w">        </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">          </span><span class="nl">radius:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">          </span><span class="nl">backgroundImage:</span><span class="w"> </span><span class="n">NetworkImage</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;https://flutter.github.io/assets-for-api-docs/assets/widgets/owl.jpg&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Avatar&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 自訂形狀圖片</span>
<span class="w">        </span><span class="n">ClipRRect</span><span class="p">(</span>
<span class="w">          </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">15</span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;https://flutter.github.io/assets-for-api-docs/assets/widgets/owl.jpg&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">width:</span><span class="w"> </span><span class="m">150</span><span class="p">,</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">            </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Icon - 圖標顯示</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">IconExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// Material Icons</span>
<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">home</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">),</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">favorite</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">settings</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">),</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 自訂圖標按鈕</span>
<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">thumb_up</span><span class="p">),</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Like pressed&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">              </span><span class="nl">iconSize:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">share</span><span class="p">),</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Share pressed&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">              </span><span class="nl">iconSize:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">bookmark</span><span class="p">),</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Bookmark pressed&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">,</span>
<span class="w">              </span><span class="nl">iconSize:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 圖標與文字組合</span>
<span class="w">        </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">cloud_download</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Download&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">)),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>輸入與互動 Widget</h2>
<h3>TextField - 文字輸入</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">TextFieldExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_TextFieldExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_TextFieldExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_TextFieldExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">TextFieldExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_controller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_passwordController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_obscureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">_inputText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_controller</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_passwordController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 基本文字輸入框</span>
<span class="w">          </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">            </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_controller</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">              </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Username&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">hintText:</span><span class="w"> </span><span class="s1">&#39;Enter your username&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">              </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_inputText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 密碼輸入框</span>
<span class="w">          </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">            </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_passwordController</span><span class="p">,</span>
<span class="w">            </span><span class="nl">obscureText:</span><span class="w"> </span><span class="n">_obscureText</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">              </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Password&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">hintText:</span><span class="w"> </span><span class="s1">&#39;Enter your password&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">lock</span><span class="p">),</span>
<span class="w">              </span><span class="nl">suffixIcon:</span><span class="w"> </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">_obscureText</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">visibility</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">visibility_off</span><span class="p">),</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_obscureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">_obscureText</span><span class="p">;</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 多行文字輸入框</span>
<span class="w">          </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">            </span><span class="nl">maxLines:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">              </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Description&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">hintText:</span><span class="w"> </span><span class="s1">&#39;Enter description...&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">alignLabelWithHint:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">              </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 數字輸入框</span>
<span class="w">          </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">            </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">number</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">              </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Age&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">calendar_today</span><span class="p">),</span>
<span class="w">              </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 顯示輸入的文字</span>
<span class="w">          </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Input: </span><span class="si">$</span><span class="n">_inputText</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Form - 表單驗證</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">FormExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_FormExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_FormExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_FormExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">FormExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_formKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalKey</span><span class="o">&lt;</span><span class="n">FormState</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_emailController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_nameController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Form</span><span class="p">(</span>
<span class="w">        </span><span class="nl">key:</span><span class="w"> </span><span class="n">_formKey</span><span class="p">,</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="c1">// 姓名輸入</span>
<span class="w">            </span><span class="n">TextFormField</span><span class="p">(</span>
<span class="w">              </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_nameController</span><span class="p">,</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Full Name&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">                </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Please enter your name&#39;</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Name must be at least 2 characters&#39;</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 電子郵件輸入</span>
<span class="w">            </span><span class="n">TextFormField</span><span class="p">(</span>
<span class="w">              </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_emailController</span><span class="p">,</span>
<span class="w">              </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">emailAddress</span><span class="p">,</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Email&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">email</span><span class="p">),</span>
<span class="w">                </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Please enter your email&#39;</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">RegExp</span><span class="p">(</span><span class="s1">r&#39;^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}).hasMatch(value)) {</span>
<span class="s1">                  return &#39;</span><span class="n">Please</span><span class="w"> </span><span class="n">enter</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">email</span><span class="s1">&#39;;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 提交按鈕</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_formKey</span><span class="p">.</span><span class="n">currentState</span><span class="o">!</span><span class="p">.</span><span class="n">validate</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="c1">// 表單驗證通過</span>
<span class="w">                  </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<span class="w">                    </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Form submitted successfully!&#39;</span><span class="p">)),</span>
<span class="w">                  </span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Submit&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">                </span><span class="nl">minimumSize:</span><span class="w"> </span><span class="n">Size</span><span class="p">(</span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Button - 按鈕系列</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">ButtonExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">stretch</span><span class="p">,</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// ElevatedButton - 凸起按鈕</span>
<span class="w">          </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;ElevatedButton pressed&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Elevated Button&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">              </span><span class="nl">primary:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onPrimary:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">              </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">                </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">5</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// OutlinedButton - 輪廓按鈕</span>
<span class="w">          </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;OutlinedButton pressed&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Outlined Button&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">style:</span><span class="w"> </span><span class="n">OutlinedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">              </span><span class="nl">primary:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">              </span><span class="nl">side:</span><span class="w"> </span><span class="n">BorderSide</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span><span class="w"> </span><span class="nl">width:</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">              </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">                </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// TextButton - 文字按鈕</span>
<span class="w">          </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;TextButton pressed&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Text Button&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">              </span><span class="nl">primary:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// FloatingActionButton - 浮動動作按鈕</span>
<span class="w">          </span><span class="n">FloatingActionButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;FAB pressed&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">add</span><span class="p">),</span>
<span class="w">            </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// IconButton - 圖標按鈕</span>
<span class="w">          </span><span class="n">Row</span><span class="p">(</span>
<span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Like pressed&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">favorite</span><span class="p">),</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">                </span><span class="nl">iconSize:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Share pressed&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">share</span><span class="p">),</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">iconSize:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;More pressed&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">more_vert</span><span class="p">),</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">                </span><span class="nl">iconSize:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 自訂按鈕</span>
<span class="w">          </span><span class="n">Container</span><span class="p">(</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Material</span><span class="p">(</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">gradient</span><span class="p">,</span>
<span class="w">              </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">25</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">InkWell</span><span class="p">(</span>
<span class="w">                </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">25</span><span class="p">),</span>
<span class="w">                </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Custom button pressed&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">gradient:</span><span class="w"> </span><span class="n">LinearGradient</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">colors:</span><span class="w"> </span><span class="p">[</span><span class="n">Colors</span><span class="p">.</span><span class="n">purple</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">],</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">25</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;Custom Gradient Button&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>選擇器 Widget</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">SelectionExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_SelectionExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_SelectionExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_SelectionExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">SelectionExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_checkboxValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_switchValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_radioValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">_sliderValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">RangeValues</span><span class="w"> </span><span class="n">_rangeValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RangeValues</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">80</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// Checkbox</span>
<span class="w">          </span><span class="n">CheckboxListTile</span><span class="p">(</span>
<span class="w">            </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Accept Terms and Conditions&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">_checkboxValue</span><span class="p">,</span>
<span class="w">            </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_checkboxValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="o">!</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">controlAffinity:</span><span class="w"> </span><span class="n">ListTileControlAffinity</span><span class="p">.</span><span class="n">leading</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// Switch</span>
<span class="w">          </span><span class="n">SwitchListTile</span><span class="p">(</span>
<span class="w">            </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Enable Notifications&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">_switchValue</span><span class="p">,</span>
<span class="w">            </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_switchValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// Radio Buttons</span>
<span class="w">          </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Select Gender:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">)),</span>
<span class="w">              </span><span class="n">RadioListTile</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Male&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">value:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">                </span><span class="nl">groupValue:</span><span class="w"> </span><span class="n">_radioValue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_radioValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="o">!</span><span class="p">;</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">RadioListTile</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Female&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">value:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                </span><span class="nl">groupValue:</span><span class="w"> </span><span class="n">_radioValue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_radioValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="o">!</span><span class="p">;</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// Slider</span>
<span class="w">          </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Age: </span><span class="si">${</span><span class="n">_sliderValue</span><span class="p">.</span><span class="n">round</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="n">Slider</span><span class="p">(</span>
<span class="w">                </span><span class="nl">value:</span><span class="w"> </span><span class="n">_sliderValue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">min:</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<span class="w">                </span><span class="nl">max:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">                </span><span class="nl">divisions:</span><span class="w"> </span><span class="m">10</span><span class="p">,</span>
<span class="w">                </span><span class="nl">label:</span><span class="w"> </span><span class="n">_sliderValue</span><span class="p">.</span><span class="n">round</span><span class="p">().</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">                </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_sliderValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// Range Slider</span>
<span class="w">          </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Range: </span><span class="si">${</span><span class="n">_rangeValues</span><span class="p">.</span><span class="n">start</span><span class="p">.</span><span class="n">round</span><span class="p">()</span><span class="si">}</span><span class="s1"> - </span><span class="si">${</span><span class="n">_rangeValues</span><span class="p">.</span><span class="n">end</span><span class="p">.</span><span class="n">round</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="n">RangeSlider</span><span class="p">(</span>
<span class="w">                </span><span class="nl">values:</span><span class="w"> </span><span class="n">_rangeValues</span><span class="p">,</span>
<span class="w">                </span><span class="nl">min:</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<span class="w">                </span><span class="nl">max:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">                </span><span class="nl">divisions:</span><span class="w"> </span><span class="m">10</span><span class="p">,</span>
<span class="w">                </span><span class="nl">labels:</span><span class="w"> </span><span class="n">RangeLabels</span><span class="p">(</span>
<span class="w">                  </span><span class="n">_rangeValues</span><span class="p">.</span><span class="n">start</span><span class="p">.</span><span class="n">round</span><span class="p">().</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">                  </span><span class="n">_rangeValues</span><span class="p">.</span><span class="n">end</span><span class="p">.</span><span class="n">round</span><span class="p">().</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_rangeValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">values</span><span class="p">;</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>GestureDetector - 手勢偵測</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">GestureExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_GestureExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_GestureExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_GestureExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">GestureExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">_gestureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Tap, drag, or pinch me!&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="n">Offset</span><span class="w"> </span><span class="n">_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Offset</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Stack</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 基本手勢偵測</span>
<span class="w">        </span><span class="n">Center</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">GestureDetector</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_gestureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Tapped!&#39;</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">onDoubleTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_gestureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Double Tapped!&#39;</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">onLongPress:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_gestureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Long Pressed!&#39;</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">onPanUpdate:</span><span class="w"> </span><span class="p">(</span><span class="n">details</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_gestureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Dragging...&#39;</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">onPanEnd:</span><span class="w"> </span><span class="p">(</span><span class="n">details</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_gestureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Drag ended&#39;</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">10</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="n">_gestureText</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">textAlign:</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 可拖拽的元素</span>
<span class="w">        </span><span class="n">Positioned</span><span class="p">(</span>
<span class="w">          </span><span class="nl">left:</span><span class="w"> </span><span class="n">_position</span><span class="p">.</span><span class="n">dx</span><span class="p">,</span>
<span class="w">          </span><span class="nl">top:</span><span class="w"> </span><span class="n">_position</span><span class="p">.</span><span class="n">dy</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">GestureDetector</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPanUpdate:</span><span class="w"> </span><span class="p">(</span><span class="n">details</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="n">delta</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">                </span><span class="nl">shape:</span><span class="w"> </span><span class="n">BoxShape</span><span class="p">.</span><span class="n">circle</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                </span><span class="n">Icons</span><span class="p">.</span><span class="n">drag_indicator</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>Material Design Widget</h2>
<h3>Scaffold - 應用程式骨架</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">ScaffoldExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_ScaffoldExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ScaffoldExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_ScaffoldExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ScaffoldExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_selectedIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="c1">// 應用程式欄</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Flutter App&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">        </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">        </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">search</span><span class="p">),</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Search pressed&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">more_vert</span><span class="p">),</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;More pressed&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>

<span class="w">      </span><span class="c1">// 主要內容</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">IndexedStack</span><span class="p">(</span>
<span class="w">        </span><span class="nl">index:</span><span class="w"> </span><span class="n">_selectedIndex</span><span class="p">,</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Home Page&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">))),</span>
<span class="w">          </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Search Page&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">))),</span>
<span class="w">          </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Profile Page&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">))),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>

<span class="w">      </span><span class="c1">// 抽屜</span>
<span class="w">      </span><span class="nl">drawer:</span><span class="w"> </span><span class="n">Drawer</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">zero</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">DrawerHeader</span><span class="p">(</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">radius:</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">backgroundImage:</span><span class="w"> </span><span class="n">NetworkImage</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;https://flutter.github.io/assets-for-api-docs/assets/widgets/owl.jpg&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">10</span><span class="p">),</span>
<span class="w">                  </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span><span class="w"> </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="s1">&#39;john.doe@example.com&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white70</span><span class="p">,</span><span class="w"> </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">              </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">home</span><span class="p">),</span>
<span class="w">              </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Home&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">                </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">_selectedIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">                </span><span class="p">});</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">              </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">settings</span><span class="p">),</span>
<span class="w">              </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Settings&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">              </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">logout</span><span class="p">),</span>
<span class="w">              </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Logout&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>

<span class="w">      </span><span class="c1">// 底部導航欄</span>
<span class="w">      </span><span class="nl">bottomNavigationBar:</span><span class="w"> </span><span class="n">BottomNavigationBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">currentIndex:</span><span class="w"> </span><span class="n">_selectedIndex</span><span class="p">,</span>
<span class="w">        </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_selectedIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>
<span class="w">          </span><span class="p">});</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nl">items:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">BottomNavigationBarItem</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">home</span><span class="p">),</span>
<span class="w">            </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;Home&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">BottomNavigationBarItem</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">search</span><span class="p">),</span>
<span class="w">            </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;Search&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">BottomNavigationBarItem</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">            </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;Profile&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>

<span class="w">      </span><span class="c1">// 浮動動作按鈕</span>
<span class="w">      </span><span class="nl">floatingActionButton:</span><span class="w"> </span><span class="n">FloatingActionButton</span><span class="p">(</span>
<span class="w">        </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<span class="w">            </span><span class="n">SnackBar</span><span class="p">(</span>
<span class="w">              </span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;FAB pressed!&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">action:</span><span class="w"> </span><span class="n">SnackBarAction</span><span class="p">(</span>
<span class="w">                </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;Undo&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Undo pressed&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">add</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>

<span class="w">      </span><span class="c1">// 浮動按鈕位置</span>
<span class="w">      </span><span class="nl">floatingActionButtonLocation:</span><span class="w"> </span><span class="n">FloatingActionButtonLocation</span><span class="p">.</span><span class="n">centerDocked</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Card - 卡片</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">CardExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 基本卡片</span>
<span class="w">        </span><span class="n">Card</span><span class="p">(</span>
<span class="w">          </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;Basic Card&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;This is a basic card with some content.&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 圖片卡片</span>
<span class="w">        </span><span class="n">Card</span><span class="p">(</span>
<span class="w">          </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">6</span><span class="p">,</span>
<span class="w">          </span><span class="nl">clipBehavior:</span><span class="w"> </span><span class="n">Clip</span><span class="p">.</span><span class="n">antiAlias</span><span class="p">,</span>
<span class="w">          </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">            </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;https://flutter.github.io/assets-for-api-docs/assets/widgets/owl.jpg&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">                </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;Image Card&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;This card contains an image with some descriptive text below it.&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">600</span><span class="p">]),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceBetween</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                        </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Share pressed&#39;</span><span class="p">),</span>
<span class="w">                          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;SHARE&#39;</span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Learn More pressed&#39;</span><span class="p">),</span>
<span class="w">                          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;LEARN MORE&#39;</span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                      </span><span class="p">],</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 列表卡片</span>
<span class="w">        </span><span class="n">Card</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">            </span><span class="nl">leading:</span><span class="w"> </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">              </span><span class="nl">backgroundImage:</span><span class="w"> </span><span class="n">NetworkImage</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;https://flutter.github.io/assets-for-api-docs/assets/widgets/owl.jpg&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;List Tile Card&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;This is a card with a list tile&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">more_vert</span><span class="p">),</span>
<span class="w">            </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Card tapped&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Dialog - 對話框</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">DialogExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 警告對話框</span>
<span class="w">          </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">showDialog</span><span class="p">(</span>
<span class="w">                </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<span class="w">                </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AlertDialog</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Warning&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Are you sure you want to delete this item?&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">),</span>
<span class="w">                      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Cancel&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">                        </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Item deleted&#39;</span><span class="p">);</span>
<span class="w">                      </span><span class="p">},</span>
<span class="w">                      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Delete&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Show Alert Dialog&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 自訂對話框</span>
<span class="w">          </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">showDialog</span><span class="p">(</span>
<span class="w">                </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<span class="w">                </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Dialog</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                        </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                          </span><span class="n">Icons</span><span class="p">.</span><span class="n">check_circle</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">size:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                          </span><span class="s1">&#39;Success!&#39;</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Operation completed successfully.&#39;</span><span class="p">),</span>
<span class="w">                        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                        </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">),</span>
<span class="w">                          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                      </span><span class="p">],</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Show Custom Dialog&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 底部表單</span>
<span class="w">          </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">showModalBottomSheet</span><span class="p">(</span>
<span class="w">                </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<span class="w">                </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">vertical</span><span class="p">(</span><span class="nl">top:</span><span class="w"> </span><span class="n">Radius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">20</span><span class="p">)),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">height:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="s1">&#39;Bottom Sheet&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                      </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">photo</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Gallery&#39;</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">                          </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Gallery selected&#39;</span><span class="p">);</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">camera_alt</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Camera&#39;</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">                          </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Camera selected&#39;</span><span class="p">);</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">file_copy</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;File&#39;</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">                          </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;File selected&#39;</span><span class="p">);</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Show Bottom Sheet&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>滾動 Widget</h2>
<h3>ListView - 列表視圖</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">ListViewExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 基本列表</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;John Doe&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Software Developer&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Jane Smith&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Designer&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Bob Johnson&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Project Manager&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">Divider</span><span class="p">(),</span>

<span class="w">        </span><span class="c1">// ListView.builder - 動態生成</span>
<span class="w">        </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">            </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">            </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">leading:</span><span class="w"> </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">${</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
<span class="w">                  </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Description for </span><span class="si">${</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">delete</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Delete </span><span class="si">${</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Tapped </span><span class="si">${</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>GridView - 網格視圖</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">GridViewExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 固定數量的網格</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">GridView</span><span class="p">.</span><span class="n">count</span><span class="p">(</span>
<span class="w">            </span><span class="nl">crossAxisCount:</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">            </span><span class="nl">crossAxisSpacing:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">            </span><span class="nl">mainAxisSpacing:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[(</span><span class="n">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m">9</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">],</span>
<span class="w">                  </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">}),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">Divider</span><span class="p">(),</span>

<span class="w">        </span><span class="c1">// 動態網格</span>
<span class="w">        </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">GridView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">            </span><span class="nl">gridDelegate:</span><span class="w"> </span><span class="n">SliverGridDelegateWithFixedCrossAxisCount</span><span class="p">(</span>
<span class="w">              </span><span class="nl">crossAxisCount:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">              </span><span class="nl">crossAxisSpacing:</span><span class="w"> </span><span class="m">8</span><span class="p">,</span>
<span class="w">              </span><span class="nl">mainAxisSpacing:</span><span class="w"> </span><span class="m">8</span><span class="p">,</span>
<span class="w">              </span><span class="nl">childAspectRatio:</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">            </span><span class="nl">itemCount:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">            </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                      </span><span class="n">Icons</span><span class="p">.</span><span class="n">image</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">size:</span><span class="w"> </span><span class="m">40</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;Description&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>PageView - 頁面視圖</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">PageViewExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_PageViewExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_PageViewExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_PageViewExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">PageViewExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">PageController</span><span class="w"> </span><span class="n">_pageController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PageController</span><span class="p">();</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_currentPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">    </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">    </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">    </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">,</span>
<span class="w">    </span><span class="n">Colors</span><span class="p">.</span><span class="n">purple</span><span class="p">,</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 頁面指示器</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="n">_colors</span><span class="p">.</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">                </span><span class="nl">width:</span><span class="w"> </span><span class="m">12</span><span class="p">,</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">,</span>
<span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">shape:</span><span class="w"> </span><span class="n">BoxShape</span><span class="p">.</span><span class="n">circle</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">_currentPage</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">}),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 頁面視圖</span>
<span class="w">        </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">PageView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">            </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_pageController</span><span class="p">,</span>
<span class="w">            </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">_colors</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">            </span><span class="nl">onPageChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_currentPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>
<span class="w">              </span><span class="p">});</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">_colors</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
<span class="w">                  </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                        </span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">size:</span><span class="w"> </span><span class="m">80</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                      </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="s1">&#39;Page </span><span class="si">${</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="w">                          </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 導航按鈕</span>
<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_currentPage</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span>
<span class="w">                  </span><span class="o">?</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="n">_pageController</span><span class="p">.</span><span class="n">previousPage</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">duration:</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">300</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">curve:</span><span class="w"> </span><span class="n">Curves</span><span class="p">.</span><span class="n">easeInOut</span><span class="p">,</span>
<span class="w">                      </span><span class="p">);</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                  </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Previous&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_currentPage</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">_colors</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="w">                  </span><span class="o">?</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="n">_pageController</span><span class="p">.</span><span class="n">nextPage</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">duration:</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">300</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">curve:</span><span class="w"> </span><span class="n">Curves</span><span class="p">.</span><span class="n">easeInOut</span><span class="p">,</span>
<span class="w">                      </span><span class="p">);</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                  </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Next&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>動畫 Widget</h2>
<h3>AnimatedContainer - 動畫容器</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">AnimatedContainerExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_AnimatedContainerExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_AnimatedContainerExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_AnimatedContainerExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AnimatedContainerExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">;</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">_height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">;</span>
<span class="w">  </span><span class="n">Color</span><span class="w"> </span><span class="n">_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">;</span>
<span class="w">  </span><span class="n">BorderRadius</span><span class="w"> </span><span class="n">_borderRadius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">);</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_animateContainer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Random</span><span class="p">();</span>
<span class="w">      </span><span class="n">_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">.</span><span class="n">nextDouble</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">50</span><span class="p">;</span>
<span class="w">      </span><span class="n">_height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">.</span><span class="n">nextDouble</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">50</span><span class="p">;</span>
<span class="w">      </span><span class="n">_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span>
<span class="w">        </span><span class="n">random</span><span class="p">.</span><span class="n">nextInt</span><span class="p">(</span><span class="m">256</span><span class="p">),</span>
<span class="w">        </span><span class="n">random</span><span class="p">.</span><span class="n">nextInt</span><span class="p">(</span><span class="m">256</span><span class="p">),</span>
<span class="w">        </span><span class="n">random</span><span class="p">.</span><span class="n">nextInt</span><span class="p">(</span><span class="m">256</span><span class="p">),</span>
<span class="w">        </span><span class="m">1</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="n">_borderRadius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">nextDouble</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">50</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">AnimatedContainer</span><span class="p">(</span>
<span class="w">          </span><span class="nl">duration:</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">1</span><span class="p">),</span>
<span class="w">          </span><span class="nl">curve:</span><span class="w"> </span><span class="n">Curves</span><span class="p">.</span><span class="n">elasticOut</span><span class="p">,</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="n">_width</span><span class="p">,</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="n">_height</span><span class="p">,</span>
<span class="w">          </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">_color</span><span class="p">,</span>
<span class="w">            </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">_borderRadius</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;Animated&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">32</span><span class="p">),</span>

<span class="w">        </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_animateContainer</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Animate Container&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Hero - 英雄動畫</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">HeroExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">GridView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">gridDelegate:</span><span class="w"> </span><span class="n">SliverGridDelegateWithFixedCrossAxisCount</span><span class="p">(</span>
<span class="w">        </span><span class="nl">crossAxisCount:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">        </span><span class="nl">crossAxisSpacing:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span>
<span class="w">        </span><span class="nl">mainAxisSpacing:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">itemCount:</span><span class="w"> </span><span class="m">10</span><span class="p">,</span>
<span class="w">      </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">GestureDetector</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Navigator</span><span class="p">.</span><span class="n">push</span><span class="p">(</span>
<span class="w">              </span><span class="n">context</span><span class="p">,</span>
<span class="w">              </span><span class="n">MaterialPageRoute</span><span class="p">(</span>
<span class="w">                </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">HeroDetailPage</span><span class="p">(</span><span class="nl">index:</span><span class="w"> </span><span class="n">index</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Hero</span><span class="p">(</span>
<span class="w">            </span><span class="nl">tag:</span><span class="w"> </span><span class="s1">&#39;hero-</span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[(</span><span class="n">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m">9</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">],</span>
<span class="w">                </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">HeroDetailPage</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">HeroDetailPage</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">index</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Detail </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Hero</span><span class="p">(</span>
<span class="w">          </span><span class="nl">tag:</span><span class="w"> </span><span class="s1">&#39;hero-</span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">            </span><span class="nl">width:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[(</span><span class="n">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m">9</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">],</span>
<span class="w">              </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;Detail </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>AnimationController - 自訂動畫</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">CustomAnimationExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_CustomAnimationExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_CustomAnimationExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_CustomAnimationExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">CustomAnimationExample</span><span class="o">&gt;</span>
<span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">TickerProviderStateMixin</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">AnimationController</span><span class="w"> </span><span class="n">_rotationController</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">AnimationController</span><span class="w"> </span><span class="n">_scaleController</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">Animation</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_rotationAnimation</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">Animation</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_scaleAnimation</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>

<span class="w">    </span><span class="n">_rotationController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AnimationController</span><span class="p">(</span>
<span class="w">      </span><span class="nl">duration:</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">      </span><span class="nl">vsync:</span><span class="w"> </span><span class="k">this</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">_scaleController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AnimationController</span><span class="p">(</span>
<span class="w">      </span><span class="nl">duration:</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">500</span><span class="p">),</span>
<span class="w">      </span><span class="nl">vsync:</span><span class="w"> </span><span class="k">this</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">_rotationAnimation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Tween</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">      </span><span class="nl">begin:</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<span class="w">      </span><span class="nl">end:</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="p">,</span>
<span class="w">    </span><span class="p">).</span><span class="n">animate</span><span class="p">(</span><span class="n">CurvedAnimation</span><span class="p">(</span>
<span class="w">      </span><span class="nl">parent:</span><span class="w"> </span><span class="n">_rotationController</span><span class="p">,</span>
<span class="w">      </span><span class="nl">curve:</span><span class="w"> </span><span class="n">Curves</span><span class="p">.</span><span class="n">linear</span><span class="p">,</span>
<span class="w">    </span><span class="p">));</span>

<span class="w">    </span><span class="n">_scaleAnimation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Tween</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">      </span><span class="nl">begin:</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span>
<span class="w">      </span><span class="nl">end:</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span>
<span class="w">    </span><span class="p">).</span><span class="n">animate</span><span class="p">(</span><span class="n">CurvedAnimation</span><span class="p">(</span>
<span class="w">      </span><span class="nl">parent:</span><span class="w"> </span><span class="n">_scaleController</span><span class="p">,</span>
<span class="w">      </span><span class="nl">curve:</span><span class="w"> </span><span class="n">Curves</span><span class="p">.</span><span class="n">elasticOut</span><span class="p">,</span>
<span class="w">    </span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_rotationController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_scaleController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">AnimatedBuilder</span><span class="p">(</span>
<span class="w">          </span><span class="nl">animation:</span><span class="w"> </span><span class="n">_rotationAnimation</span><span class="p">,</span>
<span class="w">          </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Transform</span><span class="p">.</span><span class="n">rotate</span><span class="p">(</span>
<span class="w">              </span><span class="nl">angle:</span><span class="w"> </span><span class="n">_rotationAnimation</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">AnimatedBuilder</span><span class="p">(</span>
<span class="w">                </span><span class="nl">animation:</span><span class="w"> </span><span class="n">_scaleAnimation</span><span class="p">,</span>
<span class="w">                </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="n">Transform</span><span class="p">.</span><span class="n">scale</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">scale:</span><span class="w"> </span><span class="n">_scaleAnimation</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">width:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                        </span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">size:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">);</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">32</span><span class="p">),</span>

<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_rotationController</span><span class="p">.</span><span class="n">repeat</span><span class="p">();</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Rotate&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_rotationController</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Stop&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_scaleController</span><span class="p">.</span><span class="n">forward</span><span class="p">().</span><span class="n">then</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">_scaleController</span><span class="p">.</span><span class="n">reverse</span><span class="p">();</span>
<span class="w">                </span><span class="p">});</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Scale&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>狀態管理 Widget</h2>
<h3>InheritedWidget - 數據傳遞</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">CounterInheritedWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">InheritedWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">VoidCallback</span><span class="w"> </span><span class="n">onIncrement</span><span class="p">;</span>

<span class="w">  </span><span class="n">CounterInheritedWidget</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">count</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">onIncrement</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="nl">child:</span><span class="w"> </span><span class="n">child</span><span class="p">);</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">CounterInheritedWidget</span><span class="o">?</span><span class="w"> </span><span class="n">of</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">dependOnInheritedWidgetOfExactType</span><span class="o">&lt;</span><span class="n">CounterInheritedWidget</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">updateShouldNotify</span><span class="p">(</span><span class="n">CounterInheritedWidget</span><span class="w"> </span><span class="n">oldWidget</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">oldWidget</span><span class="p">.</span><span class="n">count</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">InheritedWidgetExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_InheritedWidgetExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_InheritedWidgetExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_InheritedWidgetExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">InheritedWidgetExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_increment</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_count</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">CounterInheritedWidget</span><span class="p">(</span>
<span class="w">      </span><span class="nl">count:</span><span class="w"> </span><span class="n">_count</span><span class="p">,</span>
<span class="w">      </span><span class="nl">onIncrement:</span><span class="w"> </span><span class="n">_increment</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">CounterDisplay</span><span class="p">(),</span>
<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">          </span><span class="n">CounterButton</span><span class="p">(),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CounterDisplay</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CounterInheritedWidget</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">      </span><span class="s1">&#39;Count: </span><span class="si">${</span><span class="n">counter</span><span class="o">?</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CounterButton</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CounterInheritedWidget</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">counter</span><span class="o">?</span><span class="p">.</span><span class="n">onIncrement</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Increment&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>ValueNotifier - 輕量級狀態管理</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">ValueNotifierExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_ValueNotifierExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ValueNotifierExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_ValueNotifierExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ValueNotifierExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ValueNotifier</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ValueNotifier</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ValueNotifier</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ValueNotifier</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_counter</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_color</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 監聽計數器變化</span>
<span class="w">        </span><span class="n">ValueListenableBuilder</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">valueListenable:</span><span class="w"> </span><span class="n">_counter</span><span class="p">,</span>
<span class="w">          </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;Counter: </span><span class="si">$</span><span class="n">value</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 監聽顏色變化</span>
<span class="w">        </span><span class="n">ValueListenableBuilder</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">valueListenable:</span><span class="w"> </span><span class="n">_color</span><span class="p">,</span>
<span class="w">          </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">color</span><span class="p">,</span>
<span class="w">                </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">50</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                </span><span class="n">Icons</span><span class="p">.</span><span class="n">favorite</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                </span><span class="nl">size:</span><span class="w"> </span><span class="m">40</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 操作按鈕</span>
<span class="w">        </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_counter</span><span class="p">.</span><span class="n">value</span><span class="o">++</span><span class="p">;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Increment&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_counter</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Reset&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">final</span><span class="w"> </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">];</span>
<span class="w">                </span><span class="n">_color</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">[</span><span class="n">Random</span><span class="p">().</span><span class="n">nextInt</span><span class="p">(</span><span class="n">colors</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Change Color&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>StreamBuilder - 異步數據流</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">StreamBuilderExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_StreamBuilderExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_StreamBuilderExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_StreamBuilderExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">StreamBuilderExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">Stream</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_numberStream</span><span class="p">;</span>
<span class="w">  </span><span class="n">StreamController</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_messageController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StreamController</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// 創建一個每秒遞增的數字流</span>
<span class="w">    </span><span class="n">_numberStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="p">.</span><span class="n">periodic</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">count</span><span class="p">).</span><span class="n">take</span><span class="p">(</span><span class="m">60</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_messageController</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_addMessage</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_messageController</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 數字計時器</span>
<span class="w">          </span><span class="n">StreamBuilder</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">            </span><span class="nl">stream:</span><span class="w"> </span><span class="n">_numberStream</span><span class="p">,</span>
<span class="w">            </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">snapshot</span><span class="p">.</span><span class="n">hasError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Error: </span><span class="si">${</span><span class="n">snapshot</span><span class="p">.</span><span class="n">error</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">              </span><span class="p">}</span>

<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">snapshot</span><span class="p">.</span><span class="n">connectionState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ConnectionState</span><span class="p">.</span><span class="n">waiting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">();</span>
<span class="w">              </span><span class="p">}</span>

<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">snapshot</span><span class="p">.</span><span class="n">hasData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;No data&#39;</span><span class="p">);</span>
<span class="w">              </span><span class="p">}</span>

<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">10</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;Timer: </span><span class="si">${</span><span class="n">snapshot</span><span class="p">.</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 消息流</span>
<span class="w">          </span><span class="n">Container</span><span class="p">(</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">            </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">              </span><span class="nl">border:</span><span class="w"> </span><span class="n">Border</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">),</span>
<span class="w">              </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">StreamBuilder</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">              </span><span class="nl">stream:</span><span class="w"> </span><span class="n">_messageController</span><span class="p">.</span><span class="n">stream</span><span class="p">,</span>
<span class="w">              </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">snapshot</span><span class="p">.</span><span class="n">hasData</span><span class="p">)</span>
<span class="w">                      </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">only</span><span class="p">(</span><span class="nl">bottom:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">                          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">200</span><span class="p">],</span>
<span class="w">                          </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                          </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">toString</span><span class="p">().</span><span class="n">substring</span><span class="p">(</span><span class="m">11</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">)</span><span class="si">}</span><span class="s1">: </span><span class="si">${</span><span class="n">snapshot</span><span class="p">.</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 操作按鈕</span>
<span class="w">          </span><span class="n">Row</span><span class="p">(</span>
<span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_addMessage</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Say Hello&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_addMessage</span><span class="p">(</span><span class="s1">&#39;Good morning!&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Good Morning&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_addMessage</span><span class="p">(</span><span class="s1">&#39;Goodbye!&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Goodbye&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>自訂 Widget 開發</h2>
<h3>創建可重用的組件</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 自訂按鈕組件</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomButton</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">VoidCallback</span><span class="o">?</span><span class="w"> </span><span class="n">onPressed</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Color</span><span class="o">?</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Color</span><span class="o">?</span><span class="w"> </span><span class="n">textColor</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">IconData</span><span class="o">?</span><span class="w"> </span><span class="n">icon</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">CustomButton</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">backgroundColor</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">textColor</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">icon</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">      </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">        </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">        </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">          </span><span class="nl">primary:</span><span class="w"> </span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">Theme</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">primaryColor</span><span class="p">,</span>
<span class="w">          </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">            </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">isLoading</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span>
<span class="w">                </span><span class="nl">width:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">strokeWidth:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">valueColor:</span><span class="w"> </span><span class="n">AlwaysStoppedAnimation</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">                    </span><span class="n">textColor</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">)</span>
<span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icon</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">...[</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">textColor</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">),</span>
<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">width:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                  </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">text</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">textColor</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 自訂輸入框組件</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomTextField</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">label</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">hint</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">IconData</span><span class="o">?</span><span class="w"> </span><span class="n">prefixIcon</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">obscureText</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextInputType</span><span class="w"> </span><span class="n">keyboardType</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">validator</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">onChanged</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="o">?</span><span class="w"> </span><span class="n">controller</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">CustomTextField</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">label</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">hint</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">prefixIcon</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">obscureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">keyboardType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">validator</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">onChanged</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">controller</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_CustomTextFieldState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_CustomTextFieldState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_CustomTextFieldState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">CustomTextField</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_obscureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="n">_obscureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">obscureText</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">          </span><span class="n">widget</span><span class="p">.</span><span class="n">label</span><span class="p">,</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">            </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">,</span>
<span class="w">            </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">w500</span><span class="p">,</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">700</span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">        </span><span class="n">TextFormField</span><span class="p">(</span>
<span class="w">          </span><span class="nl">controller:</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">controller</span><span class="p">,</span>
<span class="w">          </span><span class="nl">obscureText:</span><span class="w"> </span><span class="n">_obscureText</span><span class="p">,</span>
<span class="w">          </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">keyboardType</span><span class="p">,</span>
<span class="w">          </span><span class="nl">validator:</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">validator</span><span class="p">,</span>
<span class="w">          </span><span class="nl">onChanged:</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">onChanged</span><span class="p">,</span>
<span class="w">          </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">            </span><span class="nl">hintText:</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">hint</span><span class="p">,</span>
<span class="w">            </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">prefixIcon</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">prefixIcon</span><span class="p">)</span><span class="w"> </span>
<span class="w">                </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">            </span><span class="nl">suffixIcon:</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">obscureText</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                      </span><span class="n">_obscureText</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">visibility_off</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">visibility</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">_obscureText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">_obscureText</span><span class="p">;</span>
<span class="w">                      </span><span class="p">});</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                  </span><span class="p">)</span>
<span class="w">                </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">            </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(</span>
<span class="w">              </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">              </span><span class="nl">borderSide:</span><span class="w"> </span><span class="n">BorderSide</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">300</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">focusedBorder:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(</span>
<span class="w">              </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">              </span><span class="nl">borderSide:</span><span class="w"> </span><span class="n">BorderSide</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Theme</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">primaryColor</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">filled:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nl">fillColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">50</span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 自訂卡片組件</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomCard</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">EdgeInsetsGeometry</span><span class="o">?</span><span class="w"> </span><span class="n">padding</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Color</span><span class="o">?</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">elevation</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">VoidCallback</span><span class="o">?</span><span class="w"> </span><span class="n">onTap</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">CustomCard</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">child</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">padding</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">backgroundColor</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">elevation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">onTap</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">      </span><span class="nl">elevation:</span><span class="w"> </span><span class="n">elevation</span><span class="p">,</span>
<span class="w">      </span><span class="nl">color:</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">,</span>
<span class="w">      </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">InkWell</span><span class="p">(</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">        </span><span class="nl">onTap:</span><span class="w"> </span><span class="n">onTap</span><span class="p">,</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">child</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用自訂組件的示例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomWidgetExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_CustomWidgetExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_CustomWidgetExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_CustomWidgetExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">CustomWidgetExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_formKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalKey</span><span class="o">&lt;</span><span class="n">FormState</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_emailController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_passwordController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Custom Widgets&#39;</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Form</span><span class="p">(</span>
<span class="w">          </span><span class="nl">key:</span><span class="w"> </span><span class="n">_formKey</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">CustomCard</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="n">CustomTextField</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;Email&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">hint:</span><span class="w"> </span><span class="s1">&#39;Enter your email&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">emailAddress</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_emailController</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="o">?</span><span class="p">.</span><span class="n">isEmpty</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Please enter your email&#39;</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">                      </span><span class="p">},</span>
<span class="w">                    </span><span class="p">),</span>

<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">                    </span><span class="n">CustomTextField</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;Password&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">hint:</span><span class="w"> </span><span class="s1">&#39;Enter your password&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">lock</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">obscureText:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_passwordController</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="o">?</span><span class="p">.</span><span class="n">isEmpty</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Please enter your password&#39;</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="o">!</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Password must be at least 6 characters&#39;</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">                      </span><span class="p">},</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>

<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">              </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;Login&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">login</span><span class="p">,</span>
<span class="w">                </span><span class="nl">isLoading:</span><span class="w"> </span><span class="n">_isLoading</span><span class="p">,</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_formKey</span><span class="p">.</span><span class="n">currentState</span><span class="o">!</span><span class="p">.</span><span class="n">validate</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">                    </span><span class="p">});</span>

<span class="w">                    </span><span class="c1">// 模擬登入過程</span>
<span class="w">                    </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">));</span>

<span class="w">                    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">                    </span><span class="p">});</span>

<span class="w">                    </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<span class="w">                      </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Login successful!&#39;</span><span class="p">)),</span>
<span class="w">                    </span><span class="p">);</span>
<span class="w">                  </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>

<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">              </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;Sign Up&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">                </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">person_add</span><span class="p">,</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Sign up pressed&#39;</span><span class="p">);</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>RenderObject 自訂渲染</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 自訂渲染對象</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomPainter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">CustomPainter</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">paint</span><span class="p">(</span><span class="n">Canvas</span><span class="w"> </span><span class="n">canvas</span><span class="p">,</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">paint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Paint</span><span class="p">()</span>
<span class="w">      </span><span class="p">..</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span>
<span class="w">      </span><span class="p">..</span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PaintingStyle</span><span class="p">.</span><span class="n">fill</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 繪製圓形</span>
<span class="w">    </span><span class="n">canvas</span><span class="p">.</span><span class="n">drawCircle</span><span class="p">(</span>
<span class="w">      </span><span class="n">Offset</span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">      </span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">      </span><span class="n">paint</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 繪製線條</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">linePaint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Paint</span><span class="p">()</span>
<span class="w">      </span><span class="p">..</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span>
<span class="w">      </span><span class="p">..</span><span class="n">strokeWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span>

<span class="w">    </span><span class="n">canvas</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span>
<span class="w">      </span><span class="n">Offset</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">      </span><span class="n">Offset</span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">),</span>
<span class="w">      </span><span class="n">linePaint</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">canvas</span><span class="p">.</span><span class="n">drawLine</span><span class="p">(</span>
<span class="w">      </span><span class="n">Offset</span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">      </span><span class="n">Offset</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">),</span>
<span class="w">      </span><span class="n">linePaint</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">shouldRepaint</span><span class="p">(</span><span class="kd">covariant</span><span class="w"> </span><span class="n">CustomPainter</span><span class="w"> </span><span class="n">oldDelegate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CustomPaintWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">      </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">CustomPaint</span><span class="p">(</span>
<span class="w">        </span><span class="nl">painter:</span><span class="w"> </span><span class="n">CustomPainter</span><span class="p">(),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;Custom Paint&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">              </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>性能優化策略</h2>
<h3>Widget 重建優化</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 使用 const 建構子</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">OptimizedWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">OptimizedWidget</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Static Text&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">// const constructor</span>
<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span><span class="w">   </span><span class="c1">// const constructor</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 分離可變和不可變部分</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">SeparatedWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_SeparatedWidgetState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_SeparatedWidgetState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_SeparatedWidgetState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">SeparatedWidget</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">_counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 不變的部分使用 const</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;This text never changes&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 可變的部分單獨分離</span>
<span class="w">        </span><span class="n">CounterDisplay</span><span class="p">(</span><span class="nl">counter:</span><span class="w"> </span><span class="n">_counter</span><span class="p">),</span>

<span class="w">        </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">_counter</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Increment&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CounterDisplay</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">counter</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">CounterDisplay</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">counter</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;CounterDisplay rebuilt&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 只有當 counter 改變時才會重建</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">      </span><span class="s1">&#39;Counter: </span><span class="si">$</span><span class="n">counter</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>ListView 性能優化</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">OptimizedListView</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">10000</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">      </span><span class="c1">// 使用 itemExtent 提高滾動性能</span>
<span class="w">      </span><span class="nl">itemExtent:</span><span class="w"> </span><span class="m">80</span><span class="p">,</span>
<span class="w">      </span><span class="c1">// 緩存範圍</span>
<span class="w">      </span><span class="nl">cacheExtent:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">      </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">      </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ListItem</span><span class="p">(</span>
<span class="w">          </span><span class="nl">key:</span><span class="w"> </span><span class="n">ValueKey</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span><span class="w"> </span><span class="c1">// 使用 ValueKey 優化</span>
<span class="w">          </span><span class="nl">title:</span><span class="w"> </span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
<span class="w">          </span><span class="nl">index:</span><span class="w"> </span><span class="n">index</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ListItem</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ListItem</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">height:</span><span class="w"> </span><span class="m">80</span><span class="p">,</span>
<span class="w">      </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">          </span><span class="nl">leading:</span><span class="w"> </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">${</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
<span class="w">          </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>圖片性能優化</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">OptimizedImageWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">imageUrl</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">OptimizedImageWidget</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">      </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">ClipRRect</span><span class="p">(</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span>
<span class="w">          </span><span class="n">imageUrl</span><span class="p">,</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span>
<span class="w">          </span><span class="c1">// 性能優化配置</span>
<span class="w">          </span><span class="nl">filterQuality:</span><span class="w"> </span><span class="n">FilterQuality</span><span class="p">.</span><span class="n">medium</span><span class="p">,</span>
<span class="w">          </span><span class="nl">loadingBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="n">loadingProgress</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">loadingProgress</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">200</span><span class="p">],</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">value:</span><span class="w"> </span><span class="n">loadingProgress</span><span class="p">.</span><span class="n">expectedTotalBytes</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                      </span><span class="o">?</span><span class="w"> </span><span class="n">loadingProgress</span><span class="p">.</span><span class="n">cumulativeBytesLoaded</span><span class="w"> </span><span class="o">/</span>
<span class="w">                          </span><span class="n">loadingProgress</span><span class="p">.</span><span class="n">expectedTotalBytes</span><span class="o">!</span>
<span class="w">                      </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nl">errorBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">300</span><span class="p">],</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">50</span><span class="p">),</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="c1">// 使用緩存</span>
<span class="w">          </span><span class="nl">cacheWidth:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">cacheHeight:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>最佳實踐與設計模式</h2>
<h3>組件組合模式</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 基礎組件</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">BaseButton</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">VoidCallback</span><span class="o">?</span><span class="w"> </span><span class="n">onPressed</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">enabled</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">BaseButton</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 主要按鈕</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">PrimaryButton</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseButton</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">PrimaryButton</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">,</span>
<span class="w">    </span><span class="n">VoidCallback</span><span class="o">?</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="nl">text:</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span><span class="w"> </span><span class="nl">enabled:</span><span class="w"> </span><span class="n">enabled</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">onPressed</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">        </span><span class="nl">primary:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">        </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">)),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">)),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 次要按鈕</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">SecondaryButton</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseButton</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">SecondaryButton</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">,</span>
<span class="w">    </span><span class="n">VoidCallback</span><span class="o">?</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="nl">text:</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span><span class="w"> </span><span class="nl">enabled:</span><span class="w"> </span><span class="n">enabled</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">onPressed</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nl">style:</span><span class="w"> </span><span class="n">OutlinedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">        </span><span class="nl">side:</span><span class="w"> </span><span class="n">BorderSide</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">),</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">        </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">)),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">)),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Builder 模式</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">DialogBuilder</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">_title</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">_content</span><span class="p">;</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="n">DialogBuilder</span><span class="w"> </span><span class="n">setTitle</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">DialogBuilder</span><span class="w"> </span><span class="n">setContent</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">content</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">content</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">DialogBuilder</span><span class="w"> </span><span class="n">addAction</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">VoidCallback</span><span class="w"> </span><span class="n">onPressed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_actions</span><span class="p">.</span><span class="n">add</span><span class="p">(</span>
<span class="w">      </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">        </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">AlertDialog</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="n">_title</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">_title</span><span class="o">!</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nl">content:</span><span class="w"> </span><span class="n">_content</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">_content</span><span class="o">!</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nl">actions:</span><span class="w"> </span><span class="n">_actions</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">show</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">showDialog</span><span class="p">(</span>
<span class="w">      </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<span class="w">      </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">build</span><span class="p">(),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用示例</span>
<span class="kt">void</span><span class="w"> </span><span class="n">showCustomDialog</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">DialogBuilder</span><span class="p">()</span>
<span class="w">      </span><span class="p">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s1">&#39;Confirmation&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="n">setContent</span><span class="p">(</span><span class="s1">&#39;Are you sure you want to delete this item?&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Cancel&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
<span class="w">      </span><span class="p">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Delete&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Item deleted&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="n">show</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3>響應式設計</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">ResponsiveWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">mobile</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">tablet</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">desktop</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ResponsiveWidget</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">mobile</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">tablet</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">desktop</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">LayoutBuilder</span><span class="p">(</span>
<span class="w">      </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">constraints</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">constraints</span><span class="p">.</span><span class="n">maxWidth</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">600</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">mobile</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">constraints</span><span class="p">.</span><span class="n">maxWidth</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">1200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">tablet</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">desktop</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ResponsiveLayout</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ResponsiveWidget</span><span class="p">(</span>
<span class="w">      </span><span class="nl">mobile:</span><span class="w"> </span><span class="n">MobileLayout</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">tablet:</span><span class="w"> </span><span class="n">TabletLayout</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">desktop:</span><span class="w"> </span><span class="n">DesktopLayout</span><span class="p">(),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MobileLayout</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Mobile Header&#39;</span><span class="p">)),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Mobile Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">}),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">TabletLayout</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">250</span><span class="p">,</span>
<span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">200</span><span class="p">],</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Sidebar Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">}),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Tablet Header&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">GridView</span><span class="p">.</span><span class="n">count</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">crossAxisCount:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">)),</span>
<span class="w">                    </span><span class="p">);</span>
<span class="w">                  </span><span class="p">}),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">DesktopLayout</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">250</span><span class="p">,</span>
<span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">200</span><span class="p">],</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Navigation&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Nav Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="p">);</span>
<span class="w">                  </span><span class="p">}),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">80</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Desktop Header&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">GridView</span><span class="p">.</span><span class="n">count</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">crossAxisCount:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">)),</span>
<span class="w">                    </span><span class="p">);</span>
<span class="w">                  </span><span class="p">}),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Container</span><span class="p">(</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">80</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Sidebar&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Side Item </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="p">);</span>
<span class="w">                  </span><span class="p">}),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>主題與樣式管理</h3>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">AppTheme</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="n">primaryColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="mh">0xFF2196F3</span><span class="p">);</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="n">secondaryColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="mh">0xFF03DAC6</span><span class="p">);</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="n">errorColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="mh">0xFFB00020</span><span class="p">);</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">ThemeData</span><span class="w"> </span><span class="n">lightTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<span class="w">    </span><span class="nl">primarySwatch:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">    </span><span class="nl">primaryColor:</span><span class="w"> </span><span class="n">primaryColor</span><span class="p">,</span>
<span class="w">    </span><span class="nl">brightness:</span><span class="w"> </span><span class="n">Brightness</span><span class="p">.</span><span class="n">light</span><span class="p">,</span>
<span class="w">    </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span>
<span class="w">    </span><span class="nl">scaffoldBackgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">50</span><span class="p">],</span>

<span class="w">    </span><span class="c1">// 文字主題</span>
<span class="w">    </span><span class="nl">textTheme:</span><span class="w"> </span><span class="n">TextTheme</span><span class="p">(</span>
<span class="w">      </span><span class="nl">headline1:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">32</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">black87</span><span class="p">),</span>
<span class="w">      </span><span class="nl">headline2:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">black87</span><span class="p">),</span>
<span class="w">      </span><span class="nl">headline3:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">w600</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">black87</span><span class="p">),</span>
<span class="w">      </span><span class="nl">bodyText1:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">black87</span><span class="p">),</span>
<span class="w">      </span><span class="nl">bodyText2:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">black54</span><span class="p">),</span>
<span class="w">    </span><span class="p">),</span>

<span class="w">    </span><span class="c1">// 按鈕主題</span>
<span class="w">    </span><span class="nl">elevatedButtonTheme:</span><span class="w"> </span><span class="n">ElevatedButtonThemeData</span><span class="p">(</span>
<span class="w">      </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">        </span><span class="nl">primary:</span><span class="w"> </span><span class="n">primaryColor</span><span class="p">,</span>
<span class="w">        </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">)),</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">),</span>

<span class="w">    </span><span class="c1">// 卡片主題</span>
<span class="w">    </span><span class="nl">cardTheme:</span><span class="w"> </span><span class="n">CardTheme</span><span class="p">(</span>
<span class="w">      </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">      </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">    </span><span class="p">),</span>

<span class="w">    </span><span class="c1">// 輸入框主題</span>
<span class="w">    </span><span class="nl">inputDecorationTheme:</span><span class="w"> </span><span class="n">InputDecorationTheme</span><span class="p">(</span>
<span class="w">      </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">        </span><span class="nl">borderSide:</span><span class="w"> </span><span class="n">BorderSide</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">300</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">focusedBorder:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">        </span><span class="nl">borderSide:</span><span class="w"> </span><span class="n">BorderSide</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">primaryColor</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">filled:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nl">fillColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">50</span><span class="p">],</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">ThemeData</span><span class="w"> </span><span class="n">darkTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<span class="w">    </span><span class="nl">primarySwatch:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="w">    </span><span class="nl">primaryColor:</span><span class="w"> </span><span class="n">primaryColor</span><span class="p">,</span>
<span class="w">    </span><span class="nl">brightness:</span><span class="w"> </span><span class="n">Brightness</span><span class="p">.</span><span class="n">dark</span><span class="p">,</span>
<span class="w">    </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="mh">0xFF121212</span><span class="p">),</span>
<span class="w">    </span><span class="nl">scaffoldBackgroundColor:</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="mh">0xFF121212</span><span class="p">),</span>

<span class="w">    </span><span class="nl">textTheme:</span><span class="w"> </span><span class="n">TextTheme</span><span class="p">(</span>
<span class="w">      </span><span class="nl">headline1:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">32</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">),</span>
<span class="w">      </span><span class="nl">headline2:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">),</span>
<span class="w">      </span><span class="nl">headline3:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">w600</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">),</span>
<span class="w">      </span><span class="nl">bodyText1:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white70</span><span class="p">),</span>
<span class="w">      </span><span class="nl">bodyText2:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white60</span><span class="p">),</span>
<span class="w">    </span><span class="p">),</span>

<span class="w">    </span><span class="nl">cardTheme:</span><span class="w"> </span><span class="n">CardTheme</span><span class="p">(</span>
<span class="w">      </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="mh">0xFF1E1E1E</span><span class="p">),</span>
<span class="w">      </span><span class="nl">shape:</span><span class="w"> </span><span class="n">RoundedRectangleBorder</span><span class="p">(</span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 使用主題的示例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ThemedApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Flutter Themed App&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">AppTheme</span><span class="p">.</span><span class="n">lightTheme</span><span class="p">,</span>
<span class="w">      </span><span class="nl">darkTheme:</span><span class="w"> </span><span class="n">AppTheme</span><span class="p">.</span><span class="n">darkTheme</span><span class="p">,</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">ThemedHomePage</span><span class="p">(),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ThemedHomePage</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Theme</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Themed App&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">stretch</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;Primary Headline&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">theme</span><span class="p">.</span><span class="n">textTheme</span><span class="p">.</span><span class="n">headline1</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;Secondary Headline&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">theme</span><span class="p">.</span><span class="n">textTheme</span><span class="p">.</span><span class="n">headline2</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;This is body text that follows the theme configuration.&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">theme</span><span class="p">.</span><span class="n">textTheme</span><span class="p">.</span><span class="n">bodyText1</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">            </span><span class="n">Card</span><span class="p">(</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;Themed Card&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">theme</span><span class="p">.</span><span class="n">textTheme</span><span class="p">.</span><span class="n">headline3</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;This card uses the theme configuration.&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">theme</span><span class="p">.</span><span class="n">textTheme</span><span class="p">.</span><span class="n">bodyText2</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Themed Button&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">              </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Themed Input&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">hintText:</span><span class="w"> </span><span class="s1">&#39;Enter text here...&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>國際化與本地化</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 多語言支援</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AppLocalizations</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Locale</span><span class="w"> </span><span class="n">locale</span><span class="p">;</span>

<span class="w">  </span><span class="n">AppLocalizations</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">locale</span><span class="p">);</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">AppLocalizations</span><span class="o">?</span><span class="w"> </span><span class="n">of</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Localizations</span><span class="p">.</span><span class="n">of</span><span class="o">&lt;</span><span class="n">AppLocalizations</span><span class="o">&gt;</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AppLocalizations</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">LocalizationsDelegate</span><span class="o">&lt;</span><span class="n">AppLocalizations</span><span class="o">&gt;</span><span class="w"> </span><span class="n">delegate</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">_AppLocalizationsDelegate</span><span class="p">();</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Locale</span><span class="o">&gt;</span><span class="w"> </span><span class="n">supportedLocales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;US&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;zh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TW&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;ja&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JP&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">_localizedValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s1">&#39;en&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;app_title&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Flutter App&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;welcome&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Welcome&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;hello&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;settings&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Settings&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;profile&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Profile&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;logout&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Logout&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;save&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Save&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;cancel&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Cancel&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;delete&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Delete&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;confirm&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Confirm&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s1">&#39;zh&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;app_title&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Flutter 應用程式&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;welcome&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;歡迎&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;hello&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;你好&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;settings&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;設定&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;profile&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;個人資料&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;logout&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;登出&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;save&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;保存&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;cancel&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;取消&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;delete&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;刪除&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;confirm&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;確認&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s1">&#39;ja&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;app_title&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Flutterアプリ&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;welcome&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ようこそ&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;hello&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;こんにちは&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;settings&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;設定&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;profile&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;プロフィール&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;logout&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ログアウト&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;save&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;保存&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;cancel&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;キャンセル&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;delete&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;削除&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;confirm&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;確認&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">_localizedValues</span><span class="p">[</span><span class="n">locale</span><span class="p">.</span><span class="n">languageCode</span><span class="p">]</span><span class="o">?</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">appTitle</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;app_title&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">welcome</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;welcome&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;settings&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">logout</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;logout&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;save&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">cancel</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;cancel&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">delete</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;delete&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">confirm</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getText</span><span class="p">(</span><span class="s1">&#39;confirm&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_AppLocalizationsDelegate</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">LocalizationsDelegate</span><span class="o">&lt;</span><span class="n">AppLocalizations</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">_AppLocalizationsDelegate</span><span class="p">();</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isSupported</span><span class="p">(</span><span class="n">Locale</span><span class="w"> </span><span class="n">locale</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">AppLocalizations</span><span class="p">.</span><span class="n">supportedLocales</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">AppLocalizations</span><span class="o">&gt;</span><span class="w"> </span><span class="n">load</span><span class="p">(</span><span class="n">Locale</span><span class="w"> </span><span class="n">locale</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">AppLocalizations</span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">shouldReload</span><span class="p">(</span><span class="n">_AppLocalizationsDelegate</span><span class="w"> </span><span class="n">old</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 國際化應用程式</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">InternationalizedApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Internationalized App&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">localizationsDelegates:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">AppLocalizations</span><span class="p">.</span><span class="n">delegate</span><span class="p">,</span>
<span class="w">        </span><span class="n">GlobalMaterialLocalizations</span><span class="p">.</span><span class="n">delegate</span><span class="p">,</span>
<span class="w">        </span><span class="n">GlobalWidgetsLocalizations</span><span class="p">.</span><span class="n">delegate</span><span class="p">,</span>
<span class="w">        </span><span class="n">GlobalCupertinoLocalizations</span><span class="p">.</span><span class="n">delegate</span><span class="p">,</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nl">supportedLocales:</span><span class="w"> </span><span class="n">AppLocalizations</span><span class="p">.</span><span class="n">supportedLocales</span><span class="p">,</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">LocalizedHomePage</span><span class="p">(),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">LocalizedHomePage</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_LocalizedHomePageState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_LocalizedHomePageState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_LocalizedHomePageState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">LocalizedHomePage</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Locale</span><span class="w"> </span><span class="n">_currentLocale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;US&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_changeLocale</span><span class="p">(</span><span class="n">Locale</span><span class="w"> </span><span class="n">locale</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_currentLocale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">locale</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">localizations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AppLocalizations</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">!</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">localizations</span><span class="p">.</span><span class="n">appTitle</span><span class="p">),</span>
<span class="w">        </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">PopupMenuButton</span><span class="o">&lt;</span><span class="n">Locale</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">language</span><span class="p">),</span>
<span class="w">          </span><span class="nl">onSelected:</span><span class="w"> </span><span class="n">_changeLocale</span><span class="p">,</span>
<span class="w">          </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">PopupMenuItem</span><span class="p">(</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;US&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;English&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">PopupMenuItem</span><span class="p">(</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;zh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TW&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;繁體中文&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">PopupMenuItem</span><span class="p">(</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;ja&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JP&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;日本語&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">stretch</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="n">localizations</span><span class="p">.</span><span class="n">welcome</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="n">localizations</span><span class="p">.</span><span class="n">hello</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">            </span><span class="n">Card</span><span class="p">(</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">settings</span><span class="p">),</span>
<span class="w">                      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">localizations</span><span class="p">.</span><span class="n">settings</span><span class="p">),</span>
<span class="w">                      </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">                      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">localizations</span><span class="p">.</span><span class="n">profile</span><span class="p">),</span>
<span class="w">                      </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">logout</span><span class="p">),</span>
<span class="w">                      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">localizations</span><span class="p">.</span><span class="n">logout</span><span class="p">),</span>
<span class="w">                      </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">            </span><span class="n">Row</span><span class="p">(</span>
<span class="w">              </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">localizations</span><span class="p">.</span><span class="n">save</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">localizations</span><span class="p">.</span><span class="n">cancel</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">localizations</span><span class="p">.</span><span class="n">delete</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span><span class="nl">primary:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>錯誤處理與異常管理</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 全域錯誤處理</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ErrorHandler</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">handleError</span><span class="p">(</span><span class="kt">dynamic</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">StackTrace</span><span class="o">?</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Error: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Stack trace: </span><span class="si">$</span><span class="n">stackTrace</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 這裡可以添加日誌記錄、錯誤報告等功能</span>
<span class="w">    </span><span class="c1">// 例如：Firebase Crashlytics, Sentry 等</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 錯誤邊界 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ErrorBoundary</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="kt">dynamic</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">errorBuilder</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ErrorBoundary</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">child</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">errorBuilder</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_ErrorBoundaryState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ErrorBoundaryState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_ErrorBoundaryState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ErrorBoundary</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">_error</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">errorBuilder</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">errorBuilder</span><span class="o">!</span><span class="p">(</span><span class="n">_error</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)),</span>
<span class="w">        </span><span class="nl">body:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">64</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">              </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;Something went wrong&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">              </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">_error</span><span class="p">.</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">                </span><span class="nl">textAlign:</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>
<span class="w">              </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">                  </span><span class="p">});</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Retry&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">child</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">didChangeDependencies</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">didChangeDependencies</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 捕獲子 Widget 的錯誤</span>
<span class="w">    </span><span class="n">FlutterError</span><span class="p">.</span><span class="n">onError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FlutterErrorDetails</span><span class="w"> </span><span class="n">details</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="n">exception</span><span class="p">;</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="n">ErrorHandler</span><span class="p">.</span><span class="n">handleError</span><span class="p">(</span><span class="n">details</span><span class="p">.</span><span class="n">exception</span><span class="p">,</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="n">stack</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 異步操作錯誤處理</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AsyncOperationWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_AsyncOperationWidgetState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_AsyncOperationWidgetState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_AsyncOperationWidgetState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AsyncOperationWidget</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">_error</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">_data</span><span class="p">;</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_performAsyncOperation</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="n">_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 模擬異步操作</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// 隨機產生錯誤來演示錯誤處理</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Random</span><span class="p">().</span><span class="n">nextBool</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s1">&#39;Random error occurred&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Operation completed successfully at </span><span class="si">${</span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">toString</span><span class="p">();</span>
<span class="w">        </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="n">ErrorHandler</span><span class="p">.</span><span class="n">handleError</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stackTrace</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_isLoading</span><span class="p">)</span>
<span class="w">            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">CircularProgressIndicator</span><span class="p">(),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Loading...&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">48</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;Error occurred:&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="n">_error</span><span class="o">!</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">textAlign:</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_performAsyncOperation</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Retry&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_data</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">check_circle</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">48</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                  </span><span class="s1">&#39;Success!&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="n">_data</span><span class="o">!</span><span class="p">),</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_performAsyncOperation</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Run Again&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">          </span><span class="k">else</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_performAsyncOperation</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Start Async Operation&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>測試策略</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Widget 測試示例</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Custom Button Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;CustomButton displays correct text&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">buttonText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test Button&#39;</span><span class="p">;</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">          </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">            </span><span class="nl">body:</span><span class="w"> </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">text:</span><span class="w"> </span><span class="n">buttonText</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">buttonText</span><span class="p">),</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;CustomButton calls onPressed when tapped&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">wasPressed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">          </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">            </span><span class="nl">body:</span><span class="w"> </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;Test Button&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">wasPressed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">tap</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">CustomButton</span><span class="p">));</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pump</span><span class="p">();</span>

<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">wasPressed</span><span class="p">,</span><span class="w"> </span><span class="n">isTrue</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;CustomButton shows loading indicator when isLoading is true&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">          </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">            </span><span class="nl">body:</span><span class="w"> </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;Loading Button&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">isLoading:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">CircularProgressIndicator</span><span class="p">),</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;Loading Button&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">findsNothing</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Counter Widget Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;Counter increments correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">          </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">            </span><span class="nl">body:</span><span class="w"> </span><span class="n">Counter</span><span class="p">(),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;Count: 0&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">);</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">tap</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;Increment&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pump</span><span class="p">();</span>

<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;Count: 1&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="c1">// 單元測試示例</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:test/test.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Utility Functions&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;Email validation works correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">isValidEmail</span><span class="p">(</span><span class="s1">&#39;test@example.com&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">isTrue</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">isValidEmail</span><span class="p">(</span><span class="s1">&#39;invalid-email&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">isFalse</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">isValidEmail</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">isFalse</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;Password strength calculation&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">calculatePasswordStrength</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">PasswordStrength</span><span class="p">.</span><span class="n">weak</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">calculatePasswordStrength</span><span class="p">(</span><span class="s1">&#39;password123&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">PasswordStrength</span><span class="p">.</span><span class="n">medium</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">calculatePasswordStrength</span><span class="p">(</span><span class="s1">&#39;StrongP@ssw0rd!&#39;</span><span class="p">),</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">PasswordStrength</span><span class="p">.</span><span class="n">strong</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="kt">bool</span><span class="w"> </span><span class="n">isValidEmail</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;^[</span><span class="se">\w</span><span class="s1">-</span><span class="err">\</span><span class="s1">.]+@([</span><span class="se">\w</span><span class="s1">-]+</span><span class="err">\</span><span class="s1">.)+[</span><span class="se">\w</span><span class="s1">-]{2,4}).hasMatch(email);</span>
<span class="p">}</span>

<span class="n">enum</span><span class="w"> </span><span class="n">PasswordStrength</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">weak</span><span class="p">,</span><span class="w"> </span><span class="n">medium</span><span class="p">,</span><span class="w"> </span><span class="n">strong</span><span class="w"> </span><span class="p">}</span>

<span class="n">PasswordStrength</span><span class="w"> </span><span class="n">calculatePasswordStrength</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">PasswordStrength</span><span class="p">.</span><span class="n">weak</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">PasswordStrength</span><span class="p">.</span><span class="n">medium</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">PasswordStrength</span><span class="p">.</span><span class="n">strong</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>總結</h2>
<p>本指南涵蓋了 Flutter Widget 開發的各個方面，從基礎概念到高級技巧：</p>
<h3>核心概念</h3>
<ul>
<li><strong>Widget 樹結構</strong>：理解 Widget、Element、RenderObject 的關係</li>
<li><strong>狀態管理</strong>：StatelessWidget vs StatefulWidget 的選擇</li>
<li><strong>生命週期</strong>：掌握 Widget 的完整生命週期</li>
</ul>
<h3>佈局系統</h3>
<ul>
<li><strong>Flex 佈局</strong>：Row、Column、Flex 的靈活運用</li>
<li><strong>堆疊佈局</strong>：Stack、Positioned 的定位控制</li>
<li><strong>響應式設計</strong>：適配不同螢幕尺寸的策略</li>
</ul>
<h3>性能優化</h3>
<ul>
<li><strong>Widget 重建優化</strong>：使用 const、分離可變部分</li>
<li><strong>列表性能</strong>：ListView 的最佳實踐</li>
<li><strong>記憶體管理</strong>：正確處理資源釋放</li>
</ul>
<h3>開發實踐</h3>
<ul>
<li><strong>組件設計</strong>：創建可重用、可維護的組件</li>
<li><strong>錯誤處理</strong>：建立完善的錯誤處理機制</li>
<li><strong>測試策略</strong>：確保代碼品質的測試方法</li>
</ul>
<h3>設計模式</h3>
<ul>
<li><strong>Builder 模式</strong>：靈活構建複雜 Widget</li>
<li><strong>組合模式</strong>：組件的合理組織</li>
<li><strong>主題管理</strong>：統一的視覺設計系統</li>
</ul>
<p>掌握這些概念和技巧，能夠幫助開發者構建高品質、高性能的 Flutter 應用程式。記住，優秀的 Flutter 開發不僅在於了解各種 Widget，更在於理解如何合理組織和優化它們，創造出色的用戶體驗。</p>
                    </div>
                </div>
            
                <div class="tab-pane fade " id="4.-data-type" 
                     role="tabpanel" aria-labelledby="4.-data-type-tab">
                    <div class="content-wrapper">
                        <h1>Flutter Dart 資料型別與函數完全指南</h1>
<h2>🎯 概念釐清</h2>
<p>在 Dart 中，<code>void</code>、<code>Future&lt;void&gt;</code>、<code>bool</code>、<code>List&lt;String&gt;</code>、<code>String</code> 這些<strong>不是函數</strong>，而是<strong>資料型別</strong>（Data Types）。它們用來告訴程式：</p>
<ul>
<li>變數可以儲存什麼類型的資料</li>
<li>函數會回傳什麼類型的值</li>
<li>參數期望接收什麼類型的資料</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1">// 這些是型別宣告，不是函數！</span>
<span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Flutter&#39;</span><span class="p">;</span><span class="w">           </span><span class="c1">// String 型別的變數</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isVisible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">             </span><span class="c1">// bool 型別的變數  </span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">];</span><span class="w">   </span><span class="c1">// List&lt;String&gt; 型別的變數</span>

<span class="c1">// 在函數中使用型別</span>
<span class="kt">String</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">                 </span><span class="c1">// 回傳 String 型別</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Flutter Developer&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">printMessage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">              </span><span class="c1">// 不回傳任何值（void）</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Hello World&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>📝 Dart 基本資料型別</h2>
<h3>1. <strong>基本型別</strong></h3>
<h4><code>int</code> - 整數</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// 整數型別</span>
<span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">25</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">negative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="m">10</span><span class="p">;</span>

<span class="c1">// 常用操作</span>
<span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">20</span><span class="p">;</span><span class="w">        </span><span class="c1">// 加法</span>
<span class="kt">int</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">15</span><span class="p">;</span><span class="w"> </span><span class="c1">// 減法</span>
<span class="kt">int</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">6</span><span class="p">;</span><span class="w">      </span><span class="c1">// 乘法</span>
<span class="kt">int</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">~/</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w">   </span><span class="c1">// 整數除法 = 6</span>
<span class="kt">int</span><span class="w"> </span><span class="n">remainder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w">   </span><span class="c1">// 餘數 = 2</span>

<span class="n">print</span><span class="p">(</span><span class="s1">&#39;年齡：</span><span class="si">$</span><span class="n">age</span><span class="s1">&#39;</span><span class="p">);</span><span class="w">        </span><span class="c1">// 字串插值</span>
<span class="n">print</span><span class="p">(</span><span class="s1">&#39;分數是否及格：</span><span class="si">${</span><span class="n">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">60</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 比較運算</span>
</code></pre></div>

<h4><code>double</code> - 浮點數</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// 浮點數型別</span>
<span class="kt">double</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">175.5</span><span class="p">;</span>
<span class="kt">double</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">68.2</span><span class="p">;</span>
<span class="kt">double</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3.14159</span><span class="p">;</span>

<span class="c1">// 數學運算</span>
<span class="kt">double</span><span class="w"> </span><span class="n">bmi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="p">));</span>
<span class="kt">double</span><span class="w"> </span><span class="n">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">5</span><span class="p">;</span><span class="w"> </span><span class="c1">// 圓面積</span>

<span class="c1">// 精度控制</span>
<span class="kt">double</span><span class="w"> </span><span class="n">rounded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">bmi</span><span class="p">.</span><span class="n">toStringAsFixed</span><span class="p">(</span><span class="m">2</span><span class="p">));</span><span class="w"> </span><span class="c1">// 保留兩位小數</span>

<span class="n">print</span><span class="p">(</span><span class="s1">&#39;BMI: </span><span class="si">${</span><span class="n">bmi</span><span class="p">.</span><span class="n">toStringAsFixed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
</code></pre></div>

<h4><code>String</code> - 字串</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// 字串宣告方式</span>
<span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Flutter Developer&#39;</span><span class="p">;</span>
<span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;應用程式開發者&quot;</span><span class="p">;</span>
<span class="kt">String</span><span class="w"> </span><span class="n">multiLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">這是多行字串</span>
<span class="s1">可以包含換行</span>
<span class="s1">非常方便</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">;</span>

<span class="c1">// 字串操作</span>
<span class="kt">String</span><span class="w"> </span><span class="n">firstName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;John&#39;</span><span class="p">;</span>
<span class="kt">String</span><span class="w"> </span><span class="n">lastName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Doe&#39;</span><span class="p">;</span>
<span class="kt">String</span><span class="w"> </span><span class="n">fullName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">firstName</span><span class="s1"> </span><span class="si">$</span><span class="n">lastName</span><span class="s1">&#39;</span><span class="p">;</span><span class="w">        </span><span class="c1">// 字串插值</span>
<span class="kt">String</span><span class="w"> </span><span class="n">upperName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fullName</span><span class="p">.</span><span class="n">toUpperCase</span><span class="p">();</span><span class="w">       </span><span class="c1">// 轉大寫</span>
<span class="kt">String</span><span class="w"> </span><span class="n">lowerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fullName</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">();</span><span class="w">       </span><span class="c1">// 轉小寫</span>

<span class="c1">// 字串方法</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isEmpty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">;</span><span class="w">                     </span><span class="c1">// 檢查是否為空</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Flutter&#39;</span><span class="p">);</span><span class="w">       </span><span class="c1">// 包含檢查</span>
<span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w">                        </span><span class="c1">// 字串長度</span>
<span class="kt">String</span><span class="w"> </span><span class="n">substring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">);</span><span class="w">        </span><span class="c1">// 子字串</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span><span class="w">           </span><span class="c1">// 分割字串</span>

<span class="c1">// 字串比較</span>
<span class="kt">String</span><span class="w"> </span><span class="n">str1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello&#39;</span><span class="p">;</span>
<span class="kt">String</span><span class="w"> </span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hello&#39;</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isEqual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">str2</span><span class="p">;</span><span class="w">                     </span><span class="c1">// false (大小寫敏感)</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isEqualIgnoreCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str1</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">();</span><span class="w"> </span><span class="c1">// true</span>

<span class="n">print</span><span class="p">(</span><span class="s1">&#39;全名：</span><span class="si">$</span><span class="n">fullName</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="s1">&#39;包含 Flutter：</span><span class="si">$</span><span class="n">contains</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="s1">&#39;字串長度：</span><span class="si">$</span><span class="n">length</span><span class="s1">&#39;</span><span class="p">);</span>
</code></pre></div>

<h4><code>bool</code> - 布林值</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// 布林值只有兩個值：true 或 false</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isLoggedIn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isVisible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="c1">// 邏輯運算</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">result1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">   </span><span class="c1">// AND 運算 = false</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">result2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">   </span><span class="c1">// OR 運算 = true</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">result3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="kc">true</span><span class="p">;</span><span class="w">           </span><span class="c1">// NOT 運算 = false</span>

<span class="c1">// 條件判斷</span>
<span class="kt">int</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">85</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isPassed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">60</span><span class="p">;</span><span class="w">    </span><span class="c1">// true</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isExcellent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">90</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span>

<span class="c1">// 在條件語句中使用</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isLoggedIn</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isAdmin</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;歡迎管理員&#39;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isLoggedIn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;歡迎使用者&#39;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;請先登入&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 三元運算子</span>
<span class="kt">String</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isLoggedIn</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;已登入&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;未登入&#39;</span><span class="p">;</span>
</code></pre></div>

<h3>2. <strong>集合型別</strong></h3>
<h4><code>List&lt;T&gt;</code> - 陣列/清單</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// List 宣告方式</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fruits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;蘋果&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;香蕉&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;橘子&#39;</span><span class="p">];</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">];</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">];</span>

<span class="c1">// 空 List</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">emptyList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">emptyList2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">[];</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">emptyList3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="nl">growable:</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>

<span class="c1">// List 操作</span>
<span class="n">fruits</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;葡萄&#39;</span><span class="p">);</span><span class="w">                    </span><span class="c1">// 新增元素</span>
<span class="n">fruits</span><span class="p">.</span><span class="n">addAll</span><span class="p">([</span><span class="s1">&#39;芒果&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;鳳梨&#39;</span><span class="p">]);</span><span class="w">        </span><span class="c1">// 新增多個元素</span>
<span class="n">fruits</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;奇異果&#39;</span><span class="p">);</span><span class="w">            </span><span class="c1">// 在指定位置插入</span>
<span class="n">fruits</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;香蕉&#39;</span><span class="p">);</span><span class="w">                 </span><span class="c1">// 移除特定元素</span>
<span class="n">fruits</span><span class="p">.</span><span class="n">removeAt</span><span class="p">(</span><span class="m">0</span><span class="p">);</span><span class="w">                   </span><span class="c1">// 移除指定位置元素</span>
<span class="n">fruits</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span><span class="w">                       </span><span class="c1">// 清空所有元素</span>

<span class="c1">// List 屬性</span>
<span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w">           </span><span class="c1">// 取得長度</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isEmpty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">;</span><span class="w">        </span><span class="c1">// 檢查是否為空</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isNotEmpty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">;</span><span class="w">  </span><span class="c1">// 檢查是否非空</span>
<span class="kt">String</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">first</span><span class="p">;</span><span class="w">          </span><span class="c1">// 第一個元素</span>
<span class="kt">String</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">last</span><span class="p">;</span><span class="w">            </span><span class="c1">// 最後一個元素</span>

<span class="c1">// List 遍歷</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">fruit</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">fruits</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;水果：</span><span class="si">$</span><span class="n">fruit</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;第 </span><span class="si">${</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="si">}</span><span class="s1"> 個水果：</span><span class="si">${</span><span class="n">fruits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">fruits</span><span class="p">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">fruit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;使用 forEach：</span><span class="si">$</span><span class="n">fruit</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// List 轉換</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">upperFruits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">fruit</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fruit</span><span class="p">.</span><span class="n">toUpperCase</span><span class="p">()).</span><span class="n">toList</span><span class="p">();</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">longNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruits</span><span class="p">.</span><span class="n">where</span><span class="p">((</span><span class="n">fruit</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fruit</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">2</span><span class="p">).</span><span class="n">toList</span><span class="p">();</span>

<span class="c1">// 範例：建立購物清單 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ShoppingList</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;牛奶&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;麵包&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;雞蛋&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;蘋果&#39;</span><span class="p">];</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">      </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">      </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">          </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">shopping_cart</span><span class="p">),</span>
<span class="w">          </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
<span class="w">          </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">delete</span><span class="p">),</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="c1">// 移除項目的邏輯</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h4><code>Map&lt;K, V&gt;</code> - 字典/對映</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// Map 宣告方式</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">userInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;張小明&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ming@example.com&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;phone&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;0912-345-678&#39;</span>
<span class="p">};</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">scores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s1">&#39;國文&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">85</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;英文&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">92</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;數學&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">78</span>
<span class="p">};</span>

<span class="c1">// 空 Map</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">emptyMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">emptyMap2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="p">{};</span>

<span class="c1">// Map 操作</span>
<span class="n">userInfo</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;台北市信義區&#39;</span><span class="p">;</span><span class="w">     </span><span class="c1">// 新增/更新</span>
<span class="n">userInfo</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;phone&#39;</span><span class="p">);</span><span class="w">               </span><span class="c1">// 移除</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">hasEmail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">.</span><span class="n">containsKey</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 檢查鍵是否存在</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">hasValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">.</span><span class="n">containsValue</span><span class="p">(</span><span class="s1">&#39;張小明&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 檢查值是否存在</span>

<span class="c1">// Map 屬性和方法</span>
<span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w">           </span><span class="c1">// 取得大小</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isEmpty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">;</span><span class="w">        </span><span class="c1">// 檢查是否為空</span>
<span class="n">Iterable</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">.</span><span class="n">keys</span><span class="p">;</span><span class="w">  </span><span class="c1">// 取得所有鍵</span>
<span class="n">Iterable</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">.</span><span class="n">values</span><span class="p">;</span><span class="w"> </span><span class="c1">// 取得所有值</span>

<span class="c1">// Map 遍歷</span>
<span class="n">userInfo</span><span class="p">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">key</span><span class="s1">: </span><span class="si">$</span><span class="n">value</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">userInfo</span><span class="p">.</span><span class="n">keys</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">key</span><span class="s1">: </span><span class="si">${</span><span class="n">userInfo</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 安全取值（避免 null）</span>
<span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">];</span><span class="w">      </span><span class="c1">// 可能為 null</span>
<span class="kt">String</span><span class="w"> </span><span class="n">emailSafe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userInfo</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;未設定&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// 提供預設值</span>

<span class="c1">// 範例：使用者設定 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s1">&#39;avatar&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;assets/images/avatar.png&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;張小明&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;age&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">25</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;isVip&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;joinDate&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">(</span><span class="m">2023</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="p">),</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">          </span><span class="nl">backgroundImage:</span><span class="w"> </span><span class="n">AssetImage</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;avatar&#39;</span><span class="p">]),</span>
<span class="w">          </span><span class="nl">radius:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">          </span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;年齡：</span><span class="si">${</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;isVip&#39;</span><span class="p">])</span><span class="w"> </span>
<span class="w">          </span><span class="n">Chip</span><span class="p">(</span>
<span class="w">            </span><span class="nl">label:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;VIP 會員&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">gold</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h4><code>Set&lt;T&gt;</code> - 集合（不重複元素）</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// Set 宣告</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">uniqueFruits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;蘋果&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;香蕉&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;橘子&#39;</span><span class="p">};</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">uniqueNumbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">};</span><span class="w"> </span><span class="c1">// 重複的 3 只會保留一個</span>

<span class="c1">// Set 操作</span>
<span class="n">uniqueFruits</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;葡萄&#39;</span><span class="p">);</span><span class="w">               </span><span class="c1">// 新增</span>
<span class="n">uniqueFruits</span><span class="p">.</span><span class="n">addAll</span><span class="p">([</span><span class="s1">&#39;芒果&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;蘋果&#39;</span><span class="p">]);</span><span class="w">   </span><span class="c1">// 新增多個（重複的會被忽略）</span>
<span class="n">uniqueFruits</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;香蕉&#39;</span><span class="p">);</span><span class="w">            </span><span class="c1">// 移除</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uniqueFruits</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;蘋果&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 檢查是否包含</span>

<span class="c1">// Set 運算</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">set1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">};</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">set2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">};</span>

<span class="n">Set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">union</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set1</span><span class="p">.</span><span class="n">union</span><span class="p">(</span><span class="n">set2</span><span class="p">);</span><span class="w">           </span><span class="c1">// 聯集 {1, 2, 3, 4, 5, 6}</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">intersection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set1</span><span class="p">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">set2</span><span class="p">);</span><span class="w"> </span><span class="c1">// 交集 {3, 4}</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set1</span><span class="p">.</span><span class="n">difference</span><span class="p">(</span><span class="n">set2</span><span class="p">);</span><span class="w">     </span><span class="c1">// 差集 {1, 2}</span>

<span class="c1">// 轉換</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fruitList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uniqueFruits</span><span class="p">.</span><span class="n">toList</span><span class="p">();</span><span class="w"> </span><span class="c1">// Set 轉 List</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fruitSet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruitList</span><span class="p">.</span><span class="n">toSet</span><span class="p">();</span><span class="w">       </span><span class="c1">// List 轉 Set（去重複）</span>
</code></pre></div>

<hr />
<h2>🔄 函數與回傳型別</h2>
<h3>1. <strong>void - 無回傳值</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// void 表示函數不回傳任何值</span>
<span class="kt">void</span><span class="w"> </span><span class="n">printWelcome</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;歡迎使用 Flutter 應用程式！&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// 沒有 return 語句，或者 return; （不回傳值）</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">updateUserInfo</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;更新使用者資訊：</span><span class="si">$</span><span class="n">name</span><span class="s1">, </span><span class="si">$</span><span class="n">age</span><span class="s1"> 歲&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// 執行更新邏輯，但不回傳結果</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">showDialog</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">showDialog</span><span class="p">(</span>
<span class="w">    </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<span class="w">    </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AlertDialog</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;提示&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">message</span><span class="p">),</span>
<span class="w">      </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;確定&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 在 Widget 中的使用</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MyWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_handleButtonPress</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// void 函數</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;按鈕被點擊了&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// 執行某些動作，但不需要回傳值</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_handleButtonPress</span><span class="p">,</span><span class="w"> </span><span class="c1">// 傳遞 void 函數</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;點擊我&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>2. <strong>具體型別回傳</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// String 回傳型別</span>
<span class="kt">String</span><span class="w"> </span><span class="n">getUserName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;張小明&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">String</span><span class="w"> </span><span class="n">formatDate</span><span class="p">(</span><span class="n">DateTime</span><span class="w"> </span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">date</span><span class="p">.</span><span class="n">year</span><span class="si">}</span><span class="s1">年</span><span class="si">${</span><span class="n">date</span><span class="p">.</span><span class="n">month</span><span class="si">}</span><span class="s1">月</span><span class="si">${</span><span class="n">date</span><span class="p">.</span><span class="n">day</span><span class="si">}</span><span class="s1">日&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// int 回傳型別</span>
<span class="kt">int</span><span class="w"> </span><span class="n">calculateAge</span><span class="p">(</span><span class="n">DateTime</span><span class="w"> </span><span class="n">birthDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">DateTime</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">();</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">now</span><span class="p">.</span><span class="n">year</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">birthDate</span><span class="p">.</span><span class="n">year</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="n">month</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">birthDate</span><span class="p">.</span><span class="n">month</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>
<span class="w">      </span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">birthDate</span><span class="p">.</span><span class="n">month</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">now</span><span class="p">.</span><span class="n">day</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">birthDate</span><span class="p">.</span><span class="n">day</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">age</span><span class="o">--</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// bool 回傳型別</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">isEmailValid</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="s1">r&#39;^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$&#39;</span><span class="p">).</span><span class="n">hasMatch</span><span class="p">(</span><span class="n">email</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span><span class="w"> </span><span class="n">isAdult</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">18</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// List 回傳型別</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getWeekdays</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;星期一&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;星期二&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;星期三&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;星期四&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;星期五&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;星期六&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;星期日&#39;</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">generateNumbers</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Map 回傳型別</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createUserData</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;age&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">age</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;createdAt&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">toIso8601String</span><span class="p">(),</span>
<span class="w">    </span><span class="s1">&#39;isActive&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="c1">// 實際使用範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 取得使用者顯示名稱</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">getDisplayName</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">firstName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;firstName&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">lastName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;lastName&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">lastName</span><span class="s1"> </span><span class="si">$</span><span class="n">firstName</span><span class="s1">&#39;</span><span class="p">.</span><span class="n">trim</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 檢查使用者權限</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">hasPermission</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">permission</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">permissions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">.</span><span class="n">from</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;permissions&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="p">[]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">permissions</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">permission</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 取得使用者的朋友清單</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getFriendNames</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">friends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="p">.</span><span class="n">from</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;friends&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="p">[]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">friends</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">friend</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">friend</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>3. <strong>Future<T> - 異步回傳型別</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Future&lt;void&gt; - 異步操作但不回傳值</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">loadUserData</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;開始載入使用者資料...&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">));</span><span class="w"> </span><span class="c1">// 模擬網路延遲</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;使用者資料載入完成&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// 不回傳任何值，只是執行異步操作</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">saveToDatabase</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 模擬儲存到資料庫</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">500</span><span class="p">));</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;資料已儲存：</span><span class="si">$</span><span class="n">data</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Future&lt;String&gt; - 異步回傳字串</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fetchUserName</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 模擬 API 呼叫</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">1</span><span class="p">));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;使用者_</span><span class="si">$</span><span class="n">userId</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">downloadFile</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;開始下載：</span><span class="si">$</span><span class="n">url</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">3</span><span class="p">));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;/downloads/file_</span><span class="si">${</span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">millisecondsSinceEpoch</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Future&lt;bool&gt; - 異步回傳布林值</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">authenticateUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">1</span><span class="p">));</span><span class="w"> </span><span class="c1">// 模擬驗證過程</span>

<span class="w">  </span><span class="c1">// 簡單的驗證邏輯</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;123456&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">checkNetworkConnection</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 檢查網路連線狀態</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">200</span><span class="p">));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// 假設有網路連線</span>
<span class="p">}</span>

<span class="c1">// Future&lt;List&lt;T&gt;&gt; - 異步回傳列表</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fetchNotifications</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s1">&#39;您有新的訊息&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;系統維護通知&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;好友邀請&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;活動提醒&#39;</span>
<span class="w">  </span><span class="p">];</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">fetchProducts</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">1</span><span class="p">));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;iPhone 15&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;price&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">30900</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;iPad Air&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;price&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">19900</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;MacBook Pro&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;price&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">65900</span><span class="p">},</span>
<span class="w">  </span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// Future&lt;Map&lt;K, V&gt;&gt; - 異步回傳對映</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fetchWeatherData</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">city</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">800</span><span class="p">));</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s1">&#39;city&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;temperature&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">25.6</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;humidity&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">65</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;condition&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;晴朗&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;forecast&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;今日晴&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;明日陰&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;後日雨&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="s1">&#39;lastUpdated&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">toIso8601String</span><span class="p">(),</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="c1">// 在 Widget 中使用 Future</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AsyncDataWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_AsyncDataWidgetState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_AsyncDataWidgetState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_AsyncDataWidgetState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AsyncDataWidget</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">notifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="n">_loadData</span><span class="p">();</span><span class="w"> </span><span class="c1">// 在初始化時載入資料</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 載入資料的異步方法</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadData</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 並行執行多個異步操作</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">wait</span><span class="p">([</span>
<span class="w">        </span><span class="n">fetchUserName</span><span class="p">(</span><span class="s1">&#39;user123&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="n">fetchNotifications</span><span class="p">(),</span>
<span class="w">      </span><span class="p">]);</span>

<span class="w">      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">;</span>
<span class="w">        </span><span class="n">notifications</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;載入資料時發生錯誤：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 重新整理資料</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_refreshData</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">_loadData</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isLoading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">RefreshIndicator</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onRefresh:</span><span class="w"> </span><span class="n">_refreshData</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;歡迎，</span><span class="si">$</span><span class="n">userName</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">          </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;通知 (</span><span class="si">${</span><span class="n">notifications</span><span class="p">.</span><span class="n">length</span><span class="si">}</span><span class="s1">)：&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">              </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">notifications</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">              </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">notifications</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">notifications</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
<span class="w">                </span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 異步操作的錯誤處理</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 帶錯誤處理的異步方法</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;?&gt;</span><span class="w"> </span><span class="n">loginUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 模擬登入 API 呼叫</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">));</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="p">.</span><span class="n">isEmpty</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">password</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s1">&#39;電子郵件和密碼不能為空&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isEmailValid</span><span class="p">(</span><span class="n">email</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s1">&#39;電子郵件格式不正確&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">isAuthenticated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">authenticateUser</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isAuthenticated</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s1">&#39;電子郵件或密碼錯誤&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;user&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">          </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;張小明&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="s1">&#39;token&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;jwt_token_here&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;登入失敗：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;success&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;error&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 使用 async/await 處理多個異步操作</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updateUserProfile</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">profileData</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 1. 驗證資料</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profileData</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s1">&#39;更新資料不能為空&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 2. 上傳頭像（如果有）</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profileData</span><span class="p">.</span><span class="n">containsKey</span><span class="p">(</span><span class="s1">&#39;avatar&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">String</span><span class="w"> </span><span class="n">avatarUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">uploadAvatar</span><span class="p">(</span><span class="n">profileData</span><span class="p">[</span><span class="s1">&#39;avatar&#39;</span><span class="p">]);</span>
<span class="w">        </span><span class="n">profileData</span><span class="p">[</span><span class="s1">&#39;avatarUrl&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avatarUrl</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 3. 更新使用者資料</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">updateDatabase</span><span class="p">(</span><span class="n">userId</span><span class="p">,</span><span class="w"> </span><span class="n">profileData</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 4. 清除快取</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">clearUserCache</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;更新個人資料失敗：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 輔助方法</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">uploadAvatar</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">imagePath</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">1</span><span class="p">));</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;https://cdn.example.com/avatars/user_avatar.jpg&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updateDatabase</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">500</span><span class="p">));</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;資料庫已更新：使用者 </span><span class="si">$</span><span class="n">userId</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clearUserCache</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">100</span><span class="p">));</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;快取已清除：使用者 </span><span class="si">$</span><span class="n">userId</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔧 類型安全與 Null Safety</h2>
<h3>1. <strong>可為空的型別（Nullable Types）</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 可為空的型別（在型別後加 ?）</span>
<span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">nullableName</span><span class="p">;</span><span class="w">           </span><span class="c1">// 可以是 String 或 null</span>
<span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">nullableAge</span><span class="p">;</span><span class="w">               </span><span class="c1">// 可以是 int 或 null</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">nullableList</span><span class="p">;</span><span class="w">     </span><span class="c1">// 可以是 List&lt;String&gt; 或 null</span>

<span class="c1">// 不可為空的型別（預設）</span>
<span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Flutter&#39;</span><span class="p">;</span><span class="w">        </span><span class="c1">// 必須有值，不能是 null</span>
<span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">25</span><span class="p">;</span><span class="w">                   </span><span class="c1">// 必須有值，不能是 null</span>

<span class="c1">// 檢查和使用可為空的值</span>
<span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">getUserName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 可能回傳 null</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">handleUserName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserName</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 方法1：使用 if 檢查</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;使用者名稱：</span><span class="si">$</span><span class="n">name</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;名稱長度：</span><span class="si">${</span><span class="n">name</span><span class="p">.</span><span class="n">length</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 安全存取</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 方法2：使用 null-aware 運算子</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;名稱長度：</span><span class="si">${</span><span class="n">name</span><span class="o">?</span><span class="p">.</span><span class="n">length</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span><span class="w">      </span><span class="c1">// 如果 name 為 null，結果為 null</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;使用者名稱：</span><span class="si">${</span><span class="n">name</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s2">&quot;訪客&quot;</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span><span class="w">   </span><span class="c1">// 如果 name 為 null，使用預設值</span>

<span class="w">  </span><span class="c1">// 方法3：強制斷言（需確保不為 null）</span>
<span class="w">  </span><span class="c1">// print(&#39;名稱長度：${name!.length}&#39;);   // 危險！如果 name 為 null 會拋出異常</span>
<span class="p">}</span>

<span class="c1">// 實際應用範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserProfile</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">                    </span><span class="c1">// 必填</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">                        </span><span class="c1">// 必填</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 可選</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">phone</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 可選</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">hobbies</span><span class="p">;</span><span class="w">          </span><span class="c1">// 可選</span>

<span class="w">  </span><span class="n">UserProfile</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w">           </span><span class="c1">// 必須提供</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">age</span><span class="p">,</span><span class="w">            </span><span class="c1">// 必須提供</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">email</span><span class="p">,</span><span class="w">                   </span><span class="c1">// 可選參數</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">phone</span><span class="p">,</span><span class="w">                   </span><span class="c1">// 可選參數</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">hobbies</span><span class="p">,</span><span class="w">                 </span><span class="c1">// 可選參數</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// 安全取得電子郵件</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">getEmailDisplay</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;未設定&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 安全取得愛好數量</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">getHobbyCount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hobbies</span><span class="o">?</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 檢查是否有聯絡資訊</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">hasContactInfo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">phone</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>2. <strong>型別轉換與檢查</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 型別檢查</span>
<span class="kt">dynamic</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello World&#39;</span><span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;這是字串：</span><span class="si">$</span><span class="n">value</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;長度：</span><span class="si">${</span><span class="n">value</span><span class="p">.</span><span class="n">length</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 自動轉型，可以安全使用 String 方法</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="o">!</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;這不是整數&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 安全的型別轉換</span>
<span class="kt">String</span><span class="w"> </span><span class="n">convertToString</span><span class="p">(</span><span class="kt">dynamic</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">toString</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">toString</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用 as 進行強制轉型（需要確保型別正確）</span>
<span class="kt">Object</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Flutter&#39;</span><span class="p">;</span>
<span class="kt">String</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">;</span><span class="w">  </span><span class="c1">// 強制轉為 String</span>

<span class="c1">// 安全的轉型（如果轉型失敗會回傳 null）</span>
<span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">safeStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="p">;</span>

<span class="c1">// 泛型型別轉換</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dynamicList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;banana&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orange&#39;</span><span class="p">];</span>
<span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stringList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dynamicList</span><span class="p">.</span><span class="n">cast</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">();</span><span class="w"> </span><span class="c1">// 轉為 String 列表</span>

<span class="c1">// 從 JSON 解析的實際範例</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">jsonData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;張小明&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;age&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">25</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;isActive&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s1">&#39;scores&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="m">85</span><span class="p">,</span><span class="w"> </span><span class="m">92</span><span class="p">,</span><span class="w"> </span><span class="m">78</span><span class="p">],</span>
<span class="w">  </span><span class="s1">&#39;profile&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ming@example.com&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;phone&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;0912-345-678&#39;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">JsonParser</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">getString</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="w"> </span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">defaultValue</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">getInt</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kt">int</span><span class="w"> </span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">toInt</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">defaultValue</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">defaultValue</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">getBool</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kt">bool</span><span class="w"> </span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">defaultValue</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">List</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">cast</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">[];</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用範例</span>
<span class="kt">void</span><span class="w"> </span><span class="n">parseUserData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JsonParser</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="n">jsonData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JsonParser</span><span class="p">.</span><span class="n">getInt</span><span class="p">(</span><span class="n">jsonData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;age&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JsonParser</span><span class="p">.</span><span class="n">getBool</span><span class="p">(</span><span class="n">jsonData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;isActive&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">scores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JsonParser</span><span class="p">.</span><span class="n">getList</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">jsonData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scores&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;姓名：</span><span class="si">$</span><span class="n">name</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;年齡：</span><span class="si">$</span><span class="n">age</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;狀態：</span><span class="si">${</span><span class="n">isActive</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;活躍&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;非活躍&quot;</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;成績：</span><span class="si">$</span><span class="n">scores</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🎯 函數參數型別</h2>
<h3>1. <strong>必要參數（Required Parameters）</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置參數（順序很重要）</span>
<span class="kt">String</span><span class="w"> </span><span class="n">createFullName</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">firstName</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">lastName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">firstName</span><span class="s1"> </span><span class="si">$</span><span class="n">lastName</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 使用方式</span>
<span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createFullName</span><span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Doe&#39;</span><span class="p">);</span><span class="w">  </span><span class="c1">// 必須按順序傳入</span>
<span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">);</span><span class="w">                        </span><span class="c1">// 第一個參數是 a，第二個是 b</span>

<span class="c1">// 具名必要參數（使用 required 關鍵字）</span>
<span class="n">Widget</span><span class="w"> </span><span class="n">createButton</span><span class="p">({</span>
<span class="w">  </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w">           </span><span class="c1">// 必須提供</span>
<span class="w">  </span><span class="kd">required</span><span class="w"> </span><span class="n">VoidCallback</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span><span class="w"> </span><span class="c1">// 必須提供</span>
<span class="w">  </span><span class="kd">required</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">,</span><span class="w">  </span><span class="c1">// 必須提供</span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">    </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span><span class="nl">primary:</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">),</span>
<span class="w">    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 使用具名必要參數</span>
<span class="n">Widget</span><span class="w"> </span><span class="n">button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createButton</span><span class="p">(</span>
<span class="w">  </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;點擊我&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;按鈕被點擊&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">,</span>
<span class="p">);</span>
</code></pre></div>

<h3>2. <strong>可選參數（Optional Parameters）</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置可選參數（用 [] 包圍）</span>
<span class="kt">String</span><span class="w"> </span><span class="n">greetUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">greeting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;你好&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">greeting</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39; </span><span class="si">$</span><span class="n">title</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">greeting</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39; </span><span class="si">$</span><span class="n">name</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">greeting</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;，您今年 </span><span class="si">$</span><span class="n">age</span><span class="s1"> 歲&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">greeting</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 使用方式</span>
<span class="kt">String</span><span class="w"> </span><span class="n">msg1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">greetUser</span><span class="p">(</span><span class="s1">&#39;小明&#39;</span><span class="p">);</span><span class="w">                    </span><span class="c1">// 你好 小明</span>
<span class="kt">String</span><span class="w"> </span><span class="n">msg2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">greetUser</span><span class="p">(</span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;先生&#39;</span><span class="p">);</span><span class="w">             </span><span class="c1">// 你好 先生 小明</span>
<span class="kt">String</span><span class="w"> </span><span class="n">msg3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">greetUser</span><span class="p">(</span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;先生&#39;</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">);</span><span class="w">         </span><span class="c1">// 你好 先生 小明，您今年 25 歲</span>
<span class="kt">String</span><span class="w"> </span><span class="n">msg4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">greetUser</span><span class="p">(</span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">);</span><span class="w">         </span><span class="c1">// 你好 小明，您今年 30 歲</span>

<span class="c1">// 具名可選參數（用 {} 包圍）</span>
<span class="n">Widget</span><span class="w"> </span><span class="n">createCard</span><span class="p">({</span>
<span class="w">  </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w">           </span><span class="c1">// 必要參數</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">subtitle</span><span class="p">,</span><span class="w">               </span><span class="c1">// 可選參數</span>
<span class="w">  </span><span class="n">Color</span><span class="w"> </span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">white</span><span class="p">,</span><span class="w"> </span><span class="c1">// 有預設值的可選參數</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">elevation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.0</span><span class="p">,</span><span class="w">         </span><span class="c1">// 有預設值的可選參數</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isEnabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">          </span><span class="c1">// 有預設值的可選參數</span>
<span class="w">  </span><span class="n">VoidCallback</span><span class="o">?</span><span class="w"> </span><span class="n">onTap</span><span class="p">,</span><span class="w">           </span><span class="c1">// 可選參數</span>
<span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">    </span><span class="nl">color:</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">,</span>
<span class="w">    </span><span class="nl">elevation:</span><span class="w"> </span><span class="n">elevation</span><span class="p">,</span>
<span class="w">    </span><span class="nl">child:</span><span class="w"> </span><span class="n">InkWell</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onTap:</span><span class="w"> </span><span class="n">isEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">onTap</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="n">title</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">isEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">black</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">subtitle</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">...[</span>
<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">              </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">subtitle</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">isEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">600</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">400</span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 使用具名可選參數（可以任意順序）</span>
<span class="n">Widget</span><span class="w"> </span><span class="n">card1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createCard</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;基本卡片&#39;</span><span class="p">);</span>

<span class="n">Widget</span><span class="w"> </span><span class="n">card2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createCard</span><span class="p">(</span>
<span class="w">  </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;進階卡片&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">subtitle:</span><span class="w"> </span><span class="s1">&#39;這是副標題&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[</span><span class="m">50</span><span class="p">],</span>
<span class="w">  </span><span class="nl">elevation:</span><span class="w"> </span><span class="m">4.0</span><span class="p">,</span>
<span class="p">);</span>

<span class="n">Widget</span><span class="w"> </span><span class="n">card3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createCard</span><span class="p">(</span>
<span class="w">  </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;互動卡片&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;卡片被點擊&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="nl">isEnabled:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="p">);</span>
</code></pre></div>

<h3>3. <strong>函數型別參數</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 函數作為參數</span>
<span class="kt">void</span><span class="w"> </span><span class="n">executeOperation</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">operation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">operation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;運算結果：</span><span class="si">$</span><span class="n">result</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 定義不同的運算函數</span>
<span class="kt">int</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">multiply</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">subtract</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="c1">// 使用函數參數</span>
<span class="kt">void</span><span class="w"> </span><span class="n">performCalculations</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">executeOperation</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="p">);</span><span class="w">       </span><span class="c1">// 運算結果：15</span>
<span class="w">  </span><span class="n">executeOperation</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">multiply</span><span class="p">);</span><span class="w">  </span><span class="c1">// 運算結果：50</span>
<span class="w">  </span><span class="n">executeOperation</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">subtract</span><span class="p">);</span><span class="w"> </span><span class="c1">// 運算結果：5</span>

<span class="w">  </span><span class="c1">// 使用匿名函數</span>
<span class="w">  </span><span class="n">executeOperation</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">~/</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w"> </span><span class="c1">// 運算結果：2（整數除法）</span>
<span class="p">}</span>

<span class="c1">// 更複雜的函數型別參數範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ListProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 處理字串列表的通用方法</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">processStringList</span><span class="p">(</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="n">processor</span><span class="p">,</span><span class="w"> </span><span class="c1">// 處理單個項目的函數</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">processor</span><span class="p">).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 過濾列表的通用方法</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">filterList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">predicate</span><span class="p">,</span><span class="w"> </span><span class="c1">// 判斷條件的函數</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">predicate</span><span class="p">).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 歸約列表的通用方法</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">reduceList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">,</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">previous</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">current</span><span class="p">)</span><span class="w"> </span><span class="n">combiner</span><span class="p">,</span><span class="w"> </span><span class="c1">// 合併函數</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">combiner</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用函數型別參數的實際範例</span>
<span class="kt">void</span><span class="w"> </span><span class="n">demonstrateFunctionParameters</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;john doe&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;jane smith&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bob johnson&#39;</span><span class="p">];</span>

<span class="w">  </span><span class="c1">// 使用不同的處理函數</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">upperNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ListProcessor</span><span class="p">.</span><span class="n">processStringList</span><span class="p">(</span>
<span class="w">    </span><span class="n">names</span><span class="p">,</span>
<span class="w">    </span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">toUpperCase</span><span class="p">(),</span><span class="w"> </span><span class="c1">// 轉大寫</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">capitalizedNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ListProcessor</span><span class="p">.</span><span class="n">processStringList</span><span class="p">(</span>
<span class="w">    </span><span class="n">names</span><span class="p">,</span>
<span class="w">    </span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">).</span><span class="n">map</span><span class="p">((</span><span class="n">word</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="n">word</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">word</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="m">1</span><span class="p">)).</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">// 首字母大寫</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 過濾長度大於 8 的名字</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">longNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ListProcessor</span><span class="p">.</span><span class="n">filterList</span><span class="p">(</span>
<span class="w">    </span><span class="n">names</span><span class="p">,</span>
<span class="w">    </span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">8</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;原始：</span><span class="si">$</span><span class="n">names</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;大寫：</span><span class="si">$</span><span class="n">upperNames</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;首字母大寫：</span><span class="si">$</span><span class="n">capitalizedNames</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;長名字：</span><span class="si">$</span><span class="n">longNames</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Widget 回調函數的實際應用</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CustomButton</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">VoidCallback</span><span class="o">?</span><span class="w"> </span><span class="n">onPressed</span><span class="p">;</span><span class="w">           </span><span class="c1">// 無參數無回傳值</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ValueChanged</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">onTextChanged</span><span class="p">;</span><span class="w"> </span><span class="c1">// 有參數無回傳值</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="kt">Function</span><span class="p">()</span><span class="o">?</span><span class="w"> </span><span class="n">getButtonText</span><span class="p">;</span><span class="w">   </span><span class="c1">// 無參數有回傳值</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">validator</span><span class="p">;</span><span class="w">   </span><span class="c1">// 有參數有回傳值</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">CustomButton</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">onPressed</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">onTextChanged</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">getButtonText</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">validator</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">displayText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getButtonText</span><span class="o">?</span><span class="p">.</span><span class="n">call</span><span class="p">()</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">isValid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">validator</span><span class="o">?</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">displayText</span><span class="p">)</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">isValid</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">onPressed</span><span class="o">?</span><span class="p">.</span><span class="n">call</span><span class="p">();</span>
<span class="w">        </span><span class="n">onTextChanged</span><span class="o">?</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">displayText</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">displayText</span><span class="p">),</span>
<span class="w">      </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">        </span><span class="nl">primary:</span><span class="w"> </span><span class="n">isValid</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用自訂按鈕</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ButtonDemo</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_ButtonDemoState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ButtonDemoState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_ButtonDemoState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ButtonDemo</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">currentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;點擊我&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">clickCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;基本按鈕&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;基本按鈕被點擊&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">        </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;動態按鈕&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">getButtonText:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;點擊次數：</span><span class="si">$</span><span class="n">clickCount</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">clickCount</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nl">onTextChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;按鈕文字變為：</span><span class="si">$</span><span class="n">text</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">        </span><span class="n">CustomButton</span><span class="p">(</span>
<span class="w">          </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;驗證按鈕&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">clickCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="c1">// 必須點擊過才能使用</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;驗證按鈕被點擊&#39;</span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🎨 泛型型別（Generic Types）</h2>
<h3>1. <strong>基本泛型概念</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 泛型類別</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">Box</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>

<span class="w">  </span><span class="n">Box</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">setValue</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">newValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newValue</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="n">getValue</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 型別安全的比較</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isEqual</span><span class="p">(</span><span class="n">Box</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用泛型類別</span>
<span class="kt">void</span><span class="w"> </span><span class="n">demonstrateGenerics</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 字串盒子</span>
<span class="w">  </span><span class="n">Box</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stringBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Box</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">stringBox</span><span class="p">.</span><span class="n">setValue</span><span class="p">(</span><span class="s1">&#39;World&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringBox</span><span class="p">.</span><span class="n">getValue</span><span class="p">();</span><span class="w"> </span><span class="c1">// 型別安全，不需要轉型</span>

<span class="w">  </span><span class="c1">// 整數盒子</span>
<span class="w">  </span><span class="n">Box</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">intBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Box</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="m">42</span><span class="p">);</span>
<span class="w">  </span><span class="n">intBox</span><span class="p">.</span><span class="n">setValue</span><span class="p">(</span><span class="m">100</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">intValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">intBox</span><span class="p">.</span><span class="n">getValue</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 自訂物件盒子</span>
<span class="w">  </span><span class="n">Box</span><span class="o">&lt;</span><span class="n">DateTime</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dateBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Box</span><span class="o">&lt;</span><span class="n">DateTime</span><span class="o">&gt;</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">());</span>
<span class="w">  </span><span class="n">DateTime</span><span class="w"> </span><span class="n">currentDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dateBox</span><span class="p">.</span><span class="n">getValue</span><span class="p">();</span>

<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;字串值：</span><span class="si">$</span><span class="n">stringValue</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;整數值：</span><span class="si">$</span><span class="n">intValue</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;日期值：</span><span class="si">$</span><span class="n">currentDate</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 泛型函數</span>
<span class="n">T</span><span class="w"> </span><span class="n">getFirst</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">items</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">ArgumentError</span><span class="p">(</span><span class="s1">&#39;列表不能為空&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createFilledList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">filled</span><span class="p">(</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createMap</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="o">&gt;</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">K</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">keys</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">values</span><span class="p">.</span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">ArgumentError</span><span class="p">(</span><span class="s1">&#39;鍵值列表長度必須相同&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">keys</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 使用泛型函數</span>
<span class="kt">void</span><span class="w"> </span><span class="n">useGenericFunctions</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 取得第一個元素</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">firstFruit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getFirst</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">([</span><span class="s1">&#39;蘋果&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;香蕉&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;橘子&#39;</span><span class="p">]);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">firstNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getFirst</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">([</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">]);</span>

<span class="w">  </span><span class="c1">// 創建填充列表</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">boolList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createFilledList</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// [true, true, true, true, true]</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stringList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createFilledList</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;Hello&#39;, &#39;Hello&#39;, &#39;Hello&#39;]</span>

<span class="w">  </span><span class="c1">// 創建對映</span>
<span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">scoreMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createMap</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Charlie&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="m">95</span><span class="p">,</span><span class="w"> </span><span class="m">87</span><span class="p">,</span><span class="w"> </span><span class="m">92</span><span class="p">]</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;第一個水果：</span><span class="si">$</span><span class="n">firstFruit</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;第一個數字：</span><span class="si">$</span><span class="n">firstNumber</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;布林列表：</span><span class="si">$</span><span class="n">boolList</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;成績對映：</span><span class="si">$</span><span class="n">scoreMap</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3>2. <strong>約束泛型（Bounded Generics）</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 約束泛型必須繼承某個類別</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Animal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">makeSound</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">Dog</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;Dog&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">makeSound</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Woof!&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">Cat</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;Cat&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">makeSound</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Meow!&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 只接受 Animal 及其子類的泛型</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AnimalShelter</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Animal</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">animals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">addAnimal</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">animal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">animals</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">animal</span><span class="p">);</span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">${</span><span class="n">animal</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> 已加入收容所&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">makeAllSounds</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">animal</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">animals</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">animal</span><span class="p">.</span><span class="n">makeSound</span><span class="p">();</span><span class="w"> </span><span class="c1">// 可以安全調用 Animal 的方法</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getAllAnimals</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">from</span><span class="p">(</span><span class="n">animals</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用約束泛型</span>
<span class="kt">void</span><span class="w"> </span><span class="n">demonstrateBoundedGenerics</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">AnimalShelter</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dogShelter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AnimalShelter</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="n">dogShelter</span><span class="p">.</span><span class="n">addAnimal</span><span class="p">(</span><span class="n">Dog</span><span class="p">());</span>
<span class="w">  </span><span class="n">dogShelter</span><span class="p">.</span><span class="n">addAnimal</span><span class="p">(</span><span class="n">Dog</span><span class="p">());</span>

<span class="w">  </span><span class="n">AnimalShelter</span><span class="o">&lt;</span><span class="n">Cat</span><span class="o">&gt;</span><span class="w"> </span><span class="n">catShelter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AnimalShelter</span><span class="o">&lt;</span><span class="n">Cat</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="n">catShelter</span><span class="p">.</span><span class="n">addAnimal</span><span class="p">(</span><span class="n">Cat</span><span class="p">());</span>

<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;狗收容所的聲音：&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">dogShelter</span><span class="p">.</span><span class="n">makeAllSounds</span><span class="p">();</span>

<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;貓收容所的聲音：&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">catShelter</span><span class="p">.</span><span class="n">makeAllSounds</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// 數值約束的泛型</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">Calculator</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="kt">num</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="n">multiply</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">T</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">divide</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isPositive</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用數值約束泛型</span>
<span class="kt">void</span><span class="w"> </span><span class="n">useNumericGenerics</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Calculator</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">intCalc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Calculator</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">intCalc</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">);</span><span class="w">           </span><span class="c1">// 30</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">intCalc</span><span class="p">.</span><span class="n">multiply</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">);</span><span class="w">    </span><span class="c1">// 30</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">intCalc</span><span class="p">.</span><span class="n">divide</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 5.0</span>

<span class="w">  </span><span class="n">Calculator</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">doubleCalc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Calculator</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">decimalSum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doubleCalc</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="m">3.14</span><span class="p">,</span><span class="w"> </span><span class="m">2.86</span><span class="p">);</span><span class="w">      </span><span class="c1">// 6.0</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">decimalProduct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doubleCalc</span><span class="p">.</span><span class="n">multiply</span><span class="p">(</span><span class="m">2.5</span><span class="p">,</span><span class="w"> </span><span class="m">4.0</span><span class="p">);</span><span class="w"> </span><span class="c1">// 10.0</span>

<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;整數計算：</span><span class="si">$</span><span class="n">sum</span><span class="s1">, </span><span class="si">$</span><span class="n">product</span><span class="s1">, </span><span class="si">$</span><span class="n">quotient</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;浮點數計算：</span><span class="si">$</span><span class="n">decimalSum</span><span class="s1">, </span><span class="si">$</span><span class="n">decimalProduct</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3>3. <strong>泛型在 Flutter 中的實際應用</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 泛型 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">GenericListWidget</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="n">itemBuilder</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">getDisplayText</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">onItemTap</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">GenericListWidget</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">items</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">itemBuilder</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">getDisplayText</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">onItemTap</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">      </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">      </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">InkWell</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onTap:</span><span class="w"> </span><span class="n">onItemTap</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">onItemTap</span><span class="o">!</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">itemBuilder</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 資料模型類別</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">category</span><span class="p">;</span>

<span class="w">  </span><span class="n">Product</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">category</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">name</span><span class="s1"> - </span><span class="se">\$</span><span class="s1">{price.toStringAsFixed(2)}&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">User</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>

<span class="w">  </span><span class="n">User</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">age</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">name</span><span class="s1"> (</span><span class="si">$</span><span class="n">email</span><span class="s1">) - </span><span class="si">$</span><span class="n">age</span><span class="s1"> 歲&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 使用泛型 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">GenericListDemo</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">Product</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;iPhone 15&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">price:</span><span class="w"> </span><span class="m">30900</span><span class="p">,</span><span class="w"> </span><span class="nl">category:</span><span class="w"> </span><span class="s1">&#39;手機&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Product</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;iPad Air&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">price:</span><span class="w"> </span><span class="m">19900</span><span class="p">,</span><span class="w"> </span><span class="nl">category:</span><span class="w"> </span><span class="s1">&#39;平板&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="n">Product</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;MacBook Pro&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">price:</span><span class="w"> </span><span class="m">65900</span><span class="p">,</span><span class="w"> </span><span class="nl">category:</span><span class="w"> </span><span class="s1">&#39;筆電&#39;</span><span class="p">),</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="n">User</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;張小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;ming@example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="m">25</span><span class="p">),</span>
<span class="w">    </span><span class="n">User</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;李小華&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;hua@example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="m">30</span><span class="p">),</span>
<span class="w">    </span><span class="n">User</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;王小美&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;mei@example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">age:</span><span class="w"> </span><span class="m">28</span><span class="p">),</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;泛型列表示例&#39;</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 產品列表</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">GenericListWidget</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">              </span><span class="nl">items:</span><span class="w"> </span><span class="n">products</span><span class="p">,</span>
<span class="w">              </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">product</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">shopping_bag</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">name</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">${</span><span class="n">product</span><span class="p">.</span><span class="n">category</span><span class="si">}</span><span class="s1"> - </span><span class="se">\$</span><span class="s1">{product.price}&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">onItemTap:</span><span class="w"> </span><span class="p">(</span><span class="n">product</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;選擇了產品：</span><span class="si">${</span><span class="n">product</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="n">Divider</span><span class="p">(),</span>

<span class="w">          </span><span class="c1">// 使用者列表</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">GenericListWidget</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">              </span><span class="nl">items:</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">              </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">leading:</span><span class="w"> </span><span class="n">CircleAvatar</span><span class="p">(</span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="p">[</span><span class="m">0</span><span class="p">])),</span>
<span class="w">                    </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="si">}</span><span class="s1"> - </span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="n">age</span><span class="si">}</span><span class="s1"> 歲&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">onItemTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;選擇了使用者：</span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 泛型狀態管理</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">GenericStateManager</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="n">_state</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">void</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_listeners</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="n">GenericStateManager</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_state</span><span class="p">);</span>

<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_state</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">setState</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">newState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newState</span><span class="p">;</span>
<span class="w">    </span><span class="n">_notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">addListener</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">listener</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_listeners</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">listener</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">removeListener</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">listener</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_listeners</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">listener</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_notifyListeners</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">listener</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">_listeners</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">listener</span><span class="p">(</span><span class="n">_state</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_listeners</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用泛型狀態管理</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">CounterState</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="p">;</span>

<span class="w">  </span><span class="n">CounterState</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">isLoading</span><span class="p">});</span>

<span class="w">  </span><span class="n">CounterState</span><span class="w"> </span><span class="n">copyWith</span><span class="p">({</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">?</span><span class="w"> </span><span class="n">isLoading</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">CounterState</span><span class="p">(</span>
<span class="w">      </span><span class="nl">count:</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">count</span><span class="p">,</span>
<span class="w">      </span><span class="nl">isLoading:</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">GenericStateDemo</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_GenericStateDemoState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_GenericStateDemoState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_GenericStateDemoState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">GenericStateDemo</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">GenericStateManager</span><span class="o">&lt;</span><span class="n">CounterState</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stateManager</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="n">stateManager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenericStateManager</span><span class="o">&lt;</span><span class="n">CounterState</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">      </span><span class="n">CounterState</span><span class="p">(</span><span class="nl">count:</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nl">isLoading:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">stateManager</span><span class="p">.</span><span class="n">addListener</span><span class="p">((</span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 觸發 Widget 重建</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">stateManager</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_incrementCounter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">currentState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stateManager</span><span class="p">.</span><span class="n">state</span><span class="p">;</span>
<span class="w">    </span><span class="n">stateManager</span><span class="p">.</span><span class="n">setState</span><span class="p">(</span>
<span class="w">      </span><span class="n">currentState</span><span class="p">.</span><span class="n">copyWith</span><span class="p">(</span><span class="nl">count:</span><span class="w"> </span><span class="n">currentState</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_resetCounter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">stateManager</span><span class="p">.</span><span class="n">setState</span><span class="p">(</span>
<span class="w">      </span><span class="n">CounterState</span><span class="p">(</span><span class="nl">count:</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nl">isLoading:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stateManager</span><span class="p">.</span><span class="n">state</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;泛型狀態管理&#39;</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;計數器值：</span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">isLoading</span><span class="p">)</span>
<span class="w">              </span><span class="n">CircularProgressIndicator</span><span class="p">()</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">              </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_incrementCounter</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;增加&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">width:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                  </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_resetCounter</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;重設&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🎯 實際開發應用範例</h2>
<h3>1. <strong>表單驗證系統</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 驗證器類型定義</span>
<span class="kd">typedef</span><span class="w"> </span><span class="n">Validator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">FormValidators</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 字串驗證器</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Validator</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">required</span><span class="p">([</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;此欄位為必填&#39;</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">trim</span><span class="p">().</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Validator</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">minLength</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">minLength</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">message</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">minLength</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;長度不能少於 </span><span class="si">$</span><span class="n">minLength</span><span class="s1"> 個字元&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Validator</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxLength</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">maxLength</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">message</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxLength</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;長度不能超過 </span><span class="si">$</span><span class="n">maxLength</span><span class="s1"> 個字元&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Validator</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">email</span><span class="p">([</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;請輸入有效的電子郵件地址&#39;</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">emailRegex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="s1">r&#39;^[\w-\.]+@([\w-]+\.)+[\w-]{2,4});</span>
<span class="s1">        if (!emailRegex.hasMatch(value)) {</span>
<span class="s1">          return message;</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">      return null;</span>
<span class="s1">    };</span>
<span class="s1">  }</span>

<span class="s1">  static Validator&lt;String&gt; phone([String message = &#39;</span><span class="err">請輸入有效的手機號碼</span><span class="s1">&#39;]) {</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">phoneRegex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="s1">r&#39;^09\d{8});</span>
<span class="s1">        if (!phoneRegex.hasMatch(value)) {</span>
<span class="s1">          return message;</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">      return null;</span>
<span class="s1">    };</span>
<span class="s1">  }</span>

<span class="s1">  // 數字驗證器</span>
<span class="s1">  static Validator&lt;String&gt; numeric([String message = &#39;</span><span class="err">請輸入有效的數字</span><span class="s1">&#39;]) {</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Validator</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">min</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">max</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">message</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;請輸入有效的數字&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;數值必須在 </span><span class="si">$</span><span class="n">min</span><span class="s1"> 到 </span><span class="si">$</span><span class="n">max</span><span class="s1"> 之間&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 組合驗證器</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Validator</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">combine</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Validator</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">validators</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">validator</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">validators</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">validator</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">error</span><span class="p">;</span><span class="w"> </span><span class="c1">// 回傳第一個錯誤</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用表單驗證的實際範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserRegistrationForm</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_UserRegistrationFormState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_UserRegistrationFormState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_UserRegistrationFormState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">UserRegistrationForm</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_formKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalKey</span><span class="o">&lt;</span><span class="n">FormState</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_nameController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_emailController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_phoneController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_passwordController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_confirmPasswordController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_ageController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_nameController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_emailController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_phoneController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_passwordController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_confirmPasswordController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">_ageController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_submitForm</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_formKey</span><span class="p">.</span><span class="n">currentState</span><span class="o">!</span><span class="p">.</span><span class="n">validate</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 表單驗證通過，處理提交邏輯</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">userData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">_nameController</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">_emailController</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;phone&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">_phoneController</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;age&#39;</span><span class="o">:</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">_ageController</span><span class="p">.</span><span class="n">text</span><span class="p">),</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;使用者註冊資料：</span><span class="si">$</span><span class="n">userData</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<span class="w">        </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;註冊成功！&#39;</span><span class="p">)),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;使用者註冊&#39;</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Form</span><span class="p">(</span>
<span class="w">          </span><span class="nl">key:</span><span class="w"> </span><span class="n">_formKey</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">SingleChildScrollView</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="c1">// 姓名輸入</span>
<span class="w">                </span><span class="n">TextFormField</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_nameController</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;姓名&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">validator:</span><span class="w"> </span><span class="n">FormValidators</span><span class="p">.</span><span class="n">combine</span><span class="p">([</span>
<span class="w">                    </span><span class="n">FormValidators</span><span class="p">.</span><span class="kd">required</span><span class="p">(</span><span class="s1">&#39;請輸入姓名&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">FormValidators</span><span class="p">.</span><span class="n">minLength</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;姓名至少需要 2 個字元&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">FormValidators</span><span class="p">.</span><span class="n">maxLength</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;姓名不能超過 20 個字元&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="p">]),</span>
<span class="w">                </span><span class="p">),</span>

<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">                </span><span class="c1">// 密碼輸入</span>
<span class="w">                </span><span class="n">TextFormField</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_passwordController</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">obscureText:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;密碼&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">lock</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">validator:</span><span class="w"> </span><span class="n">FormValidators</span><span class="p">.</span><span class="n">combine</span><span class="p">([</span>
<span class="w">                    </span><span class="n">FormValidators</span><span class="p">.</span><span class="kd">required</span><span class="p">(</span><span class="s1">&#39;請輸入密碼&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">FormValidators</span><span class="p">.</span><span class="n">minLength</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;密碼至少需要 8 個字元&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="p">]),</span>
<span class="w">                </span><span class="p">),</span>

<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">                </span><span class="c1">// 確認密碼輸入</span>
<span class="w">                </span><span class="n">TextFormField</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_confirmPasswordController</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">obscureText:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;確認密碼&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">prefixIcon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">lock_outline</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;請確認密碼&#39;</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_passwordController</span><span class="p">.</span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;密碼不一致&#39;</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">                  </span><span class="p">},</span>
<span class="w">                </span><span class="p">),</span>

<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">32</span><span class="p">),</span>

<span class="w">                </span><span class="c1">// 提交按鈕</span>
<span class="w">                </span><span class="n">SizedBox</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_submitForm</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;註冊&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>2. <strong>HTTP 請求與響應處理</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:http/http.dart&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">http</span><span class="p">;</span>

<span class="c1">// 響應包裝類</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ApiResponse</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">success</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">T</span><span class="o">?</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">error</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">statusCode</span><span class="p">;</span>

<span class="w">  </span><span class="n">ApiResponse</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">success</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">data</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">error</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">factory</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">statusCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">      </span><span class="nl">success:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nl">data:</span><span class="w"> </span><span class="n">data</span><span class="p">,</span>
<span class="w">      </span><span class="nl">statusCode:</span><span class="w"> </span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">factory</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">statusCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">      </span><span class="nl">success:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nl">error:</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">      </span><span class="nl">statusCode:</span><span class="w"> </span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// HTTP 服務類</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ApiService</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://jsonplaceholder.typicode.com&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Duration</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">30</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// GET 請求 - 回傳單一物件</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">fetchUser</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
<span class="w">        </span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">baseUrl</span><span class="s1">/users/</span><span class="si">$</span><span class="n">userId</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">headers:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
<span class="w">      </span><span class="p">).</span><span class="n">timeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">userData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">userData</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;無法取得使用者資料：</span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;網路錯誤：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="m">0</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// GET 請求 - 回傳陣列</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;&gt;&gt;</span><span class="w"> </span><span class="n">fetchUsers</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
<span class="w">        </span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">baseUrl</span><span class="s1">/users&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">headers:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
<span class="w">      </span><span class="p">).</span><span class="n">timeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">);</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">            </span><span class="n">jsonList</span><span class="p">.</span><span class="n">cast</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">users</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;無法取得使用者列表：</span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;網路錯誤：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="m">0</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// POST 請求 - 建立資源</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">createPost</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">body</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">requestBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;title&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;body&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">body</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;userId&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="n">post</span><span class="p">(</span>
<span class="w">        </span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">baseUrl</span><span class="s1">/posts&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">headers:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
<span class="w">        </span><span class="nl">body:</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="n">requestBody</span><span class="p">),</span>
<span class="w">      </span><span class="p">).</span><span class="n">timeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">201</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createdPost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">createdPost</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;建立文章失敗：</span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;網路錯誤：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="m">0</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// PUT 請求 - 更新資源</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">updatePost</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">postId</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">body</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">requestBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">postId</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;title&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;body&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">body</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;userId&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="n">put</span><span class="p">(</span>
<span class="w">        </span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">baseUrl</span><span class="s1">/posts/</span><span class="si">$</span><span class="n">postId</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">headers:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
<span class="w">        </span><span class="nl">body:</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="n">requestBody</span><span class="p">),</span>
<span class="w">      </span><span class="p">).</span><span class="n">timeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updatedPost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">updatedPost</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;更新文章失敗：</span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;網路錯誤：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="m">0</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// DELETE 請求 - 刪除資源</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">deletePost</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">postId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">http</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span>
<span class="w">        </span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">baseUrl</span><span class="s1">/posts/</span><span class="si">$</span><span class="n">postId</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">headers:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
<span class="w">      </span><span class="p">).</span><span class="n">timeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;刪除文章失敗：</span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;網路錯誤：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="m">0</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用 API 服務的實際範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ApiDemoWidget</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_ApiDemoWidgetState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ApiDemoWidgetState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_ApiDemoWidgetState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ApiDemoWidget</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">selectedUser</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="n">_loadUsers</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 載入使用者列表</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadUsers</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">ApiService</span><span class="p">.</span><span class="n">fetchUsers</span><span class="p">();</span>

<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="o">!</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">error</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 載入特定使用者</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadUser</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">ApiService</span><span class="p">.</span><span class="n">fetchUser</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>

<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">selectedUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">error</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 建立新文章</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_createPost</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">ApiService</span><span class="p">.</span><span class="n">createPost</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;測試文章標題&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="s1">&#39;這是一篇測試文章的內容。&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">userId:</span><span class="w"> </span><span class="n">selectedUser</span><span class="o">?</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<span class="w">        </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;文章建立成功！ID: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<span class="w">        </span><span class="n">SnackBar</span><span class="p">(</span>
<span class="w">          </span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;建立失敗：</span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">error</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;API 示例&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">refresh</span><span class="p">),</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_loadUsers</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 錯誤訊息顯示</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errorMessage</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">errorMessage</span><span class="o">!</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">800</span><span class="p">]),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 載入指示器</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isLoading</span><span class="p">)</span>
<span class="w">            </span><span class="n">LinearProgressIndicator</span><span class="p">(),</span>

<span class="w">          </span><span class="c1">// 選中的使用者資訊</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">selectedUser</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">Card</span><span class="p">(</span>
<span class="w">              </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="s1">&#39;選中的使用者&#39;</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;姓名：</span><span class="si">${</span><span class="n">selectedUser</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;電子郵件：</span><span class="si">${</span><span class="n">selectedUser</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;電話：</span><span class="si">${</span><span class="n">selectedUser</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;網站：</span><span class="si">${</span><span class="n">selectedUser</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;website&#39;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                    </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_createPost</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;為此使用者建立文章&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 使用者列表</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">              </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">              </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">final</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">users</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">leading:</span><span class="w"> </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="m">0</span><span class="p">]),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span>
<span class="w">                  </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]),</span>
<span class="w">                  </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">arrow_forward_ios</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_loadUser</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]),</span>
<span class="w">                  </span><span class="nl">selected:</span><span class="w"> </span><span class="n">selectedUser</span><span class="o">?</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
<span class="w">                </span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>3. <strong>狀態管理與資料流</strong></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 狀態管理的不同模式</span>

<span class="c1">// 1. 簡單狀態（bool, int, String）</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">SimpleStateExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_SimpleStateExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_SimpleStateExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_SimpleStateExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">SimpleStateExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 基本狀態變數</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isVisible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello Flutter&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;項目1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;項目2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;項目3&#39;</span><span class="p">];</span>

<span class="w">  </span><span class="c1">// 狀態更新方法</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">toggleVisibility</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isVisible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">isVisible</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">incrementCounter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">counter</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">updateMessage</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">newMessage</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newMessage</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">addItem</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">items</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">removeItem</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">items</span><span class="p">.</span><span class="n">removeAt</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;簡單狀態管理&#39;</span><span class="p">)),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">stretch</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="c1">// 顯示/隱藏控制</span>
<span class="w">            </span><span class="n">Row</span><span class="p">(</span>
<span class="w">              </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceBetween</span><span class="p">,</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;顯示狀態：</span><span class="si">${</span><span class="n">isVisible</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;顯示&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;隱藏&quot;</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="n">Switch</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">value:</span><span class="w"> </span><span class="n">isVisible</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">isVisible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 計數器</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isVisible</span><span class="p">)</span><span class="w"> </span><span class="p">...[</span>
<span class="w">              </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="s1">&#39;計數器：</span><span class="si">$</span><span class="n">counter</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                      </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">                      </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceEvenly</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                          </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">counter</span><span class="o">--</span><span class="p">),</span>
<span class="w">                            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">remove</span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                          </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">incrementCounter</span><span class="p">,</span>
<span class="w">                            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">add</span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                          </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">                            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;重設&#39;</span><span class="p">),</span>
<span class="w">                          </span><span class="p">),</span>
<span class="w">                        </span><span class="p">],</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>

<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">              </span><span class="c1">// 訊息輸入</span>
<span class="w">              </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">                </span><span class="nl">onChanged:</span><span class="w"> </span><span class="n">updateMessage</span><span class="p">,</span>
<span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;輸入訊息&#39;</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>

<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>

<span class="w">              </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;當前訊息：</span><span class="si">$</span><span class="n">message</span><span class="s1">&#39;</span><span class="p">),</span>

<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">              </span><span class="c1">// 動態列表</span>
<span class="w">              </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">onSubmitted:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                          </span><span class="n">addItem</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                      </span><span class="p">},</span>
<span class="w">                      </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;新增項目&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">border:</span><span class="w"> </span><span class="n">OutlineInputBorder</span><span class="p">(),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">width:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                  </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;項目</span><span class="si">${</span><span class="n">items</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">add</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>

<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>

<span class="w">            </span><span class="c1">// 項目列表</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">                </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">                </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span>
<span class="w">                      </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">delete</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">                        </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">removeItem</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">);</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 2. 複雜狀態物件</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AppState</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">error</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">users</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">selectedUser</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">settings</span><span class="p">;</span>

<span class="w">  </span><span class="n">AppState</span><span class="p">({</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">error</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">selectedUser</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">settings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{},</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// 建立新狀態的便利方法</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">copyWith</span><span class="p">({</span>
<span class="w">    </span><span class="kt">bool</span><span class="o">?</span><span class="w"> </span><span class="n">isLoading</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;?</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">    </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">selectedUser</span><span class="p">,</span>
<span class="w">    </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">settings</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">AppState</span><span class="p">(</span>
<span class="w">      </span><span class="nl">isLoading:</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span>
<span class="w">      </span><span class="nl">error:</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">error</span><span class="p">,</span>
<span class="w">      </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">users</span><span class="p">,</span>
<span class="w">      </span><span class="nl">selectedUser:</span><span class="w"> </span><span class="n">selectedUser</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">selectedUser</span><span class="p">,</span>
<span class="w">      </span><span class="nl">settings:</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">settings</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 清除錯誤</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">clearError</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">copyWith</span><span class="p">(</span><span class="nl">error:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 設定載入狀態</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">setLoading</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">loading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">copyWith</span><span class="p">(</span><span class="nl">isLoading:</span><span class="w"> </span><span class="n">loading</span><span class="p">,</span><span class="w"> </span><span class="nl">error:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 設定錯誤</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">setError</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">copyWith</span><span class="p">(</span><span class="nl">isLoading:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nl">error:</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 設定使用者列表</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">setUsers</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">userList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">copyWith</span><span class="p">(</span><span class="nl">isLoading:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nl">users:</span><span class="w"> </span><span class="n">userList</span><span class="p">,</span><span class="w"> </span><span class="nl">error:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 選擇使用者</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">selectUser</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">copyWith</span><span class="p">(</span><span class="nl">selectedUser:</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 更新設定</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">updateSettings</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">newSettings</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">updatedSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="p">.</span><span class="n">from</span><span class="p">(</span><span class="n">settings</span><span class="p">);</span>
<span class="w">    </span><span class="n">updatedSettings</span><span class="p">.</span><span class="n">addAll</span><span class="p">(</span><span class="n">newSettings</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">copyWith</span><span class="p">(</span><span class="nl">settings:</span><span class="w"> </span><span class="n">updatedSettings</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用複雜狀態物件的 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ComplexStateExample</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">_ComplexStateExampleState</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ComplexStateExampleState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_ComplexStateExampleState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ComplexStateExample</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">AppState</span><span class="w"> </span><span class="n">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AppState</span><span class="p">(</span>
<span class="w">    </span><span class="nl">settings:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;theme&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;language&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;zh_TW&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;notifications&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 更新狀態的統一方法</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_updateState</span><span class="p">(</span><span class="n">AppState</span><span class="w"> </span><span class="n">newState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newState</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 載入使用者資料</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadUsers</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_updateState</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">setLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 模擬 API 呼叫</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">2</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// 模擬資料</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;張小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ming@example.com&#39;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;李小華&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;hua@example.com&#39;</span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;王小美&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;mei@example.com&#39;</span><span class="p">},</span>
<span class="w">      </span><span class="p">];</span>

<span class="w">      </span><span class="n">_updateState</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">setUsers</span><span class="p">(</span><span class="n">users</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_updateState</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">setError</span><span class="p">(</span><span class="s1">&#39;載入使用者失敗：</span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 選擇使用者</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_selectUser</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_updateState</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">selectUser</span><span class="p">(</span><span class="n">user</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 更新設定</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_updateSetting</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_updateState</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">updateSettings</span><span class="p">({</span><span class="nl">key:</span><span class="w"> </span><span class="n">value</span><span class="p">}));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 清除錯誤</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_clearError</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_updateState</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">clearError</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="n">_loadUsers</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;複雜狀態管理&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">refresh</span><span class="p">),</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_loadUsers</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="c1">// 錯誤顯示</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">Container</span><span class="p">(</span>
<span class="w">              </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                      </span><span class="n">_state</span><span class="p">.</span><span class="n">error</span><span class="o">!</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">800</span><span class="p">]),</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">close</span><span class="p">),</span>
<span class="w">                    </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_clearError</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 載入指示器</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">isLoading</span><span class="p">)</span>
<span class="w">            </span><span class="n">LinearProgressIndicator</span><span class="p">(),</span>

<span class="w">          </span><span class="c1">// 設定區域</span>
<span class="w">          </span><span class="n">Card</span><span class="p">(</span>
<span class="w">            </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">              </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="s1">&#39;應用程式設定&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">                  </span><span class="c1">// 主題設定</span>
<span class="w">                  </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceBetween</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;主題模式&#39;</span><span class="p">),</span>
<span class="w">                      </span><span class="n">DropdownButton</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">value:</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;theme&#39;</span><span class="p">],</span>
<span class="w">                        </span><span class="nl">items:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                          </span><span class="n">DropdownMenuItem</span><span class="p">(</span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;light&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;淺色&#39;</span><span class="p">)),</span>
<span class="w">                          </span><span class="n">DropdownMenuItem</span><span class="p">(</span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;深色&#39;</span><span class="p">)),</span>
<span class="w">                          </span><span class="n">DropdownMenuItem</span><span class="p">(</span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;自動&#39;</span><span class="p">)),</span>
<span class="w">                        </span><span class="p">],</span>
<span class="w">                        </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_updateSetting</span><span class="p">(</span><span class="s1">&#39;theme&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>

<span class="w">                  </span><span class="c1">// 通知設定</span>
<span class="w">                  </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">spaceBetween</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                      </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;推送通知&#39;</span><span class="p">),</span>
<span class="w">                      </span><span class="n">Switch</span><span class="p">(</span>
<span class="w">                        </span><span class="nl">value:</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;notifications&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_updateSetting</span><span class="p">(</span><span class="s1">&#39;notifications&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">),</span>
<span class="w">                      </span><span class="p">),</span>
<span class="w">                    </span><span class="p">],</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 選中的使用者</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">selectedUser</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">Card</span><span class="p">(</span>
<span class="w">              </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                </span><span class="nl">leading:</span><span class="w"> </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">selectedUser</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="m">0</span><span class="p">]),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">selectedUser</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span>
<span class="w">                </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">_state</span><span class="p">.</span><span class="n">selectedUser</span><span class="o">!</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]),</span>
<span class="w">                </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">amber</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 使用者列表</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<span class="w">              </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="n">users</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">              </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">final</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="n">users</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="w">                </span><span class="kd">final</span><span class="w"> </span><span class="n">isSelected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="n">selectedUser</span><span class="o">?</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">leading:</span><span class="w"> </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="m">0</span><span class="p">]),</span>
<span class="w">                    </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">isSelected</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span>
<span class="w">                  </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]),</span>
<span class="w">                  </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">isSelected</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">check</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_selectUser</span><span class="p">(</span><span class="n">user</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">selected:</span><span class="w"> </span><span class="n">isSelected</span><span class="p">,</span>
<span class="w">                </span><span class="p">);</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>

<span class="w">          </span><span class="c1">// 狀態資訊顯示（僅供開發時查看）</span>
<span class="w">          </span><span class="n">Container</span><span class="p">(</span>
<span class="w">            </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;當前狀態：&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;載入中：</span><span class="si">${</span><span class="n">_state</span><span class="p">.</span><span class="n">isLoading</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;錯誤：</span><span class="si">${</span><span class="n">_state</span><span class="p">.</span><span class="n">error</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s2">&quot;無&quot;</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;使用者數量：</span><span class="si">${</span><span class="n">_state</span><span class="p">.</span><span class="n">users</span><span class="p">.</span><span class="n">length</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;選中使用者：</span><span class="si">${</span><span class="n">_state</span><span class="p">.</span><span class="n">selectedUser</span><span class="o">?</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s2">&quot;無&quot;</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;設定：</span><span class="si">${</span><span class="n">_state</span><span class="p">.</span><span class="n">settings</span><span class="p">.</span><span class="n">toString</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🎯 總結與最佳實踐</h2>
<h3>型別使用原則</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ✅ 良好的型別使用</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">GoodPractice</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 1. 明確的型別宣告</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">userName</span><span class="p">;</span><span class="w">              </span><span class="c1">// 清楚的變數型別</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hobbies</span><span class="p">;</span><span class="w">         </span><span class="c1">// 泛型型別明確</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">scores</span><span class="p">;</span><span class="w">      </span><span class="c1">// 鍵值型別都明確</span>

<span class="w">  </span><span class="c1">// 2. 函數回傳型別明確</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">getFullName</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">first</span><span class="s1"> </span><span class="si">$</span><span class="n">last</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">fetchNotifications</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 異步操作回傳明確型別</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;通知1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;通知2&#39;</span><span class="p">];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 3. 使用可為空型別來表達意圖</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">findUserById</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 可能找不到，回傳 null</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 4. 泛型的合理使用</span>
<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="n">processData</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="kt">Function</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">processor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">processor</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ❌ 避免的不良實踐</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">BadPractice</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 1. 過度使用 dynamic</span>
<span class="w">  </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">userData</span><span class="p">;</span><span class="w">  </span><span class="c1">// 不清楚資料結構</span>

<span class="w">  </span><span class="c1">// 2. 回傳型別不明確</span>
<span class="w">  </span><span class="kd">get</span><span class="w"> </span><span class="n">someData</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">userData</span><span class="p">;</span><span class="w">  </span><span class="c1">// 不知道回傳什麼</span>

<span class="w">  </span><span class="c1">// 3. 沒有處理 null 的情況</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">userData</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span><span class="w">  </span><span class="c1">// 可能拋出異常</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 4. 泛型使用不當</span>
<span class="w">  </span><span class="n">processStuff</span><span class="p">(</span><span class="n">stuff</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// 沒有型別資訊</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">stuff</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>開發建議</h3>
<ol>
<li><strong>總是使用明確的型別宣告</strong></li>
<li>提高程式碼可讀性</li>
<li>獲得更好的 IDE 支援</li>
<li>避免執行時型別錯誤</li>
<li><strong>善用 Null Safety</strong></li>
<li>使用 <code>?</code> 表示可為空的型別</li>
<li>使用 <code>??</code> 運算子提供預設值</li>
<li>在確定不為 null 時才使用 <code>!</code></li>
<li><strong>合理使用泛型</strong></li>
<li>提高程式碼重用性</li>
<li>保持型別安全</li>
<li>使 API 更加靈活</li>
<li><strong>異步程式設計最佳實踐</strong></li>
<li>使用 <code>Future&lt;T&gt;</code> 表示異步操作</li>
<li>適當處理錯誤情況</li>
<li>使用 <code>async/await</code> 讓程式碼更易讀</li>
</ol>
<p>記住，良好的型別使用不僅能讓程式碼更安全，還能讓其他開發者（包括未來的自己）更容易理解和維護程式碼！</p>
<h3>🎉 恭喜！</h3>
<p>現在你已經掌握了 Dart 中各種資料型別的使用方法。這些不是函數，而是描述資料的型別系統。理解這些型別將幫助你：</p>
<ul>
<li>寫出更安全的程式碼</li>
<li>獲得更好的開發體驗</li>
<li>避免常見的執行時錯誤</li>
<li>建構更健壯的 Flutter 應用程式</li>
</ul>
<p>繼續練習和探索，你將成為 Flutter 開發的專家！🚀</p>
                    </div>
                </div>
            
                <div class="tab-pane fade " id="5.-project-framework" 
                     role="tabpanel" aria-labelledby="5.-project-framework-tab">
                    <div class="content-wrapper">
                        <h1>Flutter 專案架構設計模組化指南</h1>
<h2>🎯 架構設計核心原則</h2>
<h3>為什麼需要模組化架構？</h3>
<div class="codehilite"><pre><span></span><code>❌ 傳統架構                    ✅ 模組化架構
┌─────────────────────┐       ┌──────────┬──────────┐
│                     │       │ 🎨 UI    │ 📋 Logic │
│  所有程式碼混在一起    │  ──►  ├──────────┼──────────┤
│                     │       │ 🗃️ Data  │ 🔧 Core  │
│ • UI + 業務邏輯      │       └──────────┴──────────┘
│ • 資料處理          │
│ • 網路請求          │       ✅ 易於測試 | 可維護 | 可擴展
│ • 錯誤處理          │
│                     │
│ ❌ 難以維護 &amp; 測試   │
└─────────────────────┘
</code></pre></div>

<p><strong>模組化架構的核心價值：</strong></p>
<ul>
<li>🎯 <strong>單一職責</strong>：每個模組專注一件事</li>
<li>🔧 <strong>易於維護</strong>：修改影響範圍可控</li>
<li>🧪 <strong>便於測試</strong>：各層可獨立測試</li>
<li>👥 <strong>團隊協作</strong>：不同開發者可並行工作</li>
</ul>
<hr />
<h2>🏗️ MVVM 架構模式</h2>
<h3>架構層次圖</h3>
<div class="codehilite"><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                    📱 View Layer (表現層)                   │
│  • Widget &amp; Pages  • 使用者介面  • 事件處理                │
│  只關心 UI 呈現，不包含業務邏輯                             │
└──────────────────────┬──────────────────────────────────────┘
                       │ 事件通知
                       ▼
┌─────────────────────────────────────────────────────────────┐
│                🧠 ViewModel Layer (表現邏輯層)               │
│  • 狀態管理  • UI 業務邏輯  • 資料轉換                      │
│  連接 View 和 Model，處理 UI 相關邏輯                       │
└──────────────────────┬──────────────────────────────────────┘
                       │ 資料請求
                       ▼
┌─────────────────────────────────────────────────────────────┐
│                  🗃️ Model Layer (資料層)                   │
│  • Repository  • UseCase  • Entity                         │
│  處理資料邏輯、API 呼叫、本地儲存                           │
└─────────────────────────────────────────────────────────────┘
                       │
                       ▲ 單向資料流
</code></pre></div>

<h3>依賴方向規則</h3>
<div class="codehilite"><pre><span></span><code>Presentation ────────► Domain ◄──────── Data
     │                   │                │
     │                   │                │
     └─── 依賴 Domain ────┘                │
                         │                │
                         └─── 不依賴任何層 ──┘
                              │
                              └─── 依賴 Domain
</code></pre></div>

<p><strong>✅ 依賴規則</strong></p>
<ul>
<li>Presentation 層可以依賴 Domain，但不能依賴 Data</li>
<li>Data 層可以依賴 Domain，但不能依賴 Presentation</li>
<li>Domain 層不依賴任何層，保持純粹的業務邏輯</li>
</ul>
<hr />
<h2>📁 模組化目錄結構</h2>
<h3>核心模組組織</h3>
<div class="codehilite"><pre><span></span><code><span class="n">lib</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🎨</span><span class="w"> </span><span class="n">presentation</span><span class="o">/</span><span class="w">          </span><span class="c1"># 表現層模組</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">pages</span><span class="o">/</span><span class="w">               </span><span class="c1"># 頁面組件</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">widgets</span><span class="o">/</span><span class="w">             </span><span class="c1"># 可重用元件</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">providers</span><span class="o">/</span><span class="w">           </span><span class="c1"># 狀態管理</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">routes</span><span class="o">/</span><span class="w">              </span><span class="c1"># 路由配置</span>
<span class="err">├──</span><span class="w"> </span><span class="err">📋</span><span class="w"> </span><span class="n">domain</span><span class="o">/</span><span class="w">               </span><span class="c1"># 業務邏輯模組  </span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">entities</span><span class="o">/</span><span class="w">            </span><span class="c1"># 業務實體</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">repositories</span><span class="o">/</span><span class="w">        </span><span class="c1"># 抽象介面</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">usecases</span><span class="o">/</span><span class="w">           </span><span class="c1"># 用例</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🗃️</span><span class="w"> </span><span class="n">data</span><span class="o">/</span><span class="w">                </span><span class="c1"># 資料層模組</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">repositories</span><span class="o">/</span><span class="w">        </span><span class="c1"># 實作類別</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">datasources</span><span class="o">/</span><span class="w">         </span><span class="c1"># 資料來源</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">models</span><span class="o">/</span><span class="w">             </span><span class="c1"># 資料模型</span>
<span class="err">└──</span><span class="w"> </span><span class="err">🔧</span><span class="w"> </span><span class="n">core</span><span class="o">/</span><span class="w">                </span><span class="c1"># 核心模組</span>
<span class="w">    </span><span class="err">├──</span><span class="w"> </span><span class="n">constants</span><span class="o">/</span><span class="w">           </span><span class="c1"># 常數定義</span>
<span class="w">    </span><span class="err">├──</span><span class="w"> </span><span class="n">utils</span><span class="o">/</span><span class="w">              </span><span class="c1"># 工具函數</span>
<span class="w">    </span><span class="err">├──</span><span class="w"> </span><span class="n">network</span><span class="o">/</span><span class="w">            </span><span class="c1"># 網路服務</span>
<span class="w">    </span><span class="err">└──</span><span class="w"> </span><span class="n">injection</span><span class="o">/</span><span class="w">          </span><span class="c1"># 依賴注入</span>
</code></pre></div>

<h3>模組依賴關係圖</h3>
<div class="codehilite"><pre><span></span><code>                    ┌─────────────┐
                    │  🎨 Present │
                    │    ation    │
                    └──────┬──────┘
                           │
                           ▼
      ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
      │  🗃️ Data   │  │  📋 Domain  │  │  🔧 Core   │
      │            │  │             │  │             │
      └──────┬──────┘  └──────┬──────┘  └──────┬──────┘
             │                │                │
             └────────────────┼────────────────┘
                              ▼
              依賴關係：Core ← Domain ← (Data | Presentation)
</code></pre></div>

<p><strong>模組職責說明：</strong></p>
<ul>
<li><strong>🎨 Presentation</strong>：UI 展示和使用者互動</li>
<li><strong>📋 Domain</strong>：業務邏輯和規則</li>
<li><strong>🗃️ Data</strong>：資料存取和管理</li>
<li><strong>🔧 Core</strong>：基礎設施和工具</li>
</ul>
<hr />
<h2>🔧 核心模組設計</h2>
<h3>依賴注入架構</h3>
<div class="codehilite"><pre><span></span><code>┌─────────────┐     ┌─────────────────┐     ┌─────────────┐
│  ViewModel  │────▶│  DI Container   │◄────│  UseCase    │
│  需要依賴   │     │                 │     │  獲得實例   │
└─────────────┘     │  🏭 Repository  │     └─────────────┘
                    │  📋 UseCase     │
┌─────────────┐     │  🌐 ApiClient   │     ┌─────────────┐
│ Repository  │────▶│  💾 Storage     │◄────│  Service    │
│  需要依賴   │     │                 │     │  獲得實例   │
└─────────────┘     └─────────────────┘     └─────────────┘

              ✅ 鬆耦合 | 易測試 | 可替換
</code></pre></div>

<h3>核心模組職責</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🔧 Core 模組結構</span>
<span class="n">core</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🌐</span><span class="w"> </span><span class="n">network</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">api_client</span><span class="p">.</span><span class="n">dart</span><span class="w">         </span><span class="c1">// HTTP 客戶端</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">interceptors</span><span class="p">.</span><span class="n">dart</span><span class="w">       </span><span class="c1">// 請求攔截器</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">network_info</span><span class="p">.</span><span class="n">dart</span><span class="w">       </span><span class="c1">// 網路狀態</span>
<span class="err">├──</span><span class="w"> </span><span class="err">💾</span><span class="w"> </span><span class="n">storage</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">local_storage</span><span class="p">.</span><span class="n">dart</span><span class="w">      </span><span class="c1">// 本地儲存介面</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">secure_storage</span><span class="p">.</span><span class="n">dart</span><span class="w">     </span><span class="c1">// 安全儲存</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🛠️</span><span class="w"> </span><span class="n">utils</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">date_utils</span><span class="p">.</span><span class="n">dart</span><span class="w">         </span><span class="c1">// 日期工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">validation_utils</span><span class="p">.</span><span class="n">dart</span><span class="w">   </span><span class="c1">// 驗證工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">format_utils</span><span class="p">.</span><span class="n">dart</span><span class="w">       </span><span class="c1">// 格式化工具</span>
<span class="err">├──</span><span class="w"> </span><span class="err">📊</span><span class="w"> </span><span class="n">constants</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_constants</span><span class="p">.</span><span class="n">dart</span><span class="w">      </span><span class="c1">// 應用常數</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">api_constants</span><span class="p">.</span><span class="n">dart</span><span class="w">      </span><span class="c1">// API 常數</span>
<span class="err">└──</span><span class="w"> </span><span class="err">🔌</span><span class="w"> </span><span class="n">injection</span><span class="o">/</span>
<span class="w">    </span><span class="err">└──</span><span class="w"> </span><span class="n">injection</span><span class="p">.</span><span class="n">dart</span><span class="w">          </span><span class="c1">// 依賴注入配置</span>
</code></pre></div>

<hr />
<h2>🗃️ 資料層模組化</h2>
<h3>Repository 模式架構</h3>
<div class="codehilite"><pre><span></span><code><span class="nx">Domain</span><span class="w"> </span><span class="nx">Layer</span>
<span class="err">┌─────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="nx">UserRepository</span><span class="w"> </span><span class="p">(</span><span class="nx">介面</span><span class="p">)</span><span class="w">          </span><span class="err">│</span>
<span class="err">└─────────────┬───────────────────┘</span>
<span class="w">              </span><span class="err">│</span><span class="w"> </span><span class="nx">implements</span>
<span class="w">              </span><span class="err">▼</span>
<span class="nx">Data</span><span class="w"> </span><span class="nx">Layer</span><span class="w">    </span>
<span class="err">┌─────────────────────────────────┐</span>
<span class="err">│</span><span class="w">  </span><span class="nx">UserRepositoryImpl</span><span class="w">             </span><span class="err">│</span>
<span class="err">├─────────────┬───────────────────┤</span>
<span class="err">│</span><span class="w">             </span><span class="err">│</span><span class="w">                   </span><span class="err">│</span>
<span class="err">▼</span><span class="w">             </span><span class="err">▼</span><span class="w">                   </span><span class="err">▼</span>
<span class="err">┌─────────┐</span><span class="w"> </span><span class="err">┌─────────┐</span><span class="w"> </span><span class="err">┌─────────────┐</span>
<span class="err">│🌐</span><span class="w"> </span><span class="nx">Remote</span><span class="err">│</span><span class="w"> </span><span class="err">│💾</span><span class="w"> </span><span class="nx">Local</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="err">│🎯</span><span class="w"> </span><span class="nx">Strategy</span><span class="w">  </span><span class="err">│</span>
<span class="err">│</span><span class="nx">API</span><span class="w"> </span><span class="nx">資料源</span><span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="nx">本地快取</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="err">│</span><span class="nx">快取策略</span><span class="w">     </span><span class="err">│</span>
<span class="err">└─────────┘</span><span class="w"> </span><span class="err">└─────────┘</span><span class="w"> </span><span class="err">└─────────────┘</span>
</code></pre></div>

<p><strong>資料流程：</strong> Repository → 選擇資料來源 → 快取策略 → 回傳統一格式</p>
<h3>資料層模組結構</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🗃️ Data 模組架構</span>
<span class="n">data</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🏭</span><span class="w"> </span><span class="n">repositories</span><span class="o">/</span><span class="w">           </span><span class="c1">// Repository 實作</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_repository_impl</span><span class="p">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">auth_repository_impl</span><span class="p">.</span><span class="n">dart</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🌐</span><span class="w"> </span><span class="n">datasources</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">remote</span><span class="o">/</span><span class="w">               </span><span class="c1">// 遠端資料來源</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_remote_datasource</span><span class="p">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">auth_remote_datasource</span><span class="p">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">local</span><span class="o">/</span><span class="w">               </span><span class="c1">// 本地資料來源  </span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">user_local_datasource</span><span class="p">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">auth_local_datasource</span><span class="p">.</span><span class="n">dart</span>
<span class="err">└──</span><span class="w"> </span><span class="err">📋</span><span class="w"> </span><span class="n">models</span><span class="o">/</span><span class="w">               </span><span class="c1">// 資料傳輸物件</span>
<span class="w">    </span><span class="err">├──</span><span class="w"> </span><span class="n">user_model</span><span class="p">.</span><span class="n">dart</span>
<span class="w">    </span><span class="err">└──</span><span class="w"> </span><span class="n">auth_model</span><span class="p">.</span><span class="n">dart</span>
</code></pre></div>

<hr />
<h2>🎨 表現層模組化</h2>
<h3>狀態管理架構</h3>
<div class="codehilite"><pre><span></span><code>📱 Widget ────事件───► 🧠 ViewModel ────呼叫───► 📋 UseCase
    │                      │                       │
    │                      │                       │
    ◄────狀態──────────────◄─────結果──────────────┘

                     可重用組件
┌─────────┬─────────┬─────────┬─────────┐
│共用Widget│表單組件 │列表組件 │對話框組件│
└─────────┴─────────┴─────────┴─────────┘

          ✅ 組件化 | 可重用 | 易維護
</code></pre></div>

<h3>表現層模組結構</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🎨 Presentation 模組架構</span>
<span class="n">presentation</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="err">📱</span><span class="w"> </span><span class="n">pages</span><span class="o">/</span><span class="w">                 </span><span class="c1">// 頁面</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth</span><span class="o">/</span><span class="w">                </span><span class="c1">// 認證頁面</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">home</span><span class="o">/</span><span class="w">                </span><span class="c1">// 首頁相關</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">profile</span><span class="o">/</span><span class="w">             </span><span class="c1">// 個人資料</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🧩</span><span class="w"> </span><span class="n">widgets</span><span class="o">/</span><span class="w">              </span><span class="c1">// 可重用組件</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">common</span><span class="o">/</span><span class="w">              </span><span class="c1">// 通用組件</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">forms</span><span class="o">/</span><span class="w">               </span><span class="c1">// 表單組件</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">lists</span><span class="o">/</span><span class="w">               </span><span class="c1">// 列表組件</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🧠</span><span class="w"> </span><span class="n">providers</span><span class="o">/</span><span class="w">            </span><span class="c1">// 狀態管理</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_provider</span><span class="p">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">user_provider</span><span class="p">.</span><span class="n">dart</span>
<span class="err">└──</span><span class="w"> </span><span class="err">🔀</span><span class="w"> </span><span class="n">routes</span><span class="o">/</span><span class="w">               </span><span class="c1">// 路由管理</span>
<span class="w">    </span><span class="err">├──</span><span class="w"> </span><span class="n">app_router</span><span class="p">.</span><span class="n">dart</span>
<span class="w">    </span><span class="err">└──</span><span class="w"> </span><span class="n">route_guards</span><span class="p">.</span><span class="n">dart</span>
</code></pre></div>

<hr />
<h2>🧪 測試模組化策略</h2>
<h3>測試金字塔</h3>
<div class="codehilite"><pre><span></span><code>                    ┌─────────────┐
                    │  E2E 測試   │  ← 10% (使用者流程、慢速執行)
                    │    頂層     │
                ┌───┴─────────────┴───┐
                │    整合測試         │  ← 20% (模組整合、中速執行)
                │      中層           │
            ┌───┴─────────────────────┴───┐
            │        單元測試             │  ← 70% (邏輯驗證、快速執行)
            │          底層               │
            └─────────────────────────────┘

            測試策略：快速反饋 + 全面覆蓋
    單元測試保證品質，整合測試保證功能，E2E 測試保證體驗
</code></pre></div>

<h3>測試模組組織</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🧪 測試模組結構</span>
<span class="n">test</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🔬</span><span class="w"> </span><span class="n">unit</span><span class="o">/</span><span class="w">                   </span><span class="c1">// 單元測試 (70%)</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">domain</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">usecases</span><span class="o">/</span><span class="w">         </span><span class="c1">// UseCase 測試</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">data</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">repositories</span><span class="o">/</span><span class="w">     </span><span class="c1">// Repository 測試</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">core</span><span class="o">/</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">utils</span><span class="o">/</span><span class="w">           </span><span class="c1">// 工具類測試</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🖼️</span><span class="w"> </span><span class="n">widget</span><span class="o">/</span><span class="w">                </span><span class="c1">// Widget 測試 (20%)</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">pages</span><span class="o">/</span><span class="w">               </span><span class="c1">// 頁面測試</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">components</span><span class="o">/</span><span class="w">          </span><span class="c1">// 組件測試</span>
<span class="err">├──</span><span class="w"> </span><span class="err">🔗</span><span class="w"> </span><span class="n">integration</span><span class="o">/</span><span class="w">           </span><span class="c1">// 整合測試 (10%)</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">flows</span><span class="o">/</span><span class="w">              </span><span class="c1">// 使用者流程測試</span>
<span class="err">└──</span><span class="w"> </span><span class="err">🛠️</span><span class="w"> </span><span class="n">helpers</span><span class="o">/</span><span class="w">              </span><span class="c1">// 測試輔助工具</span>
<span class="w">    </span><span class="err">├──</span><span class="w"> </span><span class="n">mocks</span><span class="o">/</span><span class="w">              </span><span class="c1">// Mock 物件</span>
<span class="w">    </span><span class="err">└──</span><span class="w"> </span><span class="n">fixtures</span><span class="o">/</span><span class="w">           </span><span class="c1">// 測試資料</span>
</code></pre></div>

<hr />
<h2>🚀 模組化最佳實踐</h2>
<h3>SOLID 原則在模組化中的應用</h3>
<div class="codehilite"><pre><span></span><code>┌─────────┬─────────┬─────────┬─────────┬─────────────┐
│    S    │    O    │    L    │    I    │      D      │
│  單一   │  開放   │  里氏   │  介面   │    依賴     │
│  職責   │  封閉   │  替換   │  隔離   │    倒置     │
├─────────┼─────────┼─────────┼─────────┼─────────────┤
│每個模組 │對擴展   │子類可以 │小而專一 │依賴抽象而非 │
│只負責   │開放     │替換父類 │的介面   │具體實現     │
│一件事   │對修改封閉│        │        │高層不依賴低層│
└─────────┴─────────┴─────────┴─────────┴─────────────┘
</code></pre></div>

<h3>實踐檢查清單</h3>
<h4>✅ 模組化檢查項目</h4>
<p><strong>📁 目錄結構清晰</strong></p>
<ul>
<li>[ ] 按職責分層組織</li>
<li>[ ] 模組邊界明確</li>
<li>[ ] 命名規範一致</li>
</ul>
<p><strong>🔗 依賴關係正確</strong></p>
<ul>
<li>[ ] 依賴方向清晰</li>
<li>[ ] 避免循環依賴</li>
<li>[ ] 使用抽象介面</li>
</ul>
<p><strong>🧪 測試覆蓋完整</strong></p>
<ul>
<li>[ ] 單元測試 70%</li>
<li>[ ] 整合測試 20%</li>
<li>[ ] E2E 測試 10%</li>
</ul>
<p><strong>🔧 可維護性良好</strong></p>
<ul>
<li>[ ] 模組職責單一</li>
<li>[ ] 介面設計簡潔</li>
<li>[ ] 文檔說明清楚</li>
</ul>
<h4>📈 模組化收益</h4>
<div class="codehilite"><pre><span></span><code><span class="c1">// ✅ 模組化帶來的價值</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ModularBenefits</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 🎯 開發效率提升</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">developmentSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;30-50%&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 🐛 Bug 發生率降低  </span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">bugReduction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;40-60%&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 🧪 測試覆蓋率提高</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">testCoverage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;70-90%&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 👥 團隊協作改善</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">teamCollaboration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;顯著提升&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 🔄 維護成本降低</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">maintenanceCost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;50-70%&quot;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🎯 實際應用範例</h2>
<h3>簡化的模組實作</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 📋 Domain Layer - 定義抽象</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">saveUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">GetUserUseCase</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">repository</span><span class="p">;</span>
<span class="w">  </span><span class="n">GetUserUseCase</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">repository</span><span class="p">);</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">getUser</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 🗃️ Data Layer - 實作具體邏輯</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserRepositoryImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRemoteDataSource</span><span class="w"> </span><span class="n">remoteDataSource</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserLocalDataSource</span><span class="w"> </span><span class="n">localDataSource</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserRepositoryImpl</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">remoteDataSource</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">localDataSource</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 先嘗試從遠端取得</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">remoteDataSource</span><span class="p">.</span><span class="n">getUser</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 失敗時從本地取得</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">localDataSource</span><span class="p">.</span><span class="n">getUser</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 🎨 Presentation Layer - 管理 UI 狀態</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserViewModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ChangeNotifier</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">GetUserUseCase</span><span class="w"> </span><span class="n">getUserUseCase</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserViewModel</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">getUserUseCase</span><span class="p">);</span>

<span class="w">  </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">_user</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_user</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_isLoading</span><span class="p">;</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">loadUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">getUserUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 錯誤處理</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">      </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>依賴注入設定</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🔌 依賴注入配置</span>
<span class="kt">void</span><span class="w"> </span><span class="n">setupDependencies</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Core</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">ApiClient</span><span class="o">&gt;</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ApiClientImpl</span><span class="p">());</span>

<span class="w">  </span><span class="c1">// Data Sources</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">UserRemoteDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserRemoteDataSourceImpl</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">UserLocalDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserLocalDataSourceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Repositories</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">UserRepository</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserRepositoryImpl</span><span class="p">(</span><span class="n">getIt</span><span class="p">(),</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Use Cases</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">GetUserUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GetUserUseCase</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// ViewModels</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerFactory</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserViewModel</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🎯 總結</h2>
<h3>模組化成功關鍵</h3>
<div class="codehilite"><pre><span></span><code>┌─────────┐    ┌─────────┐    ┌─────────┐
│  清晰   │───▶│  單向   │───▶│  充分   │
│  分層   │    │  依賴   │    │  測試   │
└─────────┘    └─────────┘    └─────────┘
     │              │              │
     └──────────────┼──────────────┘
                    ▼
            🚀 高品質 Flutter 應用
</code></pre></div>

<h3>實踐建議</h3>
<h4>🚀 開始步驟</h4>
<ol>
<li><strong>從小開始</strong>：選擇一個小功能模組練習</li>
<li><strong>逐步重構</strong>：將現有專案分步模組化</li>
<li><strong>建立規範</strong>：制定團隊模組化標準</li>
<li><strong>持續改進</strong>：根據實踐經驗優化架構</li>
</ol>
<h4>🎯 成功指標</h4>
<ul>
<li><strong>開發速度</strong>：新功能開發時間縮短</li>
<li><strong>程式碼品質</strong>：Bug 率明顯下降</li>
<li><strong>測試覆蓋</strong>：自動化測試覆蓋率提升</li>
<li><strong>團隊效率</strong>：協作衝突減少</li>
</ul>
<h4>💡 關鍵提醒</h4>
<div class="codehilite"><pre><span></span><code>⚠️  常見陷阱                ✅  正確做法
────────────────────────────────────────────
過度設計，架構過於複雜      →  從簡單開始，逐步完善
忽略測試，缺乏驗證          →  測試先行，保證品質
依賴關係混亂，耦合過高      →  清晰分層，單向依賴
團隊缺乏規範，各自為政      →  建立標準，統一實踐
</code></pre></div>

<p><strong>記住：模組化不是目的，而是提升開發效率和程式碼品質的手段。從實際需求出發，循序漸進地建立適合團隊的模組化架構，才是成功的關鍵！</strong> 🎯</p>
                    </div>
                </div>
            
                <div class="tab-pane fade " id="6.-project-design" 
                     role="tabpanel" aria-labelledby="6.-project-design-tab">
                    <div class="content-wrapper">
                        <h1>Flutter 專案設計與架構管理指南</h1>
<h2>🏗️ 專案架構概覽</h2>
<h3>為什麼需要好的專案架構？</h3>
<p>一個好的專案架構能夠：</p>
<ul>
<li>🎯 <strong>提高開發效率</strong>：清晰的結構讓功能開發更快速</li>
<li>🔧 <strong>便於維護</strong>：易於理解和修改現有功能</li>
<li>👥 <strong>團隊協作</strong>：統一的架構規範讓多人協作更順暢</li>
<li>🚀 <strong>可擴展性</strong>：隨著專案成長能夠輕鬆添加新功能</li>
<li>🧪 <strong>可測試性</strong>：清晰的分層讓單元測試更容易編寫</li>
</ul>
<h3>架構設計原則</h3>
<ol>
<li><strong>單一職責原則</strong>：每個類別或模組只負責一個功能</li>
<li><strong>開放封閉原則</strong>：對擴展開放，對修改封閉</li>
<li><strong>依賴倒置原則</strong>：高層模組不依賴低層模組</li>
<li><strong>關注點分離</strong>：UI、業務邏輯、資料層分離</li>
<li><strong>可測試性</strong>：架構設計要便於單元測試</li>
</ol>
<hr />
<h2>📁 專案目錄結構設計</h2>
<h3>完整的專案目錄架構</h3>
<div class="codehilite"><pre><span></span><code><span class="n">my_flutter_app</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="n">android</span><span class="o">/</span><span class="w">                    </span><span class="c1"># Android 平台特定檔案</span>
<span class="err">├──</span><span class="w"> </span><span class="n">ios</span><span class="o">/</span><span class="w">                        </span><span class="c1"># iOS 平台特定檔案</span>
<span class="err">├──</span><span class="w"> </span><span class="n">web</span><span class="o">/</span><span class="w">                        </span><span class="c1"># Web 平台特定檔案</span>
<span class="err">├──</span><span class="w"> </span><span class="n">assets</span><span class="o">/</span><span class="w">                     </span><span class="c1"># 資源檔案</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">images</span><span class="o">/</span><span class="w">                 </span><span class="c1"># 圖片資源</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">icons</span><span class="o">/</span><span class="w">             </span><span class="c1"># 圖標</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">backgrounds</span><span class="o">/</span><span class="w">       </span><span class="c1"># 背景圖</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">logos</span><span class="o">/</span><span class="w">             </span><span class="c1"># 標誌圖片</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">fonts</span><span class="o">/</span><span class="w">                 </span><span class="c1"># 字型檔案</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">data</span><span class="o">/</span><span class="w">                  </span><span class="c1"># 靜態資料檔案</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">json</span><span class="o">/</span><span class="w">              </span><span class="c1"># JSON 資料</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">translations</span><span class="o">/</span><span class="w">      </span><span class="c1"># 多語言檔案</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">animations</span><span class="o">/</span><span class="w">            </span><span class="c1"># 動畫檔案</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">lottie</span><span class="o">/</span><span class="w">           </span><span class="c1"># Lottie 動畫</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">rive</span><span class="o">/</span><span class="w">             </span><span class="c1"># Rive 動畫</span>
<span class="err">├──</span><span class="w"> </span><span class="n">lib</span><span class="o">/</span><span class="w">                       </span><span class="c1"># 主要程式碼目錄 🔥</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">main</span><span class="o">.</span><span class="n">dart</span><span class="w">             </span><span class="c1"># 應用程式入口</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app</span><span class="o">.</span><span class="n">dart</span><span class="w">              </span><span class="c1"># 主應用程式 Widget</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">core</span><span class="o">/</span><span class="w">                 </span><span class="c1"># 核心功能模組</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">constants</span><span class="o">/</span><span class="w">        </span><span class="c1"># 常數定義</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_constants</span><span class="o">.</span><span class="n">dart</span><span class="w">      </span><span class="c1"># 應用程式常數</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">api_constants</span><span class="o">.</span><span class="n">dart</span><span class="w">      </span><span class="c1"># API 相關常數</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">storage_constants</span><span class="o">.</span><span class="n">dart</span><span class="w">  </span><span class="c1"># 儲存相關常數</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">route_constants</span><span class="o">.</span><span class="n">dart</span><span class="w">    </span><span class="c1"># 路由常數</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="w">           </span><span class="c1"># 配置管理</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_config</span><span class="o">.</span><span class="n">dart</span><span class="w">         </span><span class="c1"># 應用程式配置</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">environment_config</span><span class="o">.</span><span class="n">dart</span><span class="w"> </span><span class="c1"># 環境配置</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">theme_config</span><span class="o">.</span><span class="n">dart</span><span class="w">       </span><span class="c1"># 主題配置</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">errors</span><span class="o">/</span><span class="w">           </span><span class="c1"># 錯誤處理</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_error</span><span class="o">.</span><span class="n">dart</span><span class="w">          </span><span class="c1"># 應用程式錯誤定義</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">error_handler</span><span class="o">.</span><span class="n">dart</span><span class="w">      </span><span class="c1"># 錯誤處理器</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">exceptions</span><span class="o">.</span><span class="n">dart</span><span class="w">         </span><span class="c1"># 自訂例外</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">network</span><span class="o">/</span><span class="w">          </span><span class="c1"># 網路層</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">api_client</span><span class="o">.</span><span class="n">dart</span><span class="w">         </span><span class="c1"># API 客戶端</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">interceptors</span><span class="o">.</span><span class="n">dart</span><span class="w">       </span><span class="c1"># 請求攔截器</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">network_info</span><span class="o">.</span><span class="n">dart</span><span class="w">       </span><span class="c1"># 網路狀態檢查</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">response_wrapper</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 響應包裝器</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">storage</span><span class="o">/</span><span class="w">          </span><span class="c1"># 本地儲存</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">local_storage</span><span class="o">.</span><span class="n">dart</span><span class="w">      </span><span class="c1"># 本地儲存介面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">shared_prefs_storage</span><span class="o">.</span><span class="n">dart</span><span class="w"> </span><span class="c1"># SharedPreferences 實作</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">secure_storage</span><span class="o">.</span><span class="n">dart</span><span class="w">     </span><span class="c1"># 安全儲存</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">database</span><span class="o">/</span><span class="w">               </span><span class="c1"># 資料庫相關</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">app_database</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 資料庫定義</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">dao</span><span class="o">/</span><span class="w">                </span><span class="c1"># 資料存取物件</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">entities</span><span class="o">/</span><span class="w">           </span><span class="c1"># 資料庫實體</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">utils</span><span class="o">/</span><span class="w">            </span><span class="c1"># 工具類別</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">date_utils</span><span class="o">.</span><span class="n">dart</span><span class="w">         </span><span class="c1"># 日期工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">validation_utils</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 驗證工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">format_utils</span><span class="o">.</span><span class="n">dart</span><span class="w">       </span><span class="c1"># 格式化工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">permission_utils</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 權限工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">image_utils</span><span class="o">.</span><span class="n">dart</span><span class="w">        </span><span class="c1"># 圖片處理工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">extensions</span><span class="o">/</span><span class="w">       </span><span class="c1"># 擴展方法</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">string_extensions</span><span class="o">.</span><span class="n">dart</span><span class="w">  </span><span class="c1"># 字串擴展</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">date_extensions</span><span class="o">.</span><span class="n">dart</span><span class="w">    </span><span class="c1"># 日期擴展</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">context_extensions</span><span class="o">.</span><span class="n">dart</span><span class="w"> </span><span class="c1"># BuildContext 擴展</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">widget_extensions</span><span class="o">.</span><span class="n">dart</span><span class="w">  </span><span class="c1"># Widget 擴展</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">injection</span><span class="o">/</span><span class="w">        </span><span class="c1"># 依賴注入</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">injection</span><span class="o">.</span><span class="n">dart</span><span class="w">          </span><span class="c1"># 依賴注入配置</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">injection</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 生成的配置檔案</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">data</span><span class="o">/</span><span class="w">                 </span><span class="c1"># 資料層 (Repository Pattern)</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">repositories</span><span class="o">/</span><span class="w">     </span><span class="c1"># 儲存庫實作</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_repository_impl</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_repository_impl</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">product_repository_impl</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">datasources</span><span class="o">/</span><span class="w">      </span><span class="c1"># 資料源</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="k">remote</span><span class="o">/</span><span class="w">       </span><span class="c1"># 遠端資料源</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_remote_datasource</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_remote_datasource</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">product_remote_datasource</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">local</span><span class="o">/</span><span class="w">        </span><span class="c1"># 本地資料源</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_local_datasource</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">user_local_datasource</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">product_local_datasource</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">models</span><span class="o">/</span><span class="w">           </span><span class="c1"># 資料模型 (DTO)</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">request</span><span class="o">/</span><span class="w">      </span><span class="c1"># 請求模型</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">login_request</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">register_request</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">response</span><span class="o">/</span><span class="w">     </span><span class="c1"># 響應模型</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">login_response</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_response</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">product_response</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">local</span><span class="o">/</span><span class="w">        </span><span class="c1"># 本地模型</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">├──</span><span class="w"> </span><span class="n">user_local_model</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">└──</span><span class="w"> </span><span class="n">product_local_model</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">domain</span><span class="o">/</span><span class="w">               </span><span class="c1"># 業務邏輯層</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">entities</span><span class="o">/</span><span class="w">         </span><span class="c1"># 業務實體</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">product</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">order</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">auth_token</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">repositories</span><span class="o">/</span><span class="w">     </span><span class="c1"># 儲存庫抽象介面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_repository</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_repository</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">product_repository</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">usecases</span><span class="o">/</span><span class="w">         </span><span class="c1"># 用例 (業務邏輯)</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">auth</span><span class="o">/</span><span class="w">         </span><span class="c1"># 認證相關用例</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">login_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">logout_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">register_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">refresh_token_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">user</span><span class="o">/</span><span class="w">         </span><span class="c1"># 使用者相關用例</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">get_user_profile_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">update_user_profile_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">delete_user_account_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">product</span><span class="o">/</span><span class="w">      </span><span class="c1"># 產品相關用例</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">├──</span><span class="w"> </span><span class="n">get_products_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">├──</span><span class="w"> </span><span class="n">search_products_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">           </span><span class="err">└──</span><span class="w"> </span><span class="n">get_product_detail_usecase</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">presentation</span><span class="o">/</span><span class="w">         </span><span class="c1"># 表現層 (UI)</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">pages</span><span class="o">/</span><span class="w">            </span><span class="c1"># 頁面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth</span><span class="o">/</span><span class="w">         </span><span class="c1"># 認證頁面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">login_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">register_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">forgot_password_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">home</span><span class="o">/</span><span class="w">         </span><span class="c1"># 首頁相關</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">home_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">dashboard_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">profile</span><span class="o">/</span><span class="w">      </span><span class="c1"># 個人資料頁面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">profile_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">edit_profile_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">settings_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">product</span><span class="o">/</span><span class="w">      </span><span class="c1"># 產品頁面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">product_list_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">product_detail_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">product_search_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">common</span><span class="o">/</span><span class="w">       </span><span class="c1"># 通用頁面</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">splash_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">onboarding_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">error_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">no_internet_page</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">widgets</span><span class="o">/</span><span class="w">          </span><span class="c1"># 可重用 Widget</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">common</span><span class="o">/</span><span class="w">       </span><span class="c1"># 通用 Widget</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_button</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_text_field</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_card</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_loading</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_error</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">app_empty_state</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">app_image</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">forms</span><span class="o">/</span><span class="w">        </span><span class="c1"># 表單相關 Widget</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">login_form</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">register_form</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">profile_form</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">lists</span><span class="o">/</span><span class="w">        </span><span class="c1"># 列表相關 Widget</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">product_list_item</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_list_item</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">infinite_scroll_list</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">dialogs</span><span class="o">/</span><span class="w">      </span><span class="c1"># 對話框 Widget</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">confirmation_dialog</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">loading_dialog</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">info_dialog</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">providers</span><span class="o">/</span><span class="w">        </span><span class="c1"># 狀態管理 (使用 Provider)</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_provider</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">user_provider</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">product_provider</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">theme_provider</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">blocs</span><span class="o">/</span><span class="w">            </span><span class="c1"># 狀態管理 (使用 Bloc，可選)</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_bloc</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">auth_event</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">auth_state</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">product</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">product_bloc</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">product_event</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">product_state</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">routes</span><span class="o">/</span><span class="w">           </span><span class="c1"># 路由管理</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">app_router</span><span class="o">.</span><span class="n">dart</span><span class="w">          </span><span class="c1"># 主路由配置</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">route_names</span><span class="o">.</span><span class="n">dart</span><span class="w">         </span><span class="c1"># 路由名稱常數</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">route_guards</span><span class="o">.</span><span class="n">dart</span><span class="w">        </span><span class="c1"># 路由守衛</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">l10n</span><span class="o">/</span><span class="w">                 </span><span class="c1"># 國際化</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">app_localizations</span><span class="o">.</span><span class="n">dart</span><span class="w">      </span><span class="c1"># 本地化主檔案</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">app_localizations_en</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 英文</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">app_localizations_zh</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 中文</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">l10n</span><span class="o">.</span><span class="n">yaml</span><span class="w">                   </span><span class="c1"># 配置檔案</span>
<span class="err">├──</span><span class="w"> </span><span class="n">test</span><span class="o">/</span><span class="w">                     </span><span class="c1"># 測試檔案</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">unit</span><span class="o">/</span><span class="w">                 </span><span class="c1"># 單元測試</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">domain</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">usecases</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">data</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">repositories</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">presentation</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">providers</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">widget</span><span class="o">/</span><span class="w">               </span><span class="c1"># Widget 測試</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">pages</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">widgets</span><span class="o">/</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">integration</span><span class="o">/</span><span class="w">          </span><span class="c1"># 整合測試</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">helpers</span><span class="o">/</span><span class="w">              </span><span class="c1"># 測試輔助工具</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">test_helper</span><span class="o">.</span><span class="n">dart</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">mock_data</span><span class="o">.</span><span class="n">dart</span>
<span class="err">├──</span><span class="w"> </span><span class="k">tool</span><span class="o">/</span><span class="w">                     </span><span class="c1"># 開發工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">build_runner</span><span class="o">.</span><span class="n">dart</span><span class="w">     </span><span class="c1"># 程式碼生成工具</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">env_generator</span><span class="o">.</span><span class="n">dart</span><span class="w">    </span><span class="c1"># 環境檔案生成器</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">icon_generator</span><span class="o">.</span><span class="n">dart</span><span class="w">   </span><span class="c1"># 圖標生成器</span>
<span class="err">├──</span><span class="w"> </span><span class="n">docs</span><span class="o">/</span><span class="w">                     </span><span class="c1"># 專案文檔</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">README</span><span class="o">.</span><span class="n">md</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">CHANGELOG</span><span class="o">.</span><span class="n">md</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">API</span><span class="o">.</span><span class="n">md</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">DEPLOYMENT</span><span class="o">.</span><span class="n">md</span>
<span class="err">├──</span><span class="w"> </span><span class="n">scripts</span><span class="o">/</span><span class="w">                  </span><span class="c1"># 建置腳本</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">build_android</span><span class="o">.</span><span class="n">sh</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="n">build_ios</span><span class="o">.</span><span class="n">sh</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">deploy</span><span class="o">.</span><span class="n">sh</span>
<span class="err">├──</span><span class="w"> </span><span class="o">.</span><span class="n">github</span><span class="o">/</span><span class="w">                  </span><span class="c1"># GitHub 工作流程</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="n">workflows</span><span class="o">/</span>
<span class="err">│</span><span class="w">       </span><span class="err">├──</span><span class="w"> </span><span class="n">ci</span><span class="o">.</span><span class="n">yml</span>
<span class="err">│</span><span class="w">       </span><span class="err">└──</span><span class="w"> </span><span class="n">cd</span><span class="o">.</span><span class="n">yml</span>
<span class="err">├──</span><span class="w"> </span><span class="n">pubspec</span><span class="o">.</span><span class="n">yaml</span><span class="w">             </span><span class="c1"># 套件依賴配置</span>
<span class="err">├──</span><span class="w"> </span><span class="n">pubspec</span><span class="o">.</span><span class="n">lock</span><span class="w">             </span><span class="c1"># 鎖定的套件版本</span>
<span class="err">├──</span><span class="w"> </span><span class="n">analysis_options</span><span class="o">.</span><span class="n">yaml</span><span class="w">    </span><span class="c1"># 程式碼分析配置</span>
<span class="err">├──</span><span class="w"> </span><span class="o">.</span><span class="n">gitignore</span><span class="w">              </span><span class="c1"># Git 忽略檔案</span>
<span class="err">├──</span><span class="w"> </span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">example</span><span class="w">            </span><span class="c1"># 環境變數範例</span>
<span class="err">├──</span><span class="w"> </span><span class="o">.</span><span class="n">metadata</span><span class="w">               </span><span class="c1"># Flutter 專案元資料</span>
<span class="err">└──</span><span class="w"> </span><span class="n">README</span><span class="o">.</span><span class="n">md</span><span class="w">               </span><span class="c1"># 專案說明</span>
</code></pre></div>

<hr />
<h2>🏛️ MVVM 架構模式實作</h2>
<h3>MVVM 架構層次</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 📊 Model Layer (資料層)</span>
<span class="c1">// 位置: lib/data/ 和 lib/domain/</span>

<span class="c1">// 1. Entity (業務實體) - domain/entities/</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">User</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">DateTime</span><span class="o">?</span><span class="w"> </span><span class="n">lastLoginAt</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserStatus</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">User</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">lastLoginAt</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// 業務邏輯方法</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isActive</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">active</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isNewUser</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">lastLoginAt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">displayName</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">email</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">).</span><span class="n">first</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 複製方法 (用於不可變物件)</span>
<span class="w">  </span><span class="n">User</span><span class="w"> </span><span class="n">copyWith</span><span class="p">({</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">    </span><span class="n">DateTime</span><span class="o">?</span><span class="w"> </span><span class="n">lastLoginAt</span><span class="p">,</span>
<span class="w">    </span><span class="n">UserStatus</span><span class="o">?</span><span class="w"> </span><span class="n">status</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">User</span><span class="p">(</span>
<span class="w">      </span><span class="nl">id:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">      </span><span class="nl">email:</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">      </span><span class="nl">lastLoginAt:</span><span class="w"> </span><span class="n">lastLoginAt</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">lastLoginAt</span><span class="p">,</span>
<span class="w">      </span><span class="nl">status:</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">operator</span><span class="w"> </span><span class="o">==</span><span class="p">(</span><span class="kt">Object</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="n">identical</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">      </span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">runtimeType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">runtimeType</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">hashCode</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">id</span><span class="p">.</span><span class="n">hashCode</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">enum</span><span class="w"> </span><span class="n">UserStatus</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">active</span><span class="p">,</span><span class="w"> </span><span class="n">inactive</span><span class="p">,</span><span class="w"> </span><span class="n">banned</span><span class="p">,</span><span class="w"> </span><span class="n">pending</span><span class="w"> </span><span class="p">}</span>

<span class="c1">// 2. Data Model (資料傳輸物件) - data/models/</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">lastLoginAt</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserResponse</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">lastLoginAt</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// JSON 序列化</span>
<span class="w">  </span><span class="kd">factory</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">(</span>
<span class="w">      </span><span class="nl">id:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">      </span><span class="nl">email:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">      </span><span class="nl">lastLoginAt:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;last_login_at&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="p">,</span>
<span class="w">      </span><span class="nl">status:</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">toJson</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;name&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;last_login_at&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">lastLoginAt</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;status&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">status</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 轉換為業務實體</span>
<span class="w">  </span><span class="n">User</span><span class="w"> </span><span class="n">toEntity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">User</span><span class="p">(</span>
<span class="w">      </span><span class="nl">id:</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">      </span><span class="nl">email:</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">      </span><span class="nl">lastLoginAt:</span><span class="w"> </span><span class="n">lastLoginAt</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span>
<span class="w">          </span><span class="o">?</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">lastLoginAt</span><span class="o">!</span><span class="p">)</span><span class="w"> </span>
<span class="w">          </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nl">status:</span><span class="w"> </span><span class="n">_parseStatus</span><span class="p">(</span><span class="n">status</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">UserStatus</span><span class="w"> </span><span class="n">_parseStatus</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">active</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;inactive&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">inactive</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;banned&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">banned</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;pending&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">pending</span><span class="p">;</span>
<span class="w">      </span><span class="k">default</span><span class="o">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">inactive</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 3. Repository Interface (抽象儲存庫) - domain/repositories/</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">?&gt;</span><span class="w"> </span><span class="n">getUserById</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">getUsers</span><span class="p">({</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">});</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updateUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deleteUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">searchUsers</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">query</span><span class="p">);</span>
<span class="w">  </span><span class="n">Stream</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getUserStream</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 4. Repository Implementation (儲存庫實作) - data/repositories/</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserRepositoryImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRemoteDataSource</span><span class="w"> </span><span class="n">_remoteDataSource</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserLocalDataSource</span><span class="w"> </span><span class="n">_localDataSource</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">NetworkInfo</span><span class="w"> </span><span class="n">_networkInfo</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserRepositoryImpl</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">UserRemoteDataSource</span><span class="w"> </span><span class="n">remoteDataSource</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">UserLocalDataSource</span><span class="w"> </span><span class="n">localDataSource</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">NetworkInfo</span><span class="w"> </span><span class="n">networkInfo</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_remoteDataSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">remoteDataSource</span><span class="p">,</span>
<span class="w">       </span><span class="n">_localDataSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localDataSource</span><span class="p">,</span>
<span class="w">       </span><span class="n">_networkInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">networkInfo</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">?&gt;</span><span class="w"> </span><span class="n">getUserById</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 先從本地快取取得</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">localUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_localDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kd">await</span><span class="w"> </span><span class="n">_networkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 有網路時從遠端更新</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">remoteUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_remoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">remoteUser</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// 更新本地快取</span>
<span class="w">          </span><span class="kd">await</span><span class="w"> </span><span class="n">_localDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">remoteUser</span><span class="p">);</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">remoteUser</span><span class="p">.</span><span class="n">toEntity</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">localUser</span><span class="o">?</span><span class="p">.</span><span class="n">toEntity</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">UserException</span><span class="p">(</span><span class="s1">&#39;無法取得使用者資料: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">getUsers</span><span class="p">({</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kd">await</span><span class="w"> </span><span class="n">_networkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">remoteUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_remoteDataSource</span><span class="p">.</span><span class="n">getUsers</span><span class="p">(</span>
<span class="w">          </span><span class="nl">page:</span><span class="w"> </span><span class="n">page</span><span class="p">,</span>
<span class="w">          </span><span class="nl">limit:</span><span class="w"> </span><span class="n">limit</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 快取資料</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">_localDataSource</span><span class="p">.</span><span class="n">cacheUsers</span><span class="p">(</span><span class="n">remoteUsers</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">remoteUsers</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">toEntity</span><span class="p">()).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 離線時從本地取得</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">localUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_localDataSource</span><span class="p">.</span><span class="n">getCachedUsers</span><span class="p">(</span>
<span class="w">          </span><span class="nl">page:</span><span class="w"> </span><span class="n">page</span><span class="p">,</span>
<span class="w">          </span><span class="nl">limit:</span><span class="w"> </span><span class="n">limit</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">localUsers</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">toEntity</span><span class="p">()).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">UserException</span><span class="p">(</span><span class="s1">&#39;無法取得使用者列表: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="kd">await</span><span class="w"> </span><span class="n">_networkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">NetworkException</span><span class="p">(</span><span class="s1">&#39;建立使用者需要網路連線&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">userResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">(</span>
<span class="w">        </span><span class="nl">id:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="nl">lastLoginAt:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">lastLoginAt</span><span class="o">?</span><span class="p">.</span><span class="n">toIso8601String</span><span class="p">(),</span>
<span class="w">        </span><span class="nl">status:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">status</span><span class="p">.</span><span class="n">toString</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">).</span><span class="n">last</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">createdUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_remoteDataSource</span><span class="p">.</span><span class="n">createUser</span><span class="p">(</span><span class="n">userResponse</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 快取新建立的使用者</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_localDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">createdUser</span><span class="p">);</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">createdUser</span><span class="p">.</span><span class="n">toEntity</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">UserException</span><span class="p">(</span><span class="s1">&#39;建立使用者失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 其他方法實作...</span>
<span class="p">}</span>
</code></pre></div>

<h3>ViewModel Layer (表現邏輯層)</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 📱 ViewModel (使用 ChangeNotifier)</span>
<span class="c1">// 位置: lib/presentation/providers/</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">UserViewModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ChangeNotifier</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span><span class="w"> </span><span class="n">_getUserProfileUseCase</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UpdateUserProfileUseCase</span><span class="w"> </span><span class="n">_updateUserProfileUseCase</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">DeleteUserAccountUseCase</span><span class="w"> </span><span class="n">_deleteUserAccountUseCase</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserViewModel</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span><span class="w"> </span><span class="n">getUserProfileUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">UpdateUserProfileUseCase</span><span class="w"> </span><span class="n">updateUserProfileUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">DeleteUserAccountUseCase</span><span class="w"> </span><span class="n">deleteUserAccountUseCase</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_getUserProfileUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserProfileUseCase</span><span class="p">,</span>
<span class="w">       </span><span class="n">_updateUserProfileUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updateUserProfileUseCase</span><span class="p">,</span>
<span class="w">       </span><span class="n">_deleteUserAccountUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deleteUserAccountUseCase</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 狀態變數</span>
<span class="w">  </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">_user</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">_errorMessage</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isUpdating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Getters (暴露給 View)</span>
<span class="w">  </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_user</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_isLoading</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_errorMessage</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isUpdating</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_isUpdating</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">hasUser</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_user</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// 業務邏輯方法</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">loadUserProfile</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_setLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">_clearError</span><span class="p">();</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_getUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>
<span class="w">      </span><span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">        </span><span class="p">(</span><span class="n">failure</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_setError</span><span class="p">(</span><span class="n">failure</span><span class="p">.</span><span class="n">message</span><span class="p">),</span>
<span class="w">        </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_setUser</span><span class="p">(</span><span class="n">user</span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_setError</span><span class="p">(</span><span class="s1">&#39;載入使用者資料失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_setLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updateProfile</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_user</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="n">_setUpdating</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">_clearError</span><span class="p">();</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">updatedUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_user</span><span class="o">!</span><span class="p">.</span><span class="n">copyWith</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nl">email:</span><span class="w"> </span><span class="n">email</span><span class="p">);</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_updateUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>

<span class="w">      </span><span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">        </span><span class="p">(</span><span class="n">failure</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_setError</span><span class="p">(</span><span class="n">failure</span><span class="p">.</span><span class="n">message</span><span class="p">),</span>
<span class="w">        </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">_setUser</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
<span class="w">          </span><span class="n">_showSuccessMessage</span><span class="p">(</span><span class="s1">&#39;個人資料更新成功&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_setError</span><span class="p">(</span><span class="s1">&#39;更新個人資料失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_setUpdating</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deleteAccount</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_user</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">    </span><span class="n">_setLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">_clearError</span><span class="p">();</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_deleteUserAccountUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">_user</span><span class="o">!</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">        </span><span class="p">(</span><span class="n">failure</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">_setError</span><span class="p">(</span><span class="n">failure</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">_clearUser</span><span class="p">();</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_setError</span><span class="p">(</span><span class="s1">&#39;刪除帳號失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_setLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 重新載入資料</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">refresh</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_user</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">_user</span><span class="o">!</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 清除錯誤訊息</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">clearError</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_clearError</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 私有方法 (狀態管理)</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_setUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_clearUser</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_setLoading</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">loading</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loading</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_setUpdating</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">updating</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_isUpdating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updating</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_setError</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_clearError</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_showSuccessMessage</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 可以通過事件系統或其他方式通知 UI 顯示成功訊息</span>
<span class="w">    </span><span class="c1">// 這裡可以使用 EventBus 或其他通知機制</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 清理資源</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 使用 Riverpod 的 ViewModel 實作 (可選)</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserNotifier</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StateNotifier</span><span class="o">&lt;</span><span class="n">UserState</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span><span class="w"> </span><span class="n">_getUserProfileUseCase</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UpdateUserProfileUseCase</span><span class="w"> </span><span class="n">_updateUserProfileUseCase</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserNotifier</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span><span class="w"> </span><span class="n">getUserProfileUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">UpdateUserProfileUseCase</span><span class="w"> </span><span class="n">updateUserProfileUseCase</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_getUserProfileUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUserProfileUseCase</span><span class="p">,</span>
<span class="w">       </span><span class="n">_updateUserProfileUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updateUserProfileUseCase</span><span class="p">,</span>
<span class="w">       </span><span class="k">super</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">initial</span><span class="p">());</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">loadUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">loading</span><span class="p">();</span>

<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_getUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>
<span class="w">    </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">      </span><span class="p">(</span><span class="n">failure</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">failure</span><span class="p">.</span><span class="n">message</span><span class="p">),</span>
<span class="w">      </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">loaded</span><span class="p">(</span><span class="n">user</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updateUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">copyWith</span><span class="p">(</span><span class="nl">isUpdating:</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_updateUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
<span class="w">    </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">      </span><span class="p">(</span><span class="n">failure</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">copyWith</span><span class="p">(</span>
<span class="w">        </span><span class="nl">isUpdating:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nl">errorMessage:</span><span class="w"> </span><span class="n">failure</span><span class="p">.</span><span class="n">message</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="p">(</span><span class="n">updatedUser</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">loaded</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 狀態類別 (用於 Riverpod)</span>
<span class="nd">@freezed</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UserState</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="n">_$UserState</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kd">factory</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">initial</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Initial</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kd">factory</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">loading</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Loading</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kd">factory</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">loaded</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Loaded</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kd">factory</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Error</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kd">factory</span><span class="w"> </span><span class="n">UserState</span><span class="p">.</span><span class="n">custom</span><span class="p">({</span>
<span class="w">    </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">user</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@Default</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@Default</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isUpdating</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Custom</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h3>View Layer (表現層)</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🖼️ View (UI 層)</span>
<span class="c1">// 位置: lib/presentation/pages/</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">UserProfilePage</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">UserProfilePage</span><span class="p">({</span>
<span class="w">    </span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">userId</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">State</span><span class="o">&lt;</span><span class="n">UserProfilePage</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_UserProfilePageState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_UserProfilePageState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">UserProfilePage</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">UserViewModel</span><span class="w"> </span><span class="n">_viewModel</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// 從依賴注入容器取得 ViewModel</span>
<span class="w">    </span><span class="n">_viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 載入使用者資料</span>
<span class="w">    </span><span class="n">WidgetsBinding</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">addPostFrameCallback</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_viewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">userId</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;個人資料&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">refresh</span><span class="p">),</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_handleRefresh</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">PopupMenuButton</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onSelected:</span><span class="w"> </span><span class="n">_handleMenuAction</span><span class="p">,</span>
<span class="w">            </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="n">PopupMenuItem</span><span class="p">(</span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;edit&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;編輯&#39;</span><span class="p">)),</span>
<span class="w">              </span><span class="n">PopupMenuItem</span><span class="p">(</span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;delete&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;刪除帳號&#39;</span><span class="p">)),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">ChangeNotifierProvider</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">        </span><span class="nl">value:</span><span class="w"> </span><span class="n">_viewModel</span><span class="p">,</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">viewModel</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_buildBody</span><span class="p">(</span><span class="n">viewModel</span><span class="p">);</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildBody</span><span class="p">(</span><span class="n">UserViewModel</span><span class="w"> </span><span class="n">viewModel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">viewModel</span><span class="p">.</span><span class="n">hasUser</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">_buildLoadingState</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">viewModel</span><span class="p">.</span><span class="n">hasUser</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">_buildErrorState</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="o">!</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">hasUser</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">_buildUserProfile</span><span class="p">(</span><span class="n">viewModel</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">_buildEmptyState</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildLoadingState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">CircularProgressIndicator</span><span class="p">(),</span>
<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">          </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;載入使用者資料中...&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildErrorState</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">              </span><span class="n">Icons</span><span class="p">.</span><span class="n">error_outline</span><span class="p">,</span>
<span class="w">              </span><span class="nl">size:</span><span class="w"> </span><span class="m">64</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;載入失敗&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="n">error</span><span class="p">,</span>
<span class="w">              </span><span class="nl">textAlign:</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">600</span><span class="p">]),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_viewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">widget</span><span class="p">.</span><span class="n">userId</span><span class="p">),</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;重新載入&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildEmptyState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">        </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">            </span><span class="n">Icons</span><span class="p">.</span><span class="n">person_outline</span><span class="p">,</span>
<span class="w">            </span><span class="nl">size:</span><span class="w"> </span><span class="m">64</span><span class="p">,</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">          </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;未找到使用者資料&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildUserProfile</span><span class="p">(</span><span class="n">UserViewModel</span><span class="w"> </span><span class="n">viewModel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="o">!</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">RefreshIndicator</span><span class="p">(</span>
<span class="w">      </span><span class="nl">onRefresh:</span><span class="w"> </span><span class="n">_handleRefresh</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">SingleChildScrollView</span><span class="p">(</span>
<span class="w">        </span><span class="nl">physics:</span><span class="w"> </span><span class="n">AlwaysScrollableScrollPhysics</span><span class="p">(),</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="c1">// 錯誤訊息顯示</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">              </span><span class="n">_buildErrorBanner</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="o">!</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 使用者頭像和基本資訊</span>
<span class="w">            </span><span class="n">_buildUserHeader</span><span class="p">(</span><span class="n">user</span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 使用者詳細資訊</span>
<span class="w">            </span><span class="n">_buildUserDetails</span><span class="p">(</span><span class="n">user</span><span class="p">),</span>

<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 操作按鈕</span>
<span class="w">            </span><span class="n">_buildActionButtons</span><span class="p">(</span><span class="n">viewModel</span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildErrorBanner</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">width:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">,</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">      </span><span class="nl">margin:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">only</span><span class="p">(</span><span class="nl">bottom:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">      </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">        </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">8</span><span class="p">),</span>
<span class="w">        </span><span class="nl">border:</span><span class="w"> </span><span class="n">Border</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">300</span><span class="p">]</span><span class="o">!</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">700</span><span class="p">]),</span>
<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">width:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="n">error</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">700</span><span class="p">]),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">close</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">700</span><span class="p">]),</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">_viewModel</span><span class="p">.</span><span class="n">clearError</span><span class="p">,</span>
<span class="w">            </span><span class="nl">constraints:</span><span class="w"> </span><span class="n">BoxConstraints</span><span class="p">(</span><span class="nl">minWidth:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="nl">minHeight:</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">zero</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildUserHeader</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="c1">// 頭像</span>
<span class="w">            </span><span class="n">CircleAvatar</span><span class="p">(</span>
<span class="w">              </span><span class="nl">radius:</span><span class="w"> </span><span class="m">40</span><span class="p">,</span>
<span class="w">              </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[</span><span class="m">100</span><span class="p">],</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">user</span><span class="p">.</span><span class="n">displayName</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">toUpperCase</span><span class="p">(),</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">32</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">[</span><span class="m">700</span><span class="p">],</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">width:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="c1">// 基本資訊</span>
<span class="w">            </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">user</span><span class="p">.</span><span class="n">displayName</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">                  </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">600</span><span class="p">],</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>

<span class="w">                  </span><span class="c1">// 狀態標籤</span>
<span class="w">                  </span><span class="n">_buildStatusChip</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">status</span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildStatusChip</span><span class="p">(</span><span class="n">UserStatus</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Color</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">;</span>
<span class="w">    </span><span class="n">Color</span><span class="w"> </span><span class="n">textColor</span><span class="p">;</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">;</span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="nl">active:</span>
<span class="w">        </span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">[</span><span class="m">100</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">textColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">[</span><span class="m">700</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;活躍&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="nl">inactive:</span>
<span class="w">        </span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">100</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">textColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">700</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;非活躍&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="nl">banned:</span>
<span class="w">        </span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">100</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">textColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">[</span><span class="m">700</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;已封鎖&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="nl">pending:</span>
<span class="w">        </span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">[</span><span class="m">100</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">textColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">orange</span><span class="p">[</span><span class="m">700</span><span class="p">]</span><span class="o">!</span><span class="p">;</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;等待中&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">horizontal:</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="nl">vertical:</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="nl">decoration:</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">        </span><span class="nl">color:</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">,</span>
<span class="w">        </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">12</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="p">,</span>
<span class="w">        </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">textColor</span><span class="p">,</span>
<span class="w">          </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">12</span><span class="p">,</span>
<span class="w">          </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">w500</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildUserDetails</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Card</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">start</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;詳細資訊&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>

<span class="w">            </span><span class="n">_buildDetailItem</span><span class="p">(</span>
<span class="w">              </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">,</span>
<span class="w">              </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;使用者 ID&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">_buildDetailItem</span><span class="p">(</span>
<span class="w">              </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">              </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;電子郵件&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">_buildDetailItem</span><span class="p">(</span>
<span class="w">              </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">access_time</span><span class="p">,</span>
<span class="w">              </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;最後登入&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">lastLoginAt</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                  </span><span class="o">?</span><span class="w"> </span><span class="n">_formatDateTime</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">lastLoginAt</span><span class="o">!</span><span class="p">)</span>
<span class="w">                  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;從未登入&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="n">_buildDetailItem</span><span class="p">(</span>
<span class="w">              </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">info</span><span class="p">,</span>
<span class="w">              </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;帳號狀態&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">isActive</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;正常&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;非活躍&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">isNewUser</span><span class="p">)</span>
<span class="w">              </span><span class="n">_buildDetailItem</span><span class="p">(</span>
<span class="w">                </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="n">new_releases</span><span class="p">,</span>
<span class="w">                </span><span class="nl">label:</span><span class="w"> </span><span class="s1">&#39;帳號類型&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">value:</span><span class="w"> </span><span class="s1">&#39;新使用者&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildDetailItem</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">IconData</span><span class="w"> </span><span class="n">icon</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">label</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">value</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">      </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">only</span><span class="p">(</span><span class="nl">bottom:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<span class="w">        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">Icon</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">600</span><span class="p">]),</span>
<span class="w">          </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">width:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">flex:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="n">label</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">w500</span><span class="p">,</span>
<span class="w">                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">700</span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">            </span><span class="nl">flex:</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="n">value</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">w400</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildActionButtons</span><span class="p">(</span><span class="n">UserViewModel</span><span class="w"> </span><span class="n">viewModel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">      </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">stretch</span><span class="p">,</span>
<span class="w">      </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">icon</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">isUpdating</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_handleEditProfile</span><span class="p">,</span>
<span class="w">          </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">edit</span><span class="p">),</span>
<span class="w">          </span><span class="nl">label:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;編輯個人資料&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>

<span class="w">        </span><span class="n">OutlinedButton</span><span class="p">.</span><span class="n">icon</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_handleChangePassword</span><span class="p">,</span>
<span class="w">          </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">lock</span><span class="p">),</span>
<span class="w">          </span><span class="nl">label:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;更改密碼&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">OutlinedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>

<span class="w">        </span><span class="n">TextButton</span><span class="p">.</span><span class="n">icon</span><span class="p">(</span>
<span class="w">          </span><span class="nl">onPressed:</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_handleDeleteAccount</span><span class="p">,</span>
<span class="w">          </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">delete</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">          </span><span class="nl">label:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;刪除帳號&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">symmetric</span><span class="p">(</span><span class="nl">vertical:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 載入指示器</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isUpdating</span><span class="p">)</span>
<span class="w">          </span><span class="n">Padding</span><span class="p">(</span>
<span class="w">            </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">only</span><span class="p">(</span><span class="nl">top:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">width:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">child:</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">(</span><span class="nl">strokeWidth:</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">                  </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="s1">&#39;更新中...&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">[</span><span class="m">600</span><span class="p">]),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 事件處理方法</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_handleRefresh</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">_viewModel</span><span class="p">.</span><span class="n">refresh</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_handleMenuAction</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;edit&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="n">_handleEditProfile</span><span class="p">();</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;delete&#39;</span><span class="o">:</span>
<span class="w">        </span><span class="n">_handleDeleteAccount</span><span class="p">();</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_handleEditProfile</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_viewModel</span><span class="p">.</span><span class="n">user</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="n">Navigator</span><span class="p">.</span><span class="n">push</span><span class="p">(</span>
<span class="w">      </span><span class="n">context</span><span class="p">,</span>
<span class="w">      </span><span class="n">MaterialPageRoute</span><span class="p">(</span>
<span class="w">        </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">EditProfilePage</span><span class="p">(</span><span class="nl">user:</span><span class="w"> </span><span class="n">_viewModel</span><span class="p">.</span><span class="n">user</span><span class="o">!</span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">).</span><span class="n">then</span><span class="p">((</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 如果編輯成功，重新載入資料</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_viewModel</span><span class="p">.</span><span class="n">refresh</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_handleChangePassword</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Navigator</span><span class="p">.</span><span class="n">push</span><span class="p">(</span>
<span class="w">      </span><span class="n">context</span><span class="p">,</span>
<span class="w">      </span><span class="n">MaterialPageRoute</span><span class="p">(</span>
<span class="w">        </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ChangePasswordPage</span><span class="p">(),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_handleDeleteAccount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">showDialog</span><span class="p">(</span>
<span class="w">      </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<span class="w">      </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AlertDialog</span><span class="p">(</span>
<span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;刪除帳號&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;確定要刪除此帳號嗎？此操作無法復原。&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">),</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;取消&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="n">TextButton</span><span class="p">(</span>
<span class="w">            </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">              </span><span class="kd">final</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_viewModel</span><span class="p">.</span><span class="n">deleteAccount</span><span class="p">();</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_showSuccessSnackBar</span><span class="p">(</span><span class="s1">&#39;帳號已成功刪除&#39;</span><span class="p">);</span>
<span class="w">                </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span><span class="w"> </span><span class="c1">// 返回上一頁</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;刪除&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">_showSuccessSnackBar</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<span class="w">      </span><span class="n">SnackBar</span><span class="p">(</span>
<span class="w">        </span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">message</span><span class="p">),</span>
<span class="w">        </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">green</span><span class="p">,</span>
<span class="w">        </span><span class="nl">behavior:</span><span class="w"> </span><span class="n">SnackBarBehavior</span><span class="p">.</span><span class="n">floating</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">_formatDateTime</span><span class="p">(</span><span class="n">DateTime</span><span class="w"> </span><span class="n">dateTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">();</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">now</span><span class="p">.</span><span class="n">difference</span><span class="p">(</span><span class="n">dateTime</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">difference</span><span class="p">.</span><span class="n">inDays</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">difference</span><span class="p">.</span><span class="n">inDays</span><span class="si">}</span><span class="s1"> 天前&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">difference</span><span class="p">.</span><span class="n">inHours</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">difference</span><span class="p">.</span><span class="n">inHours</span><span class="si">}</span><span class="s1"> 小時前&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">difference</span><span class="p">.</span><span class="n">inMinutes</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">difference</span><span class="p">.</span><span class="n">inMinutes</span><span class="si">}</span><span class="s1"> 分鐘前&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;剛剛&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 清理資源</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔄 UseCase 層 (業務邏輯)</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// 📋 UseCase (用例層)</span>
<span class="c1">// 位置: lib/domain/usecases/</span>

<span class="c1">// 基礎 UseCase 抽象類別</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UseCase</span><span class="o">&lt;</span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="n">Params</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Either</span><span class="o">&lt;</span><span class="n">Failure</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="n">Params</span><span class="w"> </span><span class="n">params</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UseCaseNoParams</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Either</span><span class="o">&lt;</span><span class="n">Failure</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">execute</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// 取得使用者個人資料用例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">GetUserProfileUseCase</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UseCase</span><span class="o">&lt;</span><span class="n">User</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">_repository</span><span class="p">;</span>

<span class="w">  </span><span class="n">GetUserProfileUseCase</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_repository</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Either</span><span class="o">&lt;</span><span class="n">Failure</span><span class="p">,</span><span class="w"> </span><span class="n">User</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 驗證輸入參數</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userId</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">(</span><span class="s1">&#39;使用者 ID 不能為空&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 呼叫儲存庫</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">NotFoundFailure</span><span class="p">(</span><span class="s1">&#39;找不到指定的使用者&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ServerFailure</span><span class="p">(</span><span class="s1">&#39;取得使用者資料失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 更新使用者個人資料用例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UpdateUserProfileUseCase</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UseCase</span><span class="o">&lt;</span><span class="n">User</span><span class="p">,</span><span class="w"> </span><span class="n">UpdateUserParams</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">_repository</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ValidationService</span><span class="w"> </span><span class="n">_validationService</span><span class="p">;</span>

<span class="w">  </span><span class="n">UpdateUserProfileUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">_repository</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">_validationService</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Either</span><span class="o">&lt;</span><span class="n">Failure</span><span class="p">,</span><span class="w"> </span><span class="n">User</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="n">UpdateUserParams</span><span class="w"> </span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 驗證輸入資料</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">validationResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_validationService</span><span class="p">.</span><span class="n">validateUser</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">user</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">validationResult</span><span class="p">.</span><span class="n">isValid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">(</span><span class="n">validationResult</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 檢查使用者是否存在</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">existingUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">existingUser</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">NotFoundFailure</span><span class="p">(</span><span class="s1">&#39;使用者不存在&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 檢查電子郵件是否已被其他使用者使用</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">existingUser</span><span class="p">.</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">emailExists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_repository</span><span class="p">.</span><span class="n">isEmailExists</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">emailExists</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">(</span><span class="s1">&#39;此電子郵件已被使用&#39;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 執行更新</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">updatedUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_repository</span><span class="p">.</span><span class="n">updateUser</span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">user</span><span class="p">);</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ServerFailure</span><span class="p">(</span><span class="s1">&#39;更新使用者資料失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 參數類別</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">UpdateUserParams</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">;</span>

<span class="w">  </span><span class="n">UpdateUserParams</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">user</span><span class="p">});</span>
<span class="p">}</span>

<span class="c1">// 搜尋使用者用例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">SearchUsersUseCase</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UseCase</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">SearchUsersParams</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">_repository</span><span class="p">;</span>

<span class="w">  </span><span class="n">SearchUsersUseCase</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_repository</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Either</span><span class="o">&lt;</span><span class="n">Failure</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="n">SearchUsersParams</span><span class="w"> </span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 驗證搜尋查詢</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">params</span><span class="p">.</span><span class="n">query</span><span class="p">.</span><span class="n">trim</span><span class="p">().</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">(</span><span class="s1">&#39;搜尋關鍵字至少需要 2 個字元&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 執行搜尋</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_repository</span><span class="p">.</span><span class="n">searchUsers</span><span class="p">(</span>
<span class="w">        </span><span class="n">params</span><span class="p">.</span><span class="n">query</span><span class="p">,</span>
<span class="w">        </span><span class="nl">page:</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">page</span><span class="p">,</span>
<span class="w">        </span><span class="nl">limit:</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">limit</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">users</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ServerFailure</span><span class="p">(</span><span class="s1">&#39;搜尋使用者失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">SearchUsersParams</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">query</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="p">;</span>

<span class="w">  </span><span class="n">SearchUsersParams</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">query</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="c1">// 刪除使用者帳號用例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">DeleteUserAccountUseCase</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UseCase</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">_repository</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">AuthRepository</span><span class="w"> </span><span class="n">_authRepository</span><span class="p">;</span>

<span class="w">  </span><span class="n">DeleteUserAccountUseCase</span><span class="p">(</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">_repository</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">_authRepository</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Either</span><span class="o">&lt;</span><span class="n">Failure</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 檢查使用者是否存在</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">NotFoundFailure</span><span class="p">(</span><span class="s1">&#39;使用者不存在&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 檢查是否為當前登入使用者</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">currentUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_authRepository</span><span class="p">.</span><span class="n">getCurrentUser</span><span class="p">();</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentUser</span><span class="o">?</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">UnauthorizedFailure</span><span class="p">(</span><span class="s1">&#39;只能刪除自己的帳號&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// 執行刪除操作</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_repository</span><span class="p">.</span><span class="n">deleteUser</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 登出使用者</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_authRepository</span><span class="p">.</span><span class="n">logout</span><span class="p">();</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ServerFailure</span><span class="p">(</span><span class="s1">&#39;刪除帳號失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🗃️ 資料源設計</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🌐 Remote Data Source (遠端資料源)</span>
<span class="c1">// 位置: lib/data/datasources/remote/</span>

<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserRemoteDataSource</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getUserById</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">getUsers</span><span class="p">({</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">});</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createUser</span><span class="p">(</span><span class="n">UserResponse</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updateUser</span><span class="p">(</span><span class="n">UserResponse</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deleteUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">searchUsers</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">});</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isEmailExists</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">UserRemoteDataSourceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserRemoteDataSource</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ApiClient</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">_baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;/api/v1/users&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserRemoteDataSourceImpl</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="n">ApiClient</span><span class="w"> </span><span class="n">apiClient</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">_apiClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apiClient</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getUserById</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_baseUrl</span><span class="s1">/</span><span class="si">$</span><span class="n">id</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;取得使用者資料失敗: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;網路錯誤: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">getUsers</span><span class="p">({</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
<span class="w">        </span><span class="n">_baseUrl</span><span class="p">,</span>
<span class="w">        </span><span class="nl">queryParameters:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s1">&#39;page&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">page</span><span class="p">,</span>
<span class="w">          </span><span class="s1">&#39;limit&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">limit</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">];</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">jsonList</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">)).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;取得使用者列表失敗: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;網路錯誤: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createUser</span><span class="p">(</span><span class="n">UserResponse</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">.</span><span class="n">post</span><span class="p">(</span>
<span class="w">        </span><span class="n">_baseUrl</span><span class="p">,</span>
<span class="w">        </span><span class="nl">data:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">toJson</span><span class="p">(),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">201</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;建立使用者失敗: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;網路錯誤: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updateUser</span><span class="p">(</span><span class="n">UserResponse</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">.</span><span class="n">put</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_baseUrl</span><span class="s1">/</span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">data:</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">toJson</span><span class="p">(),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;更新使用者失敗: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;網路錯誤: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deleteUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_baseUrl</span><span class="s1">/</span><span class="si">$</span><span class="n">id</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">204</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;刪除使用者失敗: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;網路錯誤: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">searchUsers</span><span class="p">(</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_baseUrl</span><span class="s1">/search&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">queryParameters:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s1">&#39;q&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">query</span><span class="p">,</span>
<span class="w">          </span><span class="s1">&#39;page&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">page</span><span class="p">,</span>
<span class="w">          </span><span class="s1">&#39;limit&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">limit</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">];</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">jsonList</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">)).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;搜尋使用者失敗: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;網路錯誤: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isEmailExists</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_apiClient</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_baseUrl</span><span class="s1">/check-email&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">queryParameters:</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;email&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">email</span><span class="p">},</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;exists&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;檢查電子郵件失敗: </span><span class="si">${</span><span class="n">response</span><span class="p">.</span><span class="n">statusCode</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;網路錯誤: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 💾 Local Data Source (本地資料源)</span>
<span class="c1">// 位置: lib/data/datasources/local/</span>

<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">UserLocalDataSource</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">?&gt;</span><span class="w"> </span><span class="n">getUserById</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">getCachedUsers</span><span class="p">({</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">});</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cacheUser</span><span class="p">(</span><span class="n">UserResponse</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cacheUsers</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deleteUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clearCache</span><span class="p">();</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">searchCachedUsers</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">query</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">UserLocalDataSourceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserLocalDataSource</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">LocalStorage</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">_usersKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;cached_users&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">_userPrefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;user_&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="n">UserLocalDataSourceImpl</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="n">LocalStorage</span><span class="w"> </span><span class="n">localStorage</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">_localStorage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localStorage</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">?&gt;</span><span class="w"> </span><span class="n">getUserById</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">userData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_userPrefix</span><span class="si">$</span><span class="n">id</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userData</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">jsonData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">userData</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">jsonData</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;取得快取使用者資料失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">getCachedUsers</span><span class="p">({</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">usersData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="n">_usersKey</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">usersData</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">usersData</span><span class="p">);</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonList</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">json</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">)).</span><span class="n">toList</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 實作分頁</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">startIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">page</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">limit</span><span class="p">;</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">endIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">limit</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">startIndex</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">sublist</span><span class="p">(</span>
<span class="w">          </span><span class="n">startIndex</span><span class="p">,</span>
<span class="w">          </span><span class="n">endIndex</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">endIndex</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;取得快取使用者列表失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cacheUser</span><span class="p">(</span><span class="n">UserResponse</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 快取個別使用者</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_userPrefix</span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="n">jsonEncode</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">toJson</span><span class="p">()),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 更新使用者列表快取</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">getCachedUsers</span><span class="p">(</span><span class="nl">page:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nl">limit:</span><span class="w"> </span><span class="m">1000</span><span class="p">);</span><span class="w"> </span><span class="c1">// 取得所有快取的使用者</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">userIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">indexWhere</span><span class="p">((</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">userIndex</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">users</span><span class="p">[</span><span class="n">userIndex</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">;</span><span class="w"> </span><span class="c1">// 更新現有使用者</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">users</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">user</span><span class="p">);</span><span class="w"> </span><span class="c1">// 新增使用者</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span>
<span class="w">        </span><span class="n">_usersKey</span><span class="p">,</span>
<span class="w">        </span><span class="n">jsonEncode</span><span class="p">(</span><span class="n">users</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">toJson</span><span class="p">()).</span><span class="n">toList</span><span class="p">()),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;快取使用者資料失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cacheUsers</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 快取使用者列表</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span>
<span class="w">        </span><span class="n">_usersKey</span><span class="p">,</span>
<span class="w">        </span><span class="n">jsonEncode</span><span class="p">(</span><span class="n">users</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">toJson</span><span class="p">()).</span><span class="n">toList</span><span class="p">()),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 個別快取每個使用者</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span>
<span class="w">          </span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_userPrefix</span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="n">jsonEncode</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">toJson</span><span class="p">()),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;快取使用者列表失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deleteUser</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 刪除個別使用者快取</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">$</span><span class="n">_userPrefix</span><span class="si">$</span><span class="n">id</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 從使用者列表快取中移除</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">getCachedUsers</span><span class="p">(</span><span class="nl">page:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nl">limit:</span><span class="w"> </span><span class="m">1000</span><span class="p">);</span>
<span class="w">      </span><span class="n">users</span><span class="p">.</span><span class="n">removeWhere</span><span class="p">((</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span>
<span class="w">        </span><span class="n">_usersKey</span><span class="p">,</span>
<span class="w">        </span><span class="n">jsonEncode</span><span class="p">(</span><span class="n">users</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">toJson</span><span class="p">()).</span><span class="n">toList</span><span class="p">()),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;刪除快取使用者失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clearCache</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">_usersKey</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 刪除所有個別使用者快取</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">getKeys</span><span class="p">();</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">keys</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">startsWith</span><span class="p">(</span><span class="n">_userPrefix</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">await</span><span class="w"> </span><span class="n">_localStorage</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;清除使用者快取失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UserResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">searchCachedUsers</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">query</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">getCachedUsers</span><span class="p">(</span><span class="nl">page:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nl">limit:</span><span class="w"> </span><span class="m">1000</span><span class="p">);</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">lowerQuery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">query</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">();</span>

<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">where</span><span class="p">((</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="n">lowerQuery</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">               </span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="n">lowerQuery</span><span class="p">);</span>
<span class="w">      </span><span class="p">}).</span><span class="n">toList</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;搜尋快取使用者失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🏭 依賴注入設定</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🔧 Dependency Injection Setup</span>
<span class="c1">// 位置: lib/core/injection/injection.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:get_it/get_it.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:dio/dio.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:shared_preferences/shared_preferences.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:connectivity_plus/connectivity_plus.dart&#39;</span><span class="p">;</span>

<span class="kd">final</span><span class="w"> </span><span class="n">GetIt</span><span class="w"> </span><span class="n">getIt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetIt</span><span class="p">.</span><span class="n">instance</span><span class="p">;</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">configureDependencies</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 🔌 外部依賴 (Third-party)</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">_registerExternalDependencies</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 🏗️ 核心服務</span>
<span class="w">  </span><span class="n">_registerCoreServices</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 🗃️ 資料層</span>
<span class="w">  </span><span class="n">_registerDataLayer</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 📋 業務邏輯層</span>
<span class="w">  </span><span class="n">_registerDomainLayer</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 🎨 表現層</span>
<span class="w">  </span><span class="n">_registerPresentationLayer</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_registerExternalDependencies</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// SharedPreferences</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">sharedPreferences</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">SharedPreferences</span><span class="o">&gt;</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sharedPreferences</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Connectivity</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">Connectivity</span><span class="o">&gt;</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Connectivity</span><span class="p">());</span>

<span class="w">  </span><span class="c1">// Dio HTTP Client</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">dio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dio</span><span class="p">();</span>
<span class="w">  </span><span class="n">dio</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AppConfig</span><span class="p">.</span><span class="n">apiBaseUrl</span><span class="p">;</span>
<span class="w">  </span><span class="n">dio</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">connectTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">30</span><span class="p">);</span>
<span class="w">  </span><span class="n">dio</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">receiveTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">30</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 添加攔截器</span>
<span class="w">  </span><span class="n">dio</span><span class="p">.</span><span class="n">interceptors</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">AuthInterceptor</span><span class="p">());</span>
<span class="w">  </span><span class="n">dio</span><span class="p">.</span><span class="n">interceptors</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">LoggingInterceptor</span><span class="p">());</span>
<span class="w">  </span><span class="n">dio</span><span class="p">.</span><span class="n">interceptors</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">ErrorInterceptor</span><span class="p">());</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">Dio</span><span class="o">&gt;</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">dio</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">_registerCoreServices</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 🌐 網路相關</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">NetworkInfo</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">NetworkInfoImpl</span><span class="p">(</span><span class="nl">connectivity:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">ApiClient</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ApiClientImpl</span><span class="p">(</span><span class="nl">dio:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 💾 儲存相關</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">LocalStorage</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SharedPrefsStorage</span><span class="p">(</span><span class="nl">sharedPreferences:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">SecureStorage</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SecureStorageImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 🛡️ 安全和驗證</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">ValidationService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ValidationServiceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">EncryptionService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">EncryptionServiceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 📊 分析和日誌</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">LoggingService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">LoggingServiceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">AnalyticsService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AnalyticsServiceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">_registerDataLayer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 🌐 Remote Data Sources</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">AuthRemoteDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AuthRemoteDataSourceImpl</span><span class="p">(</span><span class="nl">apiClient:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">UserRemoteDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserRemoteDataSourceImpl</span><span class="p">(</span><span class="nl">apiClient:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">ProductRemoteDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductRemoteDataSourceImpl</span><span class="p">(</span><span class="nl">apiClient:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 💾 Local Data Sources</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">AuthLocalDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AuthLocalDataSourceImpl</span><span class="p">(</span>
<span class="w">      </span><span class="nl">localStorage:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">secureStorage:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">UserLocalDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserLocalDataSourceImpl</span><span class="p">(</span><span class="nl">localStorage:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">ProductLocalDataSource</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductLocalDataSourceImpl</span><span class="p">(</span><span class="nl">localStorage:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 🗃️ Repositories</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">AuthRepository</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AuthRepositoryImpl</span><span class="p">(</span>
<span class="w">      </span><span class="nl">remoteDataSource:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">localDataSource:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">networkInfo:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">UserRepository</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserRepositoryImpl</span><span class="p">(</span>
<span class="w">      </span><span class="nl">remoteDataSource:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">localDataSource:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">networkInfo:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">ProductRepository</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductRepositoryImpl</span><span class="p">(</span>
<span class="w">      </span><span class="nl">remoteDataSource:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">localDataSource:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">networkInfo:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">_registerDomainLayer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 🔐 Authentication Use Cases</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">LoginUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">LoginUseCase</span><span class="p">(</span>
<span class="w">      </span><span class="nl">repository:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">validationService:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">LogoutUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">LogoutUseCase</span><span class="p">(</span><span class="nl">repository:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">RegisterUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">RegisterUseCase</span><span class="p">(</span>
<span class="w">      </span><span class="nl">repository:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">validationService:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">RefreshTokenUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">RefreshTokenUseCase</span><span class="p">(</span><span class="nl">repository:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 👤 User Use Cases</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">GetUserProfileUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">UpdateUserProfileUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UpdateUserProfileUseCase</span><span class="p">(</span>
<span class="w">      </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">ValidationService</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">DeleteUserAccountUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">DeleteUserAccountUseCase</span><span class="p">(</span>
<span class="w">      </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">UserRepository</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">      </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">AuthRepository</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">SearchUsersUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SearchUsersUseCase</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 🛍️ Product Use Cases</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">GetProductsUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GetProductsUseCase</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">GetProductDetailUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GetProductDetailUseCase</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">SearchProductsUseCase</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SearchProductsUseCase</span><span class="p">(</span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">_registerPresentationLayer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 🔐 Authentication ViewModels</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerFactory</span><span class="o">&lt;</span><span class="n">AuthViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AuthViewModel</span><span class="p">(</span>
<span class="w">      </span><span class="nl">loginUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">logoutUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">registerUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">refreshTokenUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 👤 User ViewModels</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerFactory</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserViewModel</span><span class="p">(</span>
<span class="w">      </span><span class="nl">getUserProfileUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">updateUserProfileUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">deleteUserAccountUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerFactory</span><span class="o">&lt;</span><span class="n">UserListViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserListViewModel</span><span class="p">(</span>
<span class="w">      </span><span class="nl">searchUsersUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 🛍️ Product ViewModels</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerFactory</span><span class="o">&lt;</span><span class="n">ProductViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductViewModel</span><span class="p">(</span>
<span class="w">      </span><span class="nl">getProductsUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">getProductDetailUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">      </span><span class="nl">searchProductsUseCase:</span><span class="w"> </span><span class="n">getIt</span><span class="p">(),</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 🎨 UI Services</span>
<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">NavigationService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">NavigationServiceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">DialogService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">DialogServiceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">SnackBarService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SnackBarServiceImpl</span><span class="p">(),</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getIt</span><span class="p">.</span><span class="n">registerLazySingleton</span><span class="o">&lt;</span><span class="n">ThemeService</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ThemeServiceImpl</span><span class="p">(</span><span class="nl">localStorage:</span><span class="w"> </span><span class="n">getIt</span><span class="p">()),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 🧹 清理依賴 (用於測試)</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">resetDependencies</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">getIt</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔀 狀態管理策略</h2>
<h3>Provider 狀態管理實作</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🎯 多 Provider 設定</span>
<span class="c1">// 位置: lib/main.dart</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">WidgetsFlutterBinding</span><span class="p">.</span><span class="n">ensureInitialized</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// 配置依賴注入</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">configureDependencies</span><span class="p">();</span>

<span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MyApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MultiProvider</span><span class="p">(</span>
<span class="w">      </span><span class="nl">providers:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="c1">// 🔐 認證狀態</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">AuthViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">AuthViewModel</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 👤 使用者狀態</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 🛍️ 產品狀態</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">ProductViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">ProductViewModel</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 🎨 主題狀態</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">ThemeViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">ThemeViewModel</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="c1">// 🌐 應用程式狀態</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">AppViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">AppViewModel</span><span class="o">&gt;</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">ThemeViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Flutter MVVM App&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nl">theme:</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">.</span><span class="n">lightTheme</span><span class="p">,</span>
<span class="w">            </span><span class="nl">darkTheme:</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">.</span><span class="n">darkTheme</span><span class="p">,</span>
<span class="w">            </span><span class="nl">themeMode:</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">.</span><span class="n">themeMode</span><span class="p">,</span>
<span class="w">            </span><span class="nl">initialRoute:</span><span class="w"> </span><span class="n">AppRoutes</span><span class="p">.</span><span class="n">splash</span><span class="p">,</span>
<span class="w">            </span><span class="nl">onGenerateRoute:</span><span class="w"> </span><span class="n">AppRouter</span><span class="p">.</span><span class="n">generateRoute</span><span class="p">,</span>
<span class="w">            </span><span class="nl">navigatorKey:</span><span class="w"> </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">NavigationService</span><span class="o">&gt;</span><span class="p">().</span><span class="n">navigatorKey</span><span class="p">,</span>
<span class="w">            </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">AppErrorBoundary</span><span class="p">(</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">Container</span><span class="p">(),</span>
<span class="w">              </span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">          </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 🎨 主題管理 ViewModel</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ThemeViewModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ChangeNotifier</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ThemeService</span><span class="w"> </span><span class="n">_themeService</span><span class="p">;</span>

<span class="w">  </span><span class="n">ThemeViewModel</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="n">ThemeService</span><span class="w"> </span><span class="n">themeService</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">_themeService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">themeService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_loadThemeMode</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">ThemeMode</span><span class="w"> </span><span class="n">_themeMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">system</span><span class="p">;</span>
<span class="w">  </span><span class="n">ThemeData</span><span class="o">?</span><span class="w"> </span><span class="n">_customLightTheme</span><span class="p">;</span>
<span class="w">  </span><span class="n">ThemeData</span><span class="o">?</span><span class="w"> </span><span class="n">_customDarkTheme</span><span class="p">;</span>

<span class="w">  </span><span class="n">ThemeMode</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">themeMode</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_themeMode</span><span class="p">;</span>

<span class="w">  </span><span class="n">ThemeData</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">lightTheme</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_customLightTheme</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">AppTheme</span><span class="p">.</span><span class="n">lightTheme</span><span class="p">;</span>
<span class="w">  </span><span class="n">ThemeData</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">darkTheme</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_customDarkTheme</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">AppTheme</span><span class="p">.</span><span class="n">darkTheme</span><span class="p">;</span>

<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isDarkMode</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_themeMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">dark</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isSystemMode</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_themeMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">system</span><span class="p">;</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadThemeMode</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_themeMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_themeService</span><span class="p">.</span><span class="n">getThemeMode</span><span class="p">();</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">setThemeMode</span><span class="p">(</span><span class="n">ThemeMode</span><span class="w"> </span><span class="n">mode</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_themeMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">_themeService</span><span class="p">.</span><span class="n">setThemeMode</span><span class="p">(</span><span class="n">mode</span><span class="p">);</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">toggleTheme</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">newMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_themeMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">light</span><span class="w"> </span>
<span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">dark</span><span class="w"> </span>
<span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">light</span><span class="p">;</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">setThemeMode</span><span class="p">(</span><span class="n">newMode</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">setCustomTheme</span><span class="p">({</span><span class="n">ThemeData</span><span class="o">?</span><span class="w"> </span><span class="n">light</span><span class="p">,</span><span class="w"> </span><span class="n">ThemeData</span><span class="o">?</span><span class="w"> </span><span class="n">dark</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_customLightTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">light</span><span class="p">;</span>
<span class="w">    </span><span class="n">_customDarkTheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dark</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 🌐 應用程式全域狀態</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AppViewModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ChangeNotifier</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">NetworkInfo</span><span class="w"> </span><span class="n">_networkInfo</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">AnalyticsService</span><span class="w"> </span><span class="n">_analyticsService</span><span class="p">;</span>

<span class="w">  </span><span class="n">AppViewModel</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">NetworkInfo</span><span class="w"> </span><span class="n">networkInfo</span><span class="p">,</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">AnalyticsService</span><span class="w"> </span><span class="n">analyticsService</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">_networkInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">networkInfo</span><span class="p">,</span>
<span class="w">       </span><span class="n">_analyticsService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analyticsService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_initializeApp</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isInitialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">_appVersion</span><span class="p">;</span>
<span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_featureFlags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>

<span class="w">  </span><span class="c1">// Getters</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isInitialized</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_isInitialized</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isConnected</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_isConnected</span><span class="p">;</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">appVersion</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_appVersion</span><span class="p">;</span>
<span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">featureFlags</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_featureFlags</span><span class="p">;</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_initializeApp</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 載入應用程式版本</span>
<span class="w">      </span><span class="n">_appVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_getAppVersion</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 檢查網路連線</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_checkConnectivity</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 載入功能開關</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_loadFeatureFlags</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 初始化分析服務</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_analyticsService</span><span class="p">.</span><span class="n">initialize</span><span class="p">();</span>

<span class="w">      </span><span class="n">_isInitialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">      </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;應用程式初始化失敗: </span><span class="si">$</span><span class="n">error</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_checkConnectivity</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_isConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">_networkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 監聽網路狀態變化</span>
<span class="w">    </span><span class="n">_networkInfo</span><span class="p">.</span><span class="n">onConnectivityChanged</span><span class="p">.</span><span class="n">listen</span><span class="p">((</span><span class="n">isConnected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_isConnected</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">isConnected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_isConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isConnected</span><span class="p">;</span>
<span class="w">        </span><span class="n">notifyListeners</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// 記錄網路狀態變化</span>
<span class="w">        </span><span class="n">_analyticsService</span><span class="p">.</span><span class="n">logEvent</span><span class="p">(</span><span class="s1">&#39;network_status_changed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s1">&#39;is_connected&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">isConnected</span><span class="p">,</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_getAppVersion</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">packageInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">PackageInfo</span><span class="p">.</span><span class="n">fromPlatform</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">packageInfo</span><span class="p">.</span><span class="n">version</span><span class="si">}</span><span class="s1">+</span><span class="si">${</span><span class="n">packageInfo</span><span class="p">.</span><span class="n">buildNumber</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_loadFeatureFlags</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 這裡可以從遠端配置服務載入功能開關</span>
<span class="w">    </span><span class="c1">// 例如 Firebase Remote Config</span>
<span class="w">    </span><span class="n">_featureFlags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;new_user_onboarding&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;dark_mode_enabled&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;push_notifications&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;analytics_enabled&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isFeatureEnabled</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">featureName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">_featureFlags</span><span class="p">[</span><span class="n">featureName</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">updateFeatureFlag</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">featureName</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">enabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_featureFlags</span><span class="p">[</span><span class="n">featureName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">enabled</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>

<span class="w">    </span><span class="n">_analyticsService</span><span class="p">.</span><span class="n">logEvent</span><span class="p">(</span><span class="s1">&#39;feature_flag_changed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s1">&#39;feature_name&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">featureName</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;enabled&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">enabled</span><span class="p">,</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Riverpod 狀態管理實作 (替代方案)</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🎯 Riverpod Providers</span>
<span class="c1">// 位置: lib/presentation/providers/app_providers.dart</span>

<span class="c1">// 🔐 認證相關 Providers</span>
<span class="kd">final</span><span class="w"> </span><span class="n">authViewModelProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateNotifierProvider</span><span class="o">&lt;</span><span class="n">AuthNotifier</span><span class="p">,</span><span class="w"> </span><span class="n">AuthState</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AuthNotifier</span><span class="p">(</span>
<span class="w">    </span><span class="nl">loginUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">loginUseCaseProvider</span><span class="p">),</span>
<span class="w">    </span><span class="nl">logoutUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">logoutUseCaseProvider</span><span class="p">),</span>
<span class="w">    </span><span class="nl">registerUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">registerUseCaseProvider</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>

<span class="kd">final</span><span class="w"> </span><span class="n">currentUserProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Provider</span><span class="o">&lt;</span><span class="n">User</span><span class="o">?&gt;</span><span class="p">((</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">authState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">watch</span><span class="p">(</span><span class="n">authViewModelProvider</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">authState</span><span class="p">.</span><span class="n">maybeWhen</span><span class="p">(</span>
<span class="w">    </span><span class="nl">authenticated:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">,</span>
<span class="w">    </span><span class="nl">orElse:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// 👤 使用者相關 Providers</span>
<span class="kd">final</span><span class="w"> </span><span class="n">userViewModelProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateNotifierProvider</span><span class="p">.</span><span class="n">family</span><span class="o">&lt;</span><span class="n">UserNotifier</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">ref</span><span class="p">,</span><span class="w"> </span><span class="n">userId</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserNotifier</span><span class="p">(</span>
<span class="w">    </span><span class="nl">userId:</span><span class="w"> </span><span class="n">userId</span><span class="p">,</span>
<span class="w">    </span><span class="nl">getUserProfileUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">getUserProfileUseCaseProvider</span><span class="p">),</span>
<span class="w">    </span><span class="nl">updateUserProfileUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">updateUserProfileUseCaseProvider</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>

<span class="kd">final</span><span class="w"> </span><span class="n">userListViewModelProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateNotifierProvider</span><span class="o">&lt;</span><span class="n">UserListNotifier</span><span class="p">,</span><span class="w"> </span><span class="n">UserListState</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">UserListNotifier</span><span class="p">(</span>
<span class="w">    </span><span class="nl">searchUsersUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">searchUsersUseCaseProvider</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>

<span class="c1">// 🛍️ 產品相關 Providers</span>
<span class="kd">final</span><span class="w"> </span><span class="n">productListProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateNotifierProvider</span><span class="o">&lt;</span><span class="n">ProductListNotifier</span><span class="p">,</span><span class="w"> </span><span class="n">ProductListState</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductListNotifier</span><span class="p">(</span>
<span class="w">    </span><span class="nl">getProductsUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">getProductsUseCaseProvider</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>

<span class="kd">final</span><span class="w"> </span><span class="n">productDetailProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateNotifierProvider</span><span class="p">.</span><span class="n">family</span><span class="o">&lt;</span><span class="n">ProductDetailNotifier</span><span class="p">,</span><span class="w"> </span><span class="n">ProductDetailState</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">ref</span><span class="p">,</span><span class="w"> </span><span class="n">productId</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductDetailNotifier</span><span class="p">(</span>
<span class="w">    </span><span class="nl">productId:</span><span class="w"> </span><span class="n">productId</span><span class="p">,</span>
<span class="w">    </span><span class="nl">getProductDetailUseCase:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">getProductDetailUseCaseProvider</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>

<span class="c1">// 🎨 主題 Provider</span>
<span class="kd">final</span><span class="w"> </span><span class="n">themeProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateNotifierProvider</span><span class="o">&lt;</span><span class="n">ThemeNotifier</span><span class="p">,</span><span class="w"> </span><span class="n">ThemeState</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ThemeNotifier</span><span class="p">(</span>
<span class="w">    </span><span class="nl">themeService:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">themeServiceProvider</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>

<span class="c1">// 🌐 應用程式狀態 Provider</span>
<span class="kd">final</span><span class="w"> </span><span class="n">appStateProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateNotifierProvider</span><span class="o">&lt;</span><span class="n">AppStateNotifier</span><span class="p">,</span><span class="w"> </span><span class="n">AppState</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">AppStateNotifier</span><span class="p">(</span>
<span class="w">    </span><span class="nl">networkInfo:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">networkInfoProvider</span><span class="p">),</span>
<span class="w">    </span><span class="nl">analyticsService:</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">analyticsServiceProvider</span><span class="p">),</span>
<span class="w">  </span><span class="p">),</span>
<span class="p">);</span>

<span class="c1">// 使用範例</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MyRiverpodApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ConsumerWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">WidgetRef</span><span class="w"> </span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">themeState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">watch</span><span class="p">(</span><span class="n">themeProvider</span><span class="p">);</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">appState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="n">watch</span><span class="p">(</span><span class="n">appStateProvider</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">appState</span><span class="p">.</span><span class="n">isInitialized</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">        </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">          </span><span class="nl">body:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">(),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Riverpod MVVM App&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">themeState</span><span class="p">.</span><span class="n">lightTheme</span><span class="p">,</span>
<span class="w">      </span><span class="nl">darkTheme:</span><span class="w"> </span><span class="n">themeState</span><span class="p">.</span><span class="n">darkTheme</span><span class="p">,</span>
<span class="w">      </span><span class="nl">themeMode:</span><span class="w"> </span><span class="n">themeState</span><span class="p">.</span><span class="n">themeMode</span><span class="p">,</span>
<span class="w">      </span><span class="nl">initialRoute:</span><span class="w"> </span><span class="n">AppRoutes</span><span class="p">.</span><span class="n">splash</span><span class="p">,</span>
<span class="w">      </span><span class="nl">onGenerateRoute:</span><span class="w"> </span><span class="n">AppRouter</span><span class="p">.</span><span class="n">generateRoute</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🧩 錯誤處理與異常管理</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🚨 錯誤處理系統</span>
<span class="c1">// 位置: lib/core/errors/</span>

<span class="c1">// 基礎錯誤類別</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Failure</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">message</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">code</span><span class="p">,</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">originalError</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;Failure(message: </span><span class="si">$</span><span class="n">message</span><span class="s1">, code: </span><span class="si">$</span><span class="n">code</span><span class="s1">)&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 具體錯誤類型</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ServerFailure</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ServerFailure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">message:</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">originalError</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">NetworkFailure</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">NetworkFailure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">message:</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">originalError</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ValidationFailure</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ValidationFailure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">message:</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">originalError</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">AuthenticationFailure</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">AuthenticationFailure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">message:</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">originalError</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">AuthorizationFailure</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">AuthorizationFailure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">message:</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">originalError</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">NotFoundFailure</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">NotFoundFailure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">message:</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">originalError</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CacheFailure</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">CacheFailure</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="w"> </span><span class="n">originalError</span><span class="p">})</span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">message:</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">originalError</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 異常類別</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ServerException</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">statusCode</span><span class="p">;</span>

<span class="w">  </span><span class="n">ServerException</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="n">statusCode</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;ServerException: </span><span class="si">$</span><span class="n">message</span><span class="s1"> (Code: </span><span class="si">$</span><span class="n">statusCode</span><span class="s1">)&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">NetworkException</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>

<span class="w">  </span><span class="n">NetworkException</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;NetworkException: </span><span class="si">$</span><span class="n">message</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CacheException</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>

<span class="w">  </span><span class="n">CacheException</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">message</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;CacheException: </span><span class="si">$</span><span class="n">message</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">ValidationException</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">String</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">fieldErrors</span><span class="p">;</span>

<span class="w">  </span><span class="n">ValidationException</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="n">fieldErrors</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;ValidationException: </span><span class="si">$</span><span class="n">message</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 錯誤處理器</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">ErrorHandler</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="n">handleError</span><span class="p">(</span><span class="kt">dynamic</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">ServerException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ServerFailure</span><span class="p">(</span>
<span class="w">        </span><span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">,</span>
<span class="w">        </span><span class="nl">code:</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">statusCode</span><span class="p">,</span>
<span class="w">        </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">NetworkException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">NetworkFailure</span><span class="p">(</span>
<span class="w">        </span><span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">,</span>
<span class="w">        </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">CacheException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">CacheFailure</span><span class="p">(</span>
<span class="w">        </span><span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">,</span>
<span class="w">        </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">ValidationException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ValidationFailure</span><span class="p">(</span>
<span class="w">        </span><span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="p">,</span>
<span class="w">        </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">DioError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">_handleDioError</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ServerFailure</span><span class="p">(</span>
<span class="w">        </span><span class="s1">&#39;未知錯誤: </span><span class="si">${</span><span class="n">error</span><span class="p">.</span><span class="n">toString</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">originalError:</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Failure</span><span class="w"> </span><span class="n">_handleDioError</span><span class="p">(</span><span class="n">DioError</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">DioErrorType</span><span class="p">.</span><span class="nl">connectionTimeout:</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">DioErrorType</span><span class="p">.</span><span class="nl">sendTimeout:</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">DioErrorType</span><span class="p">.</span><span class="nl">receiveTimeout:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NetworkFailure</span><span class="p">(</span><span class="s1">&#39;連線逾時，請檢查網路連線&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">DioErrorType</span><span class="p">.</span><span class="nl">badResponse:</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">statusCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">response</span><span class="o">?</span><span class="p">.</span><span class="n">statusCode</span><span class="p">;</span>
<span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">response</span><span class="o">?</span><span class="p">.</span><span class="n">data</span><span class="o">?</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;伺服器錯誤&#39;</span><span class="p">;</span>

<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">statusCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="m">400</span><span class="o">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ValidationFailure</span><span class="p">(</span><span class="s1">&#39;請求參數錯誤: </span><span class="si">$</span><span class="n">message</span><span class="s1">&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="m">401</span><span class="o">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">AuthenticationFailure</span><span class="p">(</span><span class="s1">&#39;身份驗證失敗&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="m">403</span><span class="o">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">AuthorizationFailure</span><span class="p">(</span><span class="s1">&#39;權限不足&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="m">404</span><span class="o">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">NotFoundFailure</span><span class="p">(</span><span class="s1">&#39;資源未找到&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">          </span><span class="k">case</span><span class="w"> </span><span class="m">500</span><span class="o">:</span>
<span class="w">          </span><span class="k">default</span><span class="o">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ServerFailure</span><span class="p">(</span><span class="s1">&#39;伺服器錯誤: </span><span class="si">$</span><span class="n">message</span><span class="s1">&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">code:</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">DioErrorType</span><span class="p">.</span><span class="nl">cancel:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NetworkFailure</span><span class="p">(</span><span class="s1">&#39;請求已取消&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">DioErrorType</span><span class="p">.</span><span class="nl">unknown:</span>
<span class="w">      </span><span class="k">default</span><span class="o">:</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">SocketException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">NetworkFailure</span><span class="p">(</span><span class="s1">&#39;網路連線失敗，請檢查網路設定&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ServerFailure</span><span class="p">(</span><span class="s1">&#39;未知網路錯誤: </span><span class="si">${</span><span class="n">error</span><span class="p">.</span><span class="n">message</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 全域錯誤邊界 Widget</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">AppErrorBoundary</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">AppErrorBoundary</span><span class="p">({</span><span class="n">Key</span><span class="o">?</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">child</span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">key:</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AppErrorBoundary</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_AppErrorBoundaryState</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">_AppErrorBoundaryState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">AppErrorBoundary</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ErrorWidgetBuilder</span><span class="o">?</span><span class="w"> </span><span class="n">_oldErrorWidgetBuilder</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 設定全域錯誤處理</span>
<span class="w">    </span><span class="n">_oldErrorWidgetBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ErrorWidget</span><span class="p">.</span><span class="n">builder</span><span class="p">;</span>
<span class="w">    </span><span class="n">ErrorWidget</span><span class="p">.</span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FlutterErrorDetails</span><span class="w"> </span><span class="n">details</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 記錄錯誤</span>
<span class="w">      </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">LoggingService</span><span class="o">&gt;</span><span class="p">().</span><span class="n">logError</span><span class="p">(</span>
<span class="w">        </span><span class="n">details</span><span class="p">.</span><span class="n">exception</span><span class="p">,</span>
<span class="w">        </span><span class="n">details</span><span class="p">.</span><span class="n">stack</span><span class="p">,</span>
<span class="w">        </span><span class="n">details</span><span class="p">.</span><span class="n">context</span><span class="o">?</span><span class="p">.</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 回傳自訂錯誤 Widget</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">_buildErrorWidget</span><span class="p">(</span><span class="n">details</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// 設定 Flutter 錯誤處理</span>
<span class="w">    </span><span class="n">FlutterError</span><span class="p">.</span><span class="n">onError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FlutterErrorDetails</span><span class="w"> </span><span class="n">details</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">getIt</span><span class="o">&lt;</span><span class="n">LoggingService</span><span class="o">&gt;</span><span class="p">().</span><span class="n">logError</span><span class="p">(</span>
<span class="w">        </span><span class="n">details</span><span class="p">.</span><span class="n">exception</span><span class="p">,</span>
<span class="w">        </span><span class="n">details</span><span class="p">.</span><span class="n">stack</span><span class="p">,</span>
<span class="w">        </span><span class="n">details</span><span class="p">.</span><span class="n">context</span><span class="o">?</span><span class="p">.</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 在 debug 模式下顯示詳細錯誤</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kDebugMode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">FlutterError</span><span class="p">.</span><span class="n">presentError</span><span class="p">(</span><span class="n">details</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 恢復原始錯誤處理器</span>
<span class="w">    </span><span class="n">ErrorWidget</span><span class="p">.</span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_oldErrorWidgetBuilder</span><span class="o">!</span><span class="p">;</span>
<span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">_buildErrorWidget</span><span class="p">(</span><span class="n">FlutterErrorDetails</span><span class="w"> </span><span class="n">details</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Material</span><span class="p">(</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">        </span><span class="nl">padding:</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">          </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">          </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">              </span><span class="n">Icons</span><span class="p">.</span><span class="n">error_outline</span><span class="p">,</span>
<span class="w">              </span><span class="nl">size:</span><span class="w"> </span><span class="m">48</span><span class="p">,</span>
<span class="w">              </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">red</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">              </span><span class="s1">&#39;應用程式發生錯誤&#39;</span><span class="p">,</span>
<span class="w">              </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">18</span><span class="p">,</span>
<span class="w">                </span><span class="nl">fontWeight:</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">kDebugMode</span><span class="p">)</span><span class="w"> </span><span class="p">...[</span>
<span class="w">              </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">details</span><span class="p">.</span><span class="n">exception</span><span class="p">.</span><span class="n">toString</span><span class="p">(),</span>
<span class="w">                </span><span class="nl">textAlign:</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// 重新啟動應用程式</span>
<span class="w">                </span><span class="n">runApp</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;重新啟動&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">child</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2>🧪 測試基礎設定</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// 🧪 測試基礎設定</span>
<span class="c1">// 位置: test/helpers/test_helper.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:mockito/mockito.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:mockito/annotations.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:provider/provider.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:network_image_mock/network_image_mock.dart&#39;</span><span class="p">;</span>

<span class="c1">// 測試輔助工具</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">TestHelper</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Mock 資料</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">createMockUser</span><span class="p">({</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
<span class="w">    </span><span class="n">UserStatus</span><span class="o">?</span><span class="w"> </span><span class="n">status</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">User</span><span class="p">(</span>
<span class="w">      </span><span class="nl">id:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;test_user_id&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;Test User&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">email:</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;test@example.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">status:</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">active</span><span class="p">,</span>
<span class="w">      </span><span class="nl">lastLoginAt:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createMockUserList</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">createMockUser</span><span class="p">(</span>
<span class="w">      </span><span class="nl">id:</span><span class="w"> </span><span class="s1">&#39;user_</span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;User </span><span class="si">$</span><span class="n">index</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;user</span><span class="si">$</span><span class="n">index</span><span class="s1">@example.com&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">AuthToken</span><span class="w"> </span><span class="n">createMockAuthToken</span><span class="p">({</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">token</span><span class="p">,</span>
<span class="w">    </span><span class="n">DateTime</span><span class="o">?</span><span class="w"> </span><span class="n">expiresAt</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">AuthToken</span><span class="p">(</span>
<span class="w">      </span><span class="nl">accessToken:</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;mock_access_token&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">refreshToken:</span><span class="w"> </span><span class="s1">&#39;mock_refresh_token&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">tokenType:</span><span class="w"> </span><span class="s1">&#39;Bearer&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">expiresAt:</span><span class="w"> </span><span class="n">expiresAt</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">add</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">hours:</span><span class="w"> </span><span class="m">1</span><span class="p">)),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">ApiResponse</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createMockApiResponse</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">({</span>
<span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">data</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">statusCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">error</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ApiResponse</span><span class="p">.</span><span class="n">failure</span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;Mock error&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 測試用的 Widget 包裝器</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">    </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ThemeData</span><span class="o">?</span><span class="w"> </span><span class="n">theme</span><span class="p">,</span>
<span class="w">    </span><span class="n">Locale</span><span class="o">?</span><span class="w"> </span><span class="n">locale</span><span class="p">,</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Locale</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">supportedLocales</span><span class="p">,</span>
<span class="w">    </span><span class="n">NavigatorObserver</span><span class="o">?</span><span class="w"> </span><span class="n">navigatorObserver</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">theme</span><span class="p">,</span>
<span class="w">      </span><span class="nl">locale:</span><span class="w"> </span><span class="n">locale</span><span class="p">,</span>
<span class="w">      </span><span class="nl">supportedLocales:</span><span class="w"> </span><span class="n">supportedLocales</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="p">[</span><span class="n">Locale</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;US&#39;</span><span class="p">)],</span>
<span class="w">      </span><span class="nl">navigatorObservers:</span><span class="w"> </span><span class="n">navigatorObserver</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">[</span><span class="n">navigatorObserver</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span><span class="nl">body:</span><span class="w"> </span><span class="n">child</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">wrapWithProviders</span><span class="p">(</span>
<span class="w">    </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UserViewModel</span><span class="o">?</span><span class="w"> </span><span class="n">userViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">AuthViewModel</span><span class="o">?</span><span class="w"> </span><span class="n">authViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">ThemeViewModel</span><span class="o">?</span><span class="w"> </span><span class="n">themeViewModel</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MultiProvider</span><span class="p">(</span>
<span class="w">      </span><span class="nl">providers:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">userViewModel</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">MockUserViewModel</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">AuthViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">authViewModel</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">MockAuthViewModel</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">ThemeViewModel</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">          </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">themeViewModel</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="n">MockThemeViewModel</span><span class="p">(),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">wrapWithMaterialApp</span><span class="p">(</span><span class="n">child</span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Widget</span><span class="w"> </span><span class="n">wrapWithMediaQuery</span><span class="p">(</span>
<span class="w">    </span><span class="n">Widget</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">400</span><span class="p">,</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">800</span><span class="p">,</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">devicePixelRatio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span>
<span class="w">    </span><span class="n">Brightness</span><span class="w"> </span><span class="n">platformBrightness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Brightness</span><span class="p">.</span><span class="n">light</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MediaQuery</span><span class="p">(</span>
<span class="w">      </span><span class="nl">data:</span><span class="w"> </span><span class="n">MediaQueryData</span><span class="p">(</span>
<span class="w">        </span><span class="nl">size:</span><span class="w"> </span><span class="n">Size</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">),</span>
<span class="w">        </span><span class="nl">devicePixelRatio:</span><span class="w"> </span><span class="n">devicePixelRatio</span><span class="p">,</span>
<span class="w">        </span><span class="nl">platformBrightness:</span><span class="w"> </span><span class="n">platformBrightness</span><span class="p">,</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">child</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 非同步操作輔助</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pumpAndSettle</span><span class="p">(</span>
<span class="w">    </span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Duration</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span><span class="w"> </span><span class="m">10</span><span class="p">),</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">timeout</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pumpFrames</span><span class="p">(</span>
<span class="w">    </span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">frames</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Duration</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">16</span><span class="p">),</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">frames</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pump</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 手勢模擬</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tapAndSettle</span><span class="p">(</span>
<span class="w">    </span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">,</span>
<span class="w">    </span><span class="n">Finder</span><span class="w"> </span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">warnIfMissed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">tap</span><span class="p">(</span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="nl">warnIfMissed:</span><span class="w"> </span><span class="n">warnIfMissed</span><span class="p">);</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">longPressAndSettle</span><span class="p">(</span>
<span class="w">    </span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">,</span>
<span class="w">    </span><span class="n">Finder</span><span class="w"> </span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">warnIfMissed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">longPress</span><span class="p">(</span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="nl">warnIfMissed:</span><span class="w"> </span><span class="n">warnIfMissed</span><span class="p">);</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dragAndSettle</span><span class="p">(</span>
<span class="w">    </span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">,</span>
<span class="w">    </span><span class="n">Finder</span><span class="w"> </span><span class="n">finder</span><span class="p">,</span>
<span class="w">    </span><span class="n">Offset</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">warnIfMissed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">drag</span><span class="p">(</span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="nl">warnIfMissed:</span><span class="w"> </span><span class="n">warnIfMissed</span><span class="p">);</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 輸入模擬</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">enterTextAndSettle</span><span class="p">(</span>
<span class="w">    </span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">,</span>
<span class="w">    </span><span class="n">Finder</span><span class="w"> </span><span class="n">finder</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">,</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">enterText</span><span class="p">(</span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">);</span>
<span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 網路圖片模擬</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mockNetworkImages</span><span class="p">(</span>
<span class="w">    </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="kt">Function</span><span class="p">()</span><span class="w"> </span><span class="n">testCode</span><span class="p">,</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">mockNetworkImagesFor</span><span class="p">(</span><span class="n">testCode</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 驗證輔助</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">Finder</span><span class="w"> </span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">reason</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">expect</span><span class="p">(</span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">,</span><span class="w"> </span><span class="nl">reason:</span><span class="w"> </span><span class="n">reason</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">expectWidgetNotExists</span><span class="p">(</span><span class="n">Finder</span><span class="w"> </span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">reason</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">expect</span><span class="p">(</span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="n">findsNothing</span><span class="p">,</span><span class="w"> </span><span class="nl">reason:</span><span class="w"> </span><span class="n">reason</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">expectWidgetCount</span><span class="p">(</span><span class="n">Finder</span><span class="w"> </span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">reason</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">expect</span><span class="p">(</span><span class="n">finder</span><span class="p">,</span><span class="w"> </span><span class="n">findsNWidgets</span><span class="p">(</span><span class="n">count</span><span class="p">),</span><span class="w"> </span><span class="nl">reason:</span><span class="w"> </span><span class="n">reason</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">expectTextExists</span><span class="p">(</span><span class="kt">String</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">reason</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">expect</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">text</span><span class="p">),</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">,</span><span class="w"> </span><span class="nl">reason:</span><span class="w"> </span><span class="n">reason</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 測試資料重置</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">resetMockData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 重置所有靜態測試資料</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 測試環境設定</span>
<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">setUpTestEnvironment</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 設定測試環境變數</span>
<span class="w">    </span><span class="n">TestWidgetsFlutterBinding</span><span class="p">.</span><span class="n">ensureInitialized</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">tearDownTestEnvironment</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 清理測試環境</span>
<span class="w">    </span><span class="n">resetMockData</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Mock 類別生成器註解</span>
<span class="nd">@GenerateMocks</span><span class="p">([</span>
<span class="w">  </span><span class="n">UserRepository</span><span class="p">,</span>
<span class="w">  </span><span class="n">UserRemoteDataSource</span><span class="p">,</span>
<span class="w">  </span><span class="n">UserLocalDataSource</span><span class="p">,</span>
<span class="w">  </span><span class="n">AuthRepository</span><span class="p">,</span>
<span class="w">  </span><span class="n">AuthRemoteDataSource</span><span class="p">,</span>
<span class="w">  </span><span class="n">AuthLocalDataSource</span><span class="p">,</span>
<span class="w">  </span><span class="n">NetworkInfo</span><span class="p">,</span>
<span class="w">  </span><span class="n">ValidationService</span><span class="p">,</span>
<span class="w">  </span><span class="n">LocalStorage</span><span class="p">,</span>
<span class="w">  </span><span class="n">ApiClient</span><span class="p">,</span>
<span class="w">  </span><span class="n">AnalyticsService</span><span class="p">,</span>
<span class="w">  </span><span class="n">LoggingService</span><span class="p">,</span>
<span class="p">])</span>
<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>

<span class="c1">// 手動 Mock 類別 (複雜行為模擬)</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MockUserViewModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Mock</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserViewModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">user</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isUpdating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">hasUser</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">setMockState</span><span class="p">({</span>
<span class="w">    </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">mockUser</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">mockIsLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">mockError</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">mockIsUpdating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockUser</span><span class="p">;</span>
<span class="w">    </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockIsLoading</span><span class="p">;</span>
<span class="w">    </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockError</span><span class="p">;</span>
<span class="w">    </span><span class="n">isUpdating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockIsUpdating</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MockAuthViewModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Mock</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">AuthViewModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">currentUser</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isAuthenticated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">setMockAuthState</span><span class="p">({</span>
<span class="w">    </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">mockUser</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">mockIsAuthenticated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">mockIsLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">mockError</span><span class="p">,</span>
<span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">currentUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockUser</span><span class="p">;</span>
<span class="w">    </span><span class="n">isAuthenticated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockIsAuthenticated</span><span class="p">;</span>
<span class="w">    </span><span class="n">isLoading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockIsLoading</span><span class="p">;</span>
<span class="w">    </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mockError</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MockThemeViewModel</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Mock</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ThemeViewModel</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">ThemeMode</span><span class="w"> </span><span class="n">themeMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">light</span><span class="p">;</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">isDarkMode</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">themeMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">dark</span><span class="p">;</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">setMockTheme</span><span class="p">(</span><span class="n">ThemeMode</span><span class="w"> </span><span class="n">mode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">themeMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="p">;</span>
<span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔬 單元測試設計</h2>
<h3>UseCase 測試範例</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置: test/unit/domain/usecases/get_user_profile_usecase_test.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:mockito/mockito.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:dartz/dartz.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../../helpers/test_helper.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../../helpers/test_helper.mocks.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span><span class="w"> </span><span class="n">useCase</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockUserRepository</span><span class="w"> </span><span class="n">mockRepository</span><span class="p">;</span>

<span class="w">  </span><span class="n">setUp</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">setUpTestEnvironment</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockUserRepository</span><span class="p">();</span>
<span class="w">    </span><span class="n">useCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetUserProfileUseCase</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">tearDown</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tearDownTestEnvironment</span><span class="p">();</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;GetUserProfileUseCase&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">testUserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;test_user_id&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">id:</span><span class="w"> </span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should return User when repository call is successful&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">useCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">Right</span><span class="p">(</span><span class="n">testUser</span><span class="p">)));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">      </span><span class="n">verifyNoMoreInteractions</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should return NotFoundFailure when user does not exist&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">useCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">Left</span><span class="p">(</span><span class="n">NotFoundFailure</span><span class="p">(</span><span class="s1">&#39;找不到指定的使用者&#39;</span><span class="p">))));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">      </span><span class="n">verifyNoMoreInteractions</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should return ValidationFailure when userId is empty&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">useCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">Left</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">(</span><span class="s1">&#39;使用者 ID 不能為空&#39;</span><span class="p">))));</span>
<span class="w">      </span><span class="n">verifyNever</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should return ServerFailure when repository throws exception&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenThrow</span><span class="p">(</span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;Database connection failed&#39;</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">useCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">isLeft</span><span class="p">(),</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">        </span><span class="p">(</span><span class="n">failure</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">expect</span><span class="p">(</span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="n">isA</span><span class="o">&lt;</span><span class="n">ServerFailure</span><span class="o">&gt;</span><span class="p">());</span>
<span class="w">          </span><span class="n">expect</span><span class="p">(</span><span class="n">failure</span><span class="p">.</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;取得使用者資料失敗&#39;</span><span class="p">));</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;Should return failure&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should handle multiple concurrent calls correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">any</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">100</span><span class="p">));</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">testUser</span><span class="p">;</span>
<span class="w">          </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">futures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span>
<span class="w">        </span><span class="m">5</span><span class="p">,</span>
<span class="w">        </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">useCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">futures</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">Right</span><span class="p">(</span><span class="n">testUser</span><span class="p">)));</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">)).</span><span class="n">called</span><span class="p">(</span><span class="m">5</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Edge Cases&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should handle null userId gracefully&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">useCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="kc">null</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">dynamic</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">isLeft</span><span class="p">(),</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">result</span><span class="p">.</span><span class="n">fold</span><span class="p">(</span>
<span class="w">        </span><span class="p">(</span><span class="n">failure</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">expect</span><span class="p">(</span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="n">isA</span><span class="o">&lt;</span><span class="n">ValidationFailure</span><span class="o">&gt;</span><span class="p">()),</span>
<span class="w">        </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;Should return validation failure&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should handle very long userId&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">longUserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1000</span><span class="p">;</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRepository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">longUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">id:</span><span class="w"> </span><span class="n">longUserId</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">useCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">longUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">isRight</span><span class="p">(),</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>

<h3>Repository 測試範例</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置: test/unit/data/repositories/user_repository_impl_test.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:mockito/mockito.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../../helpers/test_helper.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../../helpers/test_helper.mocks.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">UserRepositoryImpl</span><span class="w"> </span><span class="n">repository</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockUserRemoteDataSource</span><span class="w"> </span><span class="n">mockRemoteDataSource</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockUserLocalDataSource</span><span class="w"> </span><span class="n">mockLocalDataSource</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockNetworkInfo</span><span class="w"> </span><span class="n">mockNetworkInfo</span><span class="p">;</span>

<span class="w">  </span><span class="n">setUp</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">setUpTestEnvironment</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockRemoteDataSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockUserRemoteDataSource</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockLocalDataSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockUserLocalDataSource</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockNetworkInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockNetworkInfo</span><span class="p">();</span>

<span class="w">    </span><span class="n">repository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserRepositoryImpl</span><span class="p">(</span>
<span class="w">      </span><span class="nl">remoteDataSource:</span><span class="w"> </span><span class="n">mockRemoteDataSource</span><span class="p">,</span>
<span class="w">      </span><span class="nl">localDataSource:</span><span class="w"> </span><span class="n">mockLocalDataSource</span><span class="p">,</span>
<span class="w">      </span><span class="nl">networkInfo:</span><span class="w"> </span><span class="n">mockNetworkInfo</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">tearDown</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tearDownTestEnvironment</span><span class="p">();</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;getUserById&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">testUserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;test_user_id&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">UserResponse</span><span class="w"> </span><span class="n">testUserResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">(</span>
<span class="w">      </span><span class="nl">id:</span><span class="w"> </span><span class="n">testUserId</span><span class="p">,</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Test User&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;test@example.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">status:</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testUserResponse</span><span class="p">.</span><span class="n">toEntity</span><span class="p">();</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should return remote data when device is online&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">testUserResponse</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">testUserResponse</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{});</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">);</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">testUserResponse</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should return cached data when device is offline&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">testUserResponse</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">);</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">      </span><span class="n">verifyNever</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should fallback to cached data when remote fails&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenThrow</span><span class="p">(</span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;Network error&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">testUserResponse</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">);</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should throw UserException when both remote and local fail&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenThrow</span><span class="p">(</span><span class="n">ServerException</span><span class="p">(</span><span class="s1">&#39;Network error&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenThrow</span><span class="p">(</span><span class="n">CacheException</span><span class="p">(</span><span class="s1">&#39;Cache error&#39;</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act &amp; assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span>
<span class="w">        </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">),</span>
<span class="w">        </span><span class="n">throwsA</span><span class="p">(</span><span class="n">isA</span><span class="o">&lt;</span><span class="n">UserException</span><span class="o">&gt;</span><span class="p">()),</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should update cache with latest remote data&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">cachedUserResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">(</span>
<span class="w">        </span><span class="nl">id:</span><span class="w"> </span><span class="n">testUserId</span><span class="p">,</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Cached User&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;cached@example.com&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">status:</span><span class="w"> </span><span class="s1">&#39;inactive&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cachedUserResponse</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">testUserResponse</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">testUserResponse</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{});</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">getUserById</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="o">?</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="s1">&#39;Test User&#39;</span><span class="p">));</span><span class="w"> </span><span class="c1">// 確保是遠端資料</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">testUserResponse</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;createUser&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">newUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span>
<span class="w">      </span><span class="nl">id:</span><span class="w"> </span><span class="s1">&#39;new_user_id&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;New User&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should create user successfully when online&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">userResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserResponse</span><span class="p">(</span>
<span class="w">        </span><span class="nl">id:</span><span class="w"> </span><span class="n">newUser</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="n">newUser</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="n">newUser</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
<span class="w">        </span><span class="nl">status:</span><span class="w"> </span><span class="n">newUser</span><span class="p">.</span><span class="n">status</span><span class="p">.</span><span class="n">toString</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">).</span><span class="n">last</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">createUser</span><span class="p">(</span><span class="n">any</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">userResponse</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">userResponse</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{});</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">createUser</span><span class="p">(</span><span class="n">newUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">newUser</span><span class="p">.</span><span class="n">id</span><span class="p">));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">);</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">createUser</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">userResponse</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should throw NetworkException when offline&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockNetworkInfo</span><span class="p">.</span><span class="n">isConnected</span><span class="p">).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act &amp; assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span>
<span class="w">        </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">repository</span><span class="p">.</span><span class="n">createUser</span><span class="p">(</span><span class="n">newUser</span><span class="p">),</span>
<span class="w">        </span><span class="n">throwsA</span><span class="p">(</span><span class="n">isA</span><span class="o">&lt;</span><span class="n">NetworkException</span><span class="o">&gt;</span><span class="p">()),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="n">verifyNever</span><span class="p">(</span><span class="n">mockRemoteDataSource</span><span class="p">.</span><span class="n">createUser</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">      </span><span class="n">verifyNever</span><span class="p">(</span><span class="n">mockLocalDataSource</span><span class="p">.</span><span class="n">cacheUser</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>

<h3>ViewModel 測試範例</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置: test/unit/presentation/providers/user_view_model_test.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:mockito/mockito.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:dartz/dartz.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../../helpers/test_helper.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../../helpers/test_helper.mocks.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">UserViewModel</span><span class="w"> </span><span class="n">viewModel</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockGetUserProfileUseCase</span><span class="w"> </span><span class="n">mockGetUserProfileUseCase</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockUpdateUserProfileUseCase</span><span class="w"> </span><span class="n">mockUpdateUserProfileUseCase</span><span class="p">;</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockDeleteUserAccountUseCase</span><span class="w"> </span><span class="n">mockDeleteUserAccountUseCase</span><span class="p">;</span>

<span class="w">  </span><span class="n">setUp</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">setUpTestEnvironment</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockGetUserProfileUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockGetUserProfileUseCase</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockUpdateUserProfileUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockUpdateUserProfileUseCase</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockDeleteUserAccountUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockDeleteUserAccountUseCase</span><span class="p">();</span>

<span class="w">    </span><span class="n">viewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserViewModel</span><span class="p">(</span>
<span class="w">      </span><span class="nl">getUserProfileUseCase:</span><span class="w"> </span><span class="n">mockGetUserProfileUseCase</span><span class="p">,</span>
<span class="w">      </span><span class="nl">updateUserProfileUseCase:</span><span class="w"> </span><span class="n">mockUpdateUserProfileUseCase</span><span class="p">,</span>
<span class="w">      </span><span class="nl">deleteUserAccountUseCase:</span><span class="w"> </span><span class="n">mockDeleteUserAccountUseCase</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">tearDown</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tearDownTestEnvironment</span><span class="p">();</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;loadUserProfile&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">testUserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;test_user_id&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">id:</span><span class="w"> </span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should load user profile successfully&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">hasUser</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>

<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should set loading state correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">100</span><span class="p">));</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">testUser</span><span class="p">);</span>
<span class="w">          </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert - during loading</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">future</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// assert - after loading</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should handle error correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Failed to load user&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ServerFailure</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">)));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">hasUser</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should notify listeners when state changes&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">notifyCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">addListener</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">notifyCount</span><span class="o">++</span><span class="p">);</span>

<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">notifyCount</span><span class="p">,</span><span class="w"> </span><span class="n">greaterThan</span><span class="p">(</span><span class="m">0</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should clear previous error before loading&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">setError</span><span class="p">(</span><span class="s1">&#39;Previous error&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 假設有這個方法用於測試</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUserId</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="n">testUserId</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;updateProfile&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">originalUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">updatedUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">originalUser</span><span class="p">.</span><span class="n">copyWith</span><span class="p">(</span>
<span class="w">      </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Updated Name&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;updated@example.com&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">setUp</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">originalUser</span><span class="p">;</span><span class="w"> </span><span class="c1">// 設定初始使用者</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should update profile successfully&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockUpdateUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">any</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">updateProfile</span><span class="p">(</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Updated Name&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;updated@example.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isUpdating</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>

<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockUpdateUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should set updating state correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockUpdateUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">any</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">await</span><span class="w"> </span><span class="n">Future</span><span class="p">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span><span class="w"> </span><span class="m">100</span><span class="p">));</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>
<span class="w">          </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">updateProfile</span><span class="p">(</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Updated Name&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;updated@example.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert - during update</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isUpdating</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">future</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// assert - after update</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isUpdating</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should not update when user is null&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">updateProfile</span><span class="p">(</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Updated Name&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;updated@example.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">verifyNever</span><span class="p">(</span><span class="n">mockUpdateUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isUpdating</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should handle update error correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Update failed&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockUpdateUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">any</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">)));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">updateProfile</span><span class="p">(</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Updated Name&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;updated@example.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">originalUser</span><span class="p">));</span><span class="w"> </span><span class="c1">// 使用者未變更</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isUpdating</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;deleteAccount&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>

<span class="w">    </span><span class="n">setUp</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testUser</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should delete account successfully&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockDeleteUserAccountUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUser</span><span class="p">.</span><span class="n">id</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="kc">null</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">deleteAccount</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>

<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockDeleteUserAccountUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUser</span><span class="p">.</span><span class="n">id</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should return false when user is null&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">deleteAccount</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">verifyNever</span><span class="p">(</span><span class="n">mockDeleteUserAccountUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should handle delete error correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Delete failed&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockDeleteUserAccountUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUser</span><span class="p">.</span><span class="n">id</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Left</span><span class="p">(</span><span class="n">ServerFailure</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">)));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">deleteAccount</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span><span class="w"> </span><span class="c1">// 使用者仍存在</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">isLoading</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;refresh&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should refresh user data when user exists&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testUser</span><span class="p">;</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUser</span><span class="p">.</span><span class="n">id</span><span class="p">))</span>
<span class="w">          </span><span class="p">.</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Right</span><span class="p">(</span><span class="n">testUser</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">refresh</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">testUser</span><span class="p">.</span><span class="n">id</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should not refresh when user is null&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="n">refresh</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">verifyNever</span><span class="p">(</span><span class="n">mockGetUserProfileUseCase</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">any</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;clearError&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">test</span><span class="p">(</span><span class="s1">&#39;should clear error message&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">setError</span><span class="p">(</span><span class="s1">&#39;Test error&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 假設有這個方法</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="n">viewModel</span><span class="p">.</span><span class="n">clearError</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">viewModel</span><span class="p">.</span><span class="n">errorMessage</span><span class="p">,</span><span class="w"> </span><span class="n">isNull</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🖼️ Widget 測試設計</h2>
<h3>基本 Widget 測試</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置: test/widget/pages/user_profile_page_test.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:provider/provider.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:mockito/mockito.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:network_image_mock/network_image_mock.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../helpers/test_helper.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../helpers/test_helper.mocks.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">MockUserViewModel</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">;</span>

<span class="w">  </span><span class="n">setUp</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">setUpTestEnvironment</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockUserViewModel</span><span class="p">();</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">tearDown</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tearDownTestEnvironment</span><span class="p">();</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;UserProfilePage Widget Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should display loading indicator when isLoading is true&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockIsLoading:</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">          </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span>
<span class="w">        </span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">CircularProgressIndicator</span><span class="p">),</span>
<span class="w">        </span><span class="nl">reason:</span><span class="w"> </span><span class="s1">&#39;Loading indicator should be visible&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;載入使用者資料中...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should display user profile when user is loaded&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span>
<span class="w">        </span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;john@example.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="n">testUser</span><span class="p">.</span><span class="n">displayName</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="n">testUser</span><span class="p">.</span><span class="n">email</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;編輯個人資料&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">CircleAvatar</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should display error message when error occurs&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Failed to load user&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockError:</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">          </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;載入失敗&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;重新載入&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byIcon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error_outline</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should call refresh when refresh button is tapped&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Failed to load user&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockError:</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">          </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;重新載入&#39;</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">loadUserProfile</span><span class="p">(</span><span class="s1">&#39;test_id&#39;</span><span class="p">)).</span><span class="n">called</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should show error banner when error exists but user is loaded&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Update failed&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span>
<span class="w">        </span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">,</span>
<span class="w">        </span><span class="nl">mockError:</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byIcon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">error</span><span class="p">));</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byIcon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">close</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should dismiss error banner when close button is tapped&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Update failed&#39;</span><span class="p">;</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span>
<span class="w">        </span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">,</span>
<span class="w">        </span><span class="nl">mockError:</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">byIcon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">close</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">clearError</span><span class="p">()).</span><span class="n">called</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should show correct status chip based on user status&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">activeUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">status:</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">active</span><span class="p">);</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">activeUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;活躍&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Test different status</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">inactiveUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">status:</span><span class="w"> </span><span class="n">UserStatus</span><span class="p">.</span><span class="n">inactive</span><span class="p">);</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">inactiveUser</span><span class="p">);</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pump</span><span class="p">();</span>

<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;非活躍&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should navigate to edit profile page when edit button is tapped&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">mockNavigatorObserver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MockNavigatorObserver</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="nl">navigatorObservers:</span><span class="w"> </span><span class="p">[</span><span class="n">mockNavigatorObserver</span><span class="p">],</span>
<span class="w">              </span><span class="nl">home:</span><span class="w"> </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="nl">routes:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s1">&#39;/edit-profile&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">EditProfilePage</span><span class="p">(</span><span class="nl">user:</span><span class="w"> </span><span class="n">testUser</span><span class="p">),</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;編輯個人資料&#39;</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockNavigatorObserver</span><span class="p">.</span><span class="n">didPush</span><span class="p">(</span><span class="n">any</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should show loading indicator on buttons when isUpdating is true&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span>
<span class="w">        </span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">,</span>
<span class="w">        </span><span class="nl">mockIsUpdating:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;更新中...&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">CircularProgressIndicator</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should show delete confirmation dialog when delete button is tapped&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;刪除帳號&#39;</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">AlertDialog</span><span class="p">));</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;刪除帳號&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;確定要刪除此帳號嗎？此操作無法復原。&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;取消&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;刪除&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should call deleteAccount when delete is confirmed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>
<span class="w">      </span><span class="n">when</span><span class="p">(</span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">deleteAccount</span><span class="p">()).</span><span class="n">thenAnswer</span><span class="p">((</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;刪除帳號&#39;</span><span class="p">));</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;刪除&#39;</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">verify</span><span class="p">(</span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">deleteAccount</span><span class="p">()).</span><span class="n">called</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;UserProfilePage Responsive Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should adapt layout for different screen sizes&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act - Mobile screen</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMediaQuery</span><span class="p">(</span>
<span class="w">            </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">                </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">width:</span><span class="w"> </span><span class="m">375</span><span class="p">,</span><span class="w"> </span><span class="c1">// Mobile width</span>
<span class="w">            </span><span class="nl">height:</span><span class="w"> </span><span class="m">812</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert - Mobile layout</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">Column</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// act - Tablet screen</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMediaQuery</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">768</span><span class="p">,</span><span class="w"> </span><span class="c1">// Tablet width</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">1024</span><span class="p">,</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pump</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert - Layout should still work on tablet</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">UserProfilePage</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should handle dark theme correctly&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMediaQuery</span><span class="p">(</span>
<span class="w">            </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">              </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<span class="w">                </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">.</span><span class="n">light</span><span class="p">(),</span>
<span class="w">                </span><span class="nl">darkTheme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">.</span><span class="n">dark</span><span class="p">(),</span>
<span class="w">                </span><span class="nl">themeMode:</span><span class="w"> </span><span class="n">ThemeMode</span><span class="p">.</span><span class="n">dark</span><span class="p">,</span>
<span class="w">                </span><span class="nl">home:</span><span class="w"> </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="nl">platformBrightness:</span><span class="w"> </span><span class="n">Brightness</span><span class="p">.</span><span class="n">dark</span><span class="p">,</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">materialApp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">widget</span><span class="o">&lt;</span><span class="n">MaterialApp</span><span class="o">&gt;</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">MaterialApp</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">materialApp</span><span class="p">.</span><span class="n">darkTheme</span><span class="p">,</span><span class="w"> </span><span class="n">isNotNull</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;UserProfilePage Accessibility Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should have proper accessibility labels&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">Semantics</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// 檢查重要按鈕是否有適當的語義標籤</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">editButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;編輯個人資料&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">editButton</span><span class="p">,</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">);</span>

<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">deleteButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;刪除帳號&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">deleteButton</span><span class="p">,</span><span class="w"> </span><span class="n">findsOneWidget</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should be navigable with keyboard&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">testUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">();</span>
<span class="w">      </span><span class="n">mockViewModel</span><span class="p">.</span><span class="n">setMockState</span><span class="p">(</span><span class="nl">mockUser:</span><span class="w"> </span><span class="n">testUser</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">ChangeNotifierProvider</span><span class="o">&lt;</span><span class="n">UserViewModel</span><span class="o">&gt;</span><span class="p">.</span><span class="n">value</span><span class="p">(</span>
<span class="w">            </span><span class="nl">value:</span><span class="w"> </span><span class="n">mockViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="nl">child:</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">              </span><span class="n">UserProfilePage</span><span class="p">(</span><span class="nl">userId:</span><span class="w"> </span><span class="s1">&#39;test_id&#39;</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// 模擬 Tab 鍵導航</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">sendKeyEvent</span><span class="p">(</span><span class="n">LogicalKeyboardKey</span><span class="p">.</span><span class="n">tab</span><span class="p">);</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pump</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="c1">// 確保焦點可以在可交互元素之間移動</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">Focus</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="c1">// Mock Navigator Observer</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MockNavigatorObserver</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Mock</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">NavigatorObserver</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>

<h3>複雜 Widget 測試</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置: test/widget/widgets/user_list_widget_test.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../../helpers/test_helper.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;UserListWidget Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should display list of users&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUserList</span><span class="p">(</span><span class="m">5</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">              </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetCount</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">ListTile</span><span class="p">),</span><span class="w"> </span><span class="m">5</span><span class="p">);</span>

<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should handle empty user list&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">        </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">          </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">            </span><span class="nl">users:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">            </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;沒有使用者資料&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byIcon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person_outline</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should call onUserTap when user is tapped&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUserList</span><span class="p">(</span><span class="m">3</span><span class="p">);</span>
<span class="w">      </span><span class="n">User</span><span class="o">?</span><span class="w"> </span><span class="n">tappedUser</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">              </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">tappedUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">name</span><span class="p">));</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">tappedUser</span><span class="p">,</span><span class="w"> </span><span class="n">equals</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="m">1</span><span class="p">]));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should support pull to refresh&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUserList</span><span class="p">(</span><span class="m">3</span><span class="p">);</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">refreshCalled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">RefreshIndicator</span><span class="p">(</span>
<span class="w">              </span><span class="nl">onRefresh:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">refreshCalled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nl">child:</span><span class="w"> </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">                </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">                </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// 模擬下拉刷新</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">fling</span><span class="p">(</span>
<span class="w">        </span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">ListView</span><span class="p">),</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">Offset</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">300</span><span class="p">),</span>
<span class="w">        </span><span class="m">1000</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">refreshCalled</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should handle scroll to load more&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUserList</span><span class="p">(</span><span class="m">20</span><span class="p">);</span>
<span class="w">      </span><span class="kt">bool</span><span class="w"> </span><span class="n">loadMoreCalled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">              </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">              </span><span class="nl">onLoadMore:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">loadMoreCalled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// 滾動到底部</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">scrollUntilVisible</span><span class="p">(</span>
<span class="w">        </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">users</span><span class="p">.</span><span class="n">last</span><span class="p">.</span><span class="n">name</span><span class="p">),</span>
<span class="w">        </span><span class="m">500.0</span><span class="p">,</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">loadMoreCalled</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should show loading indicator when loading more&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUserList</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">              </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">              </span><span class="nl">isLoadingMore:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">CircularProgressIndicator</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should filter users based on search query&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;john@example.com&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Jane Smith&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;jane@example.com&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUser</span><span class="p">(</span><span class="nl">name:</span><span class="w"> </span><span class="s1">&#39;Bob Johnson&#39;</span><span class="p">,</span><span class="w"> </span><span class="nl">email:</span><span class="w"> </span><span class="s1">&#39;bob@example.com&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="p">];</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">              </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="n">TextField</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">key:</span><span class="w"> </span><span class="n">Key</span><span class="p">(</span><span class="s1">&#39;search_field&#39;</span><span class="p">),</span>
<span class="w">                  </span><span class="nl">onChanged:</span><span class="w"> </span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="c1">// 這裡應該觸發搜尋邏輯</span>
<span class="w">                  </span><span class="p">},</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">                </span><span class="n">Expanded</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">where</span><span class="p">((</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">                        </span><span class="n">user</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">().</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;john&#39;</span><span class="p">)).</span><span class="n">toList</span><span class="p">(),</span>
<span class="w">                    </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">],</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;John Doe&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;Bob Johnson&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetNotExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;Jane Smith&#39;</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;UserListWidget Performance Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should handle large list efficiently&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">largeUserList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUserList</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">stopwatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stopwatch</span><span class="p">()..</span><span class="n">start</span><span class="p">();</span>

<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">              </span><span class="nl">users:</span><span class="w"> </span><span class="n">largeUserList</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="n">stopwatch</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">stopwatch</span><span class="p">.</span><span class="n">elapsedMilliseconds</span><span class="p">,</span><span class="w"> </span><span class="n">lessThan</span><span class="p">(</span><span class="m">1000</span><span class="p">));</span><span class="w"> </span><span class="c1">// 應該在 1 秒內完成</span>

<span class="w">      </span><span class="c1">// 確保只渲染可見的項目（ListView.builder 的優勢）</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">listTiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">widgetList</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">ListTile</span><span class="p">));</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">listTiles</span><span class="p">.</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">lessThan</span><span class="p">(</span><span class="m">20</span><span class="p">));</span><span class="w"> </span><span class="c1">// 屏幕上不應該有太多 ListTile</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;should recycle list items efficiently&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// arrange</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">createMockUserList</span><span class="p">(</span><span class="m">100</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// act</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">mockNetworkImages</span><span class="p">(()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span>
<span class="w">          </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">wrapWithMaterialApp</span><span class="p">(</span>
<span class="w">            </span><span class="n">UserListWidget</span><span class="p">(</span>
<span class="w">              </span><span class="nl">users:</span><span class="w"> </span><span class="n">users</span><span class="p">,</span>
<span class="w">              </span><span class="nl">onUserTap:</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{},</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="c1">// 記錄初始的 ListTile 數量</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">initialTileCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">widgetList</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">ListTile</span><span class="p">)).</span><span class="n">length</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// 滾動列表</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">drag</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">ListView</span><span class="p">),</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Offset</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">2000</span><span class="p">));</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pump</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 再次檢查 ListTile 數量</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">afterScrollTileCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">widgetList</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">ListTile</span><span class="p">)).</span><span class="n">length</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// assert</span>
<span class="w">      </span><span class="c1">// ListView.builder 應該回收不可見的項目</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">afterScrollTileCount</span><span class="p">,</span><span class="w"> </span><span class="n">lessThanOrEqualTo</span><span class="p">(</span><span class="n">initialTileCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">5</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2>🔗 Integration 測試設計</h2>
<h3>完整流程測試</h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// 位置: test/integration/user_flow_test.dart</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_test/flutter_test.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:integration_test/integration_test.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../helpers/test_helper.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">IntegrationTestWidgetsFlutterBinding</span><span class="p">.</span><span class="n">ensureInitialized</span><span class="p">();</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;User Profile Flow Integration Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;complete user authentication and profile management flow&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 啟動應用程式</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 步驟 1: 使用者登入</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_performLogin</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 步驟 2: 導航到個人資料頁面</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_navigateToProfile</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 步驟 3: 查看個人資料</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_viewProfile</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 步驟 4: 編輯個人資料</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_editProfile</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 步驟 5: 驗證更新</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_verifyProfileUpdate</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 步驟 6: 測試錯誤處理</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_testErrorHandling</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;offline functionality test&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 啟動應用程式</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 模擬離線狀態</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_simulateOfflineMode</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 測試離線功能</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_testOfflineFunctionality</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 恢復線上狀態</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_simulateOnlineMode</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 測試數據同步</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_testDataSynchronization</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;error recovery flow test&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 啟動應用程式</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 模擬各種錯誤情況</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_testNetworkError</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_testValidationError</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_testServerError</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 測試錯誤恢復</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_testErrorRecovery</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Performance Integration Tests&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;app startup performance test&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">stopwatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stopwatch</span><span class="p">()..</span><span class="n">start</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 啟動應用程式</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="n">stopwatch</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// 驗證啟動時間</span>
<span class="w">      </span><span class="n">expect</span><span class="p">(</span><span class="n">stopwatch</span><span class="p">.</span><span class="n">elapsedMilliseconds</span><span class="p">,</span><span class="w"> </span><span class="n">lessThan</span><span class="p">(</span><span class="m">3000</span><span class="p">));</span><span class="w"> </span><span class="c1">// 3 秒內啟動</span>

<span class="w">      </span><span class="c1">// 驗證首頁載入</span>
<span class="w">      </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">HomePage</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="n">testWidgets</span><span class="p">(</span><span class="s1">&#39;memory usage test&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 啟動應用程式</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">pumpWidget</span><span class="p">(</span><span class="n">MyApp</span><span class="p">());</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 執行記憶體密集型操作</span>
<span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">_performMemoryIntensiveOperations</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 檢查記憶體使用情況</span>
<span class="w">      </span><span class="c1">// 這裡可以添加記憶體使用量檢查邏輯</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="c1">// 輔助方法</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_performLogin</span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 尋找登入按鈕</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">loginButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;登入&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">loginButton</span><span class="p">.</span><span class="n">evaluate</span><span class="p">().</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 如果沒有登入按鈕，可能已經登入</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 點擊登入按鈕</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">loginButton</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 輸入使用者名稱</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">enterTextAndSettle</span><span class="p">(</span>
<span class="w">    </span><span class="n">tester</span><span class="p">,</span>
<span class="w">    </span><span class="n">find</span><span class="p">.</span><span class="n">byKey</span><span class="p">(</span><span class="n">Key</span><span class="p">(</span><span class="s1">&#39;username_field&#39;</span><span class="p">)),</span>
<span class="w">    </span><span class="s1">&#39;test@example.com&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 輸入密碼</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">enterTextAndSettle</span><span class="p">(</span>
<span class="w">    </span><span class="n">tester</span><span class="p">,</span>
<span class="w">    </span><span class="n">find</span><span class="p">.</span><span class="n">byKey</span><span class="p">(</span><span class="n">Key</span><span class="p">(</span><span class="s1">&#39;password_field&#39;</span><span class="p">)),</span>
<span class="w">    </span><span class="s1">&#39;password123&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 提交登入表單</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;登入&#39;</span><span class="p">));</span>

<span class="w">  </span><span class="c1">// 等待登入完成</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 驗證登入成功</span>
<span class="w">  </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">HomePage</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_navigateToProfile</span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 點擊個人資料選項卡或按鈕</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">byIcon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">person</span><span class="p">));</span>

<span class="w">  </span><span class="c1">// 驗證導航成功</span>
<span class="w">  </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">UserProfilePage</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_viewProfile</span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 等待個人資料載入</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 驗證個人資料顯示</span>
<span class="w">  </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">CircleAvatar</span><span class="p">));</span>
<span class="w">  </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">textContaining</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">));</span><span class="w"> </span><span class="c1">// 電子郵件</span>
<span class="w">  </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectTextExists</span><span class="p">(</span><span class="s1">&#39;編輯個人資料&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_editProfile</span><span class="p">(</span><span class="n">WidgetTester</span><span class="w"> </span><span class="n">tester</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 點擊編輯按鈕</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;編輯個人資料&#39;</span><span class="p">));</span>

<span class="w">  </span><span class="c1">// 驗證編輯頁面開啟</span>
<span class="w">  </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">expectWidgetExists</span><span class="p">(</span><span class="n">find</span><span class="p">.</span><span class="n">byType</span><span class="p">(</span><span class="n">EditProfilePage</span><span class="p">));</span>

<span class="w">  </span><span class="c1">// 修改使用者名稱</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">nameField</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">byKey</span><span class="p">(</span><span class="n">Key</span><span class="p">(</span><span class="s1">&#39;name_field&#39;</span><span class="p">));</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="n">nameField</span><span class="p">);</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">enterTextAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">nameField</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Updated Name&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 修改電子郵件</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">emailField</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">byKey</span><span class="p">(</span><span class="n">Key</span><span class="p">(</span><span class="s1">&#39;email_field&#39;</span><span class="p">));</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">tester</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="n">emailField</span><span class="p">);</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">enterTextAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">emailField</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;updated@example.com&#39;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// 保存變更</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">tapAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">,</span><span class="w"> </span><span class="n">find</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;保存&#39;</span><span class="p">));</span>

<span class="w">  </span><span class="c1">// 等待保存完成</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">TestHelper</span><span class="p">.</span><span class="n">pumpAndSettle</span><span class="p">(</span><span class="n">tester</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
                    </div>
                </div>
            
                <div class="tab-pane fade" id="secrets" role="tabpanel" aria-labelledby="secrets-tab">
                    <div class="encrypted-content">
                        <div class="password-input-container">
                            <h4>🔒 此內容需要密碼存取</h4>
                            <div class="password-hint">
                                <div class="alert alert-info">
                                    <i class="fas fa-lightbulb"></i>
                                    <strong>提示：</strong>閱讀完整份文件即可知道密碼 😉
                                    <br>
                                    <small class="text-muted">仔細的做完每個練習 (🎯 實作練習)，密碼可能就在某個地方...</small>
                                    <br>
                                </div>
                            </div>
                            <div class="input-group mb-3">
                                <input type="password" class="form-control" id="password-secrets" 
                                       placeholder="Enter password" maxlength="15">
                                <button class="btn btn-primary" type="button" 
                                        onclick="decryptContent('secrets')">
                                    <i class="fas fa-unlock"></i> Unlock
                                </button>
                            </div>
                            <div class="password-attempts" id="attempts-secrets">
                                <small class="text-muted">Remaining attempts: <span id="remaining-secrets">3</span></small>
                            </div>
                        </div>
                        <div class="decrypted-content" id="decrypted-secrets" style="display: none;">
                        </div>
                    </div>
                </div>
            
        </div>
        <div id="debug-log"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    
        <script>
        (function() {
            'use strict';
            
            // 檢查 pako 庫是否載入
            if (typeof pako === 'undefined') {
                showMessage('解壓縮庫未載入，請重新整理頁面。', 'danger');
                return;
            }
            
            // 隱藏的誘餌數據陣列
            const _a56349d2033c8598 = ["sIsTQpxfL5c3/3FRUtcj4M5Dtudqs4XhPh8nKXIlslgiHECJ9VfpAiZP06Ar/DHv2yh6aNmtceUNwerLHeKNrtWzQM1unrmc4NxfnpVsWu1zzNpTfrAf30ktQFng0C2CSP2abiZ8m4jvOk2VeVaXP6ZmNVaW2+1JcYOmxkAxT0sqdomqpMm4X9iji/1uIqXLnv6a8AF9uSQq+zEEq3IN+kjmLVot91qQ8qzbNkRjtd0a1R2A5JCdkt9EowWf07WQSIkNzXgYo1E=", "fG5Jzga5o6SCtzP+6TexacLB1TiVQOv5PxjRleSVSPBfhnBaHcSHemeQRh1gF/p29Qz8wejmLImPRBgmKVAvPIsIEBmGFetq8N7p3S1zAOLRKyPp7rEYyfdRG4MZpK6937+ZCIQx0oinu8AKB98rV8gTKnH/TOwXTHCKBRMHd4mDA4NIbDC3kWD+AsKfmp4OuuumRTzsnYtxU817uVGsJg9rzHU8L0CcLn9XJoipDhk554lmKedYyKoYp2DQBWg+n8EMoNkcJhM=", "zDFtRk4Q1DghaZjPr/ps9Xs8CYeJIUs4w6H0X75+s2ixP5QCzTteEjwqwO4Mc4CzjwiOCQK2WTQqcnzHs9Qt85f0+g0dQmNq8XWllLOS5w2WahtygPGtWzfu40vWOTzSfNesK4goRwqlrT/672rjG/74pVUFF8btH0TL0y4EcTuwGg8odHE4fbmhSMC2gAUKwtsYbuRNrrVfl3OQQ07R538+74NPRN6bp2B14JWhIcEphseBfBn5t2Mn3JF7hVJlBVWws2b1NSU=", "L8kgH4w5YaVP5rVtSIJmRd4xp2OuIzLgggY5AFRgiiZLUTGMn9xbGcn44VFxN7++BnjLx0uTFk7eR8Zra0iR+QcO+bhH7pkPzt44b9gTXN8xanP2tRv7dfn71LQ4jYOM6cShxIGMj8cN2gmL/7x7c0OhB2Xbxeuf/jWk+yrh71OOxe3Vo++HjrR2NhagC7w5Z+pjk3C3g11wx8qu9RUTb+l+DUerzP51Sa6HFZci3FPGnOyasB/PtvYB4dyWCmzc0VTftxfSjvPoj7z3I3xGv8tFgpf5eJXH9gGaqDHh94hoT3/es10/CRxZ+I+acnyohJyI3SbvWbcxPxyabI/svcoV81YtzfiOJR73Z2pe4kmoKzF1JOEv611mlH26qdAQFIUnw0QvGmBWLUdurHOfY0mvYeCfBZbFhu7UmiUpxwgQgsUBaHGudubYLAi+I7R2K7BwfZuEDvbpt5hBcau3vGfoL+flKDCbbMqxaC05TJB035921VPlDH3rVLuYo246jLpjufbt7H/amdU5tgVeU5SvUFjSZprq42qzmfS08fchNyo70B9SvtlA/akqVrUjmJ5bPm2u5VdgVA4mUC7EUd9gsVHOzlq37tRhjTGKyvAMcrY6Omnxt4eBXPbR5fcjabJldp8FnVm2PrxfPo+tCRmKImSWOsnV+TOb8k75EX64YvxkqWTb/KrQmMOdaefHg5I9m7cSRdZ6IL23Ee+qup0lpLFXIci7lSI+gK1VsJlEwHPZNXvPu+GlRLiB8Sm+tu3pj7Zn1xwOLssMOIRR4j6kSjd3Knxgzljzx7ru1ps73RkYvrwn6/aPXvk+cA8TBvmaZL3GJhmnSOinnX9wVLf19HwgzcJk1NRIOdHsSTEyCH0F+MK6ZWmpf9zntZnfi4iZxK3+SI4UHn+Lk/f9UrveeslEXhS5y6POD9w/diB5IFQoMynPSih34csL3zpiNI5PgyT2o2Hs7iv/6B83CDcaGyWRYwD8qdgBsp8D/Q73ZPFVMzQN0gly9r4nqEBsUpWuMtg+vwXKYaBWo2+oTgZNfGaVjEriU1g17mezxSraC/IBYP/A2NvMinDudMykTwK7doNwLO/jV31F/OuTDL7bPXxCGrd6CnJJAdabWc5oVjSrganCwjJrh2cmfa/vZT8+65IJsBu8WOwXNYDJEUSfYHooQJX3dc0vqU1cfIzzKA92J80hJp5Arm4y/zDLJ42AiWKaYI9IE1PNRYkzF63I8Lhn+patjYb8wqhGMWVGNjrhj8wvXxxDoFdcy2WAuezYNJhXX4/5gEYj0gvJptuPYFJqX/aOx39lX8Jv8DJb7Z3tX5vNhREgxHG7mrPiPR02dEB9IGVTTmcBsxiG8vUrSscCfgInVzK5CuicTeYZbt9BRTBRxD0tmqZIwExvRMlE6vfEB5N9sORZtlAHG2N+jtq3+VVTAwWXj6kpEsAPw3/nEfLPI4lFyCd+t2u7xUFm8AhTnxVazqKO2RttWartA9Z8UMucdZ7+/nIRXPeYovVj9ISIymLPSmHlK6AeIC7/s1gX3iRVpLlwKZqXX9tGfA7SovKKPVViO2P1e1J/JAQFJkGKzZIKgsJbKGMng2xlhc947OYY6Vp7FE+mc6tzfhJWl2TeOMbTsfJJCkf/v3TAXSZV5wW1U7y7YPGVT+XHEwRR3y7HYIakyhE/BlDIK5WVlodX4yqWAqrplSgeO3c/nyHfEAWybHaPI08dvCGY6GpoRckQ+J75vwelRtcy/O60as0UAgZdsg1B6ER08EbjOGP7bTZgerpSvc3lB9jUkxHOzv/X0g0R1o/WVi9RsBlYjRDuq9HEG2nZyKX3FSo9HNUk4FZaCWQ+QC5NGki3QJUMHgfP1YEWHYRkYvtHieGmUONy7r/9iN89b8WjmE+UUCpRBSbu+oiT6TEXSrnupSYUSLq0CQVF6KYoGw/ODmCUVnkZXnvQTAcT5CXeJqr1ePWjIWfq2B0GMZGmduGQcOBKuTi9p2Z4QzmhXWL7h8eSs0HtpPZGg4jM3uRkis+AqTxqDwIymt77vGbWIsPKAKFJw5rzuSaZrNoc0tRPAwocTCgKTKrWbvty42gsp/wP/x23brQjw0ezRtER6h5ZAEg1AkmCzFD8PutXtIIPJQL8/Z4SC4aVgyGbddhKd58rjZh6jC1txOdXw1WMGOC7FZhUi+3cOc+ZAmqoMMEdPVXiV4lXoiH2rgWhFxL1AlXzhLZsr9H4luZwhMi5GtEDPIrAMNBOcmqlY0YGdwIlmVrkFfPMpX1+LVSPLG51f2WqiQ8ou897zzQODYKPHuaHk0E5wxWHeBj1HIZY3+VKr9eKwkeEPwDBZgckO/UqqpQlHZyiE9esHDSkp08y4JnXDuUyak6nsC30NnclVcoPpFIXU540L2HqyyXIG5yMCGBtcf4+jXw5ImxyLPVO8q76adn9qmbOtnLR6HZu8GF2GNuBVJnGVJ+f6kABIFI8pRrUv/ZUJN8jVztqjlwXxwY/IME4YaEQXkA5Yamedcbs8XmqM5El1O//3E4vZEasdWIT4f18AYUC1KVWyTyk34GQMp/I2yIsGUs1JeIBBFv7tYNIIiNDr9N0ZUnwkC0LpUhhIPSxGfZBBlSrXZkjGFSwOrZ8eeoh/TKI/Seydm3yswwoahc2q3wgPHCVMebLiExYSNWOQxunCQOuB1Qn2IFK4X8xCBLLe01ZcicoSvnkImW0Q8IXFqcTWSgzjQ6EpJz8u1FppfeWBpzMiuN6hzjZG8cfRLlhF34jYxTtsZpCEzp2OVJ8qkxKnbecO/5cfJkm2e21cZb5AoimBYZCKhF87RrQ8gPjqlnRSjXmvOxaKxFMfwBhx/YNB60bamnjwneOzhncQQ2OJRe8IASkxsVp7Y/TwCdD1JFdN41NCLmQOZ+0HQ7C0UIvOwOdIPc+xvnndrgo/FPcONEVq+yS9pfE4wJdKgJnmGbEgZ52VIOENkrUjXz3+sMc6Rkpsdm5aHkpfe9TM3VM5kirDhRARGFSSBZ+hsPLovlLiMIiu7vA54831dXOZNqDXs+MwyRgHXXy578vCpxvW6/gHQA8PJpfLGrbFXldsmG0ifxZpaOOcL5EtC0DJUB6An6Mye99dr4Lq39haFLNZvUqkITPaxxWZALZ0cbV4e5VaTux4wl+nDWHsG4vTRf9Jb2SL/Gl2/439xKcK21DMYQ8h0FQ8vXOxgxao936QRTdwVOreQWF7odEuRVtdR2DzVz6OdalyDLGBdAzkrmIKg1flERh6LJaGrgzlPaHPHQpurmZVVEHHjtVsceA6DJ4Roe2dnWOsj8iHRXscoNYgE7mHRwmz4binYlP6XFiPckG3X4KQWsdKCG/AP01ZFtEkHFaskYRd4/zKmEy2eVDQXylnmnW42p++favd0TrrYni7uSHjCtsfBjxETuSVszjVKn0yNATce9tLhMKm/KBwiJ1FTTle5tdilDyysfi1S6qSi1sSsqH0AOr+BFhFYZjfkpD+B8htPaH+5PUXXlmrEVHuY9+0vSrd+ZGV099X64WXKbpfXGwD66/CPSbN2PvkceoOEycusAoHyWITSJJpmglD66vkwVET6vS3Yp0xZrmv2sY+OWnSVycBWEUfYlhowoR2HcBhkqsFb2VHMxhUqJ/aNtRWKVGPYNYzjxdfMmNIZ++eAji1JqjJISG0Jdhf/tz60J2ZYBLFNW1L3CUBJj7DnpdpnaMN5rsxE7p49dsr4DksuwL5hZlTHYzeGdK694+CEOaMIhjPNKT7DGicC8aGW7MwNaYO2rP0IyLAxhVRh0TQER8ejQ2sGj4q/fdkC2uMr5Ooiw+Saioo0cIT4RTQHEcrRiupHTaDO7knzH8FpSuxVNAurAOPwVqq48sZOjh/2/0U4xxUM1wpfVsim7k7gTpOqmL+WUJVYDv3JBGZbFQbCFVBdm0wtM07dxZpJfiopi0w8e0mWigi+UxqwLhWrtWlyee3o3Jg2CpqhRhnpn4Y/gIhgBk/JMa2bPGrtXxwd37mFFSmyukx3ts+rN1aMNuDs2Fu7l3drY5LtkK/me5lmz8eO/jw8RDo2u1xzgtyEf/Z8YykEf8NTCNC7DrYWD+rrEvROJfavJ+8BpOdytkR6u2U8LX64rnT2xhTsQDn1xDV6TRB9iM9v538SLffyk/mnujHU246qHt3Dn3J4Rx6lp+kyelkF2JxoNPpdlfkP1A2kTQHErklk9pkPk17HpwgQbiV924VtBFn9xDTnc1XXEu+pL/KA6XW/8w1Ss/U8n3qovRPQNxEA+BMUtKsiu6psBJMO0jnNu8K/oLIVHv+QuC8ij1hMs94K3AzbQ32kJdRUZdDugNqHi5L7nb/1+FaWiSav9tUmFEA7QPa+LhQWMIL32Ku6u2dMp2XhprjHZMpOZqqYDIir2mJg3gefZkg4TpVWKBKpLFcZFnonfB6ODh5MHcH8WlsXT+paFQoHW6HA==", "aY21OpkXHwFIxWaLjWOWZaaPTf7oE3/BmMhGiYQ6fGqqaSaMSnYyexEjBjc2vBvYFLz9mHEU7lnwzHpQFg9of526MdVIgfz3eLsS13yCt/GhWQnFA01bpuZPN1oKityvMaEQLbX2EyK1WuoFr52wLPUEQGbz5as8A5A85l8sxfnSf6tEk9iCCgBD4Ym5uPrLzginEyDS6ZHgJYQaij8Pj/pMl6o1wB0lr+2DlrC1NLR3x04eX5pyJq+YM7v4mEvXUFTq4ckRKbk=", "IpaofwWVTzT6lEiTXg0Tzk6shPK9ZKVwg4s+wJ9scCv47UWEk/jOJ0Cc8UA9G7jexARgLL/MlipjAAnyKKMRpderS25VUknsajhZsxMDF7vRIbdUWnZmR92Gzzr/C1JtOHWfKyws39Y67jgKcTc1VT2KQNXXWEF49ZfqMMHapxcB3J3WH6KPOuOjOfXSPmQkqMfQ4cpOJrqPuCyJFiQ7zd8jdbu8woOIXjhQstsiV9hO5Ywht1+qOv53NE8rPQ+dqoY3FwW2Bao="];
            const _a27d5196fcf03bac = 3;
            
            // 簡化的密碼驗證函數
            const _55a98efb81ca032a = async (_6a2ead68ee1e4bf1) => {
                try {
                    if (_6a2ead68ee1e4bf1 === '19831203') {
                        return true;
                    }
                    
                    // 其他密碼用雜湊驗證
                    const encoder = new TextEncoder();
                    const data = encoder.encode(_6a2ead68ee1e4bf1);
                    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                    return hashHex === 'aa7be44b20d28e6ba8e37d354bcb25a6f34b8ce12f2555a574f8ea4eb3868356';
                } catch (error) {
                    console.error('密碼驗證錯誤:', error);
                    return false;
                }
            };
            
            // 簡化的解密函數
            const _4675d3493d27c8a2 = async (_baf0e322491b4195, _b27933507d32b7b3) => {
                try {
                    showMessage('開始解密過程...', 'info');
                    
                    // 獲取加密內容
                    const _8780b9ed66e3e60b = _a56349d2033c8598[_a27d5196fcf03bac];
                    if (!_8780b9ed66e3e60b) {
                        throw new Error('找不到加密內容');
                    }
                    
                    console.log('加密內容長度:', _8780b9ed66e3e60b.length);
                    
                    // Step 1: Base64 解碼
                    showMessage('執行 Base64 解碼...', 'info');
                    const _cdb08e67fe1b0197 = Uint8Array.from(atob(_8780b9ed66e3e60b), c => c.charCodeAt(0));
                    console.log('Base64 解碼後長度:', _cdb08e67fe1b0197.length);
                    
                    // Step 2: 反混淆 (XOR)
                    showMessage('執行反混淆處理...', 'info');
                    const obfuscationKey = 'flutter_obfuscation_key_2024';
                    const _d25a99258861fe6a = new Uint8Array(_cdb08e67fe1b0197.length);
                    for (let i = 0; i < _cdb08e67fe1b0197.length; i++) {
                        _d25a99258861fe6a[i] = _cdb08e67fe1b0197[i] ^ obfuscationKey.charCodeAt(i % obfuscationKey.length);
                    }
                    console.log('反混淆後長度:', _d25a99258861fe6a.length);
                    
                    // Step 3: 密碼解密 (XOR)
                    showMessage('執行密碼解密...', 'info');
                    const passwordBytes = new TextEncoder().encode(_b27933507d32b7b3);
                    const _fd5297778cdc187d = new Uint8Array(_d25a99258861fe6a.length);
                    for (let i = 0; i < _d25a99258861fe6a.length; i++) {
                        _fd5297778cdc187d[i] = _d25a99258861fe6a[i] ^ passwordBytes[i % passwordBytes.length];
                    }
                    console.log('密碼解密後長度:', _fd5297778cdc187d.length);
                    
                    // Step 4: 解壓縮
                    showMessage('執行數據解壓縮...', 'info');
                    const decompressed = pako.inflate(_fd5297778cdc187d, { to: 'string' });
                    console.log('解壓縮成功，內容長度:', decompressed.length);
                    
                    showMessage('解密完成！', 'success');
                    return decompressed;
                    
                } catch (error) {
                    console.error('解密錯誤:', error);
                    showMessage(`解密失敗: ${error.message}`, 'danger');
                    throw error;
                }
            };
            
            // 嘗試次數限制
            let _79ee66af71767ed6 = 0;
            const _88ed4bfd11783a41 = 3;
            let _42e2ba542215ea50 = false;
            
            // 主要解密函數
            window.decryptContent = async (_baf0e322491b4195) => {
                if (_42e2ba542215ea50) {
                    showMessage('嘗試次數過多，請重新整理頁面。', 'danger');
                    return;
                }
                
                const passwordInput = document.getElementById('password-' + _baf0e322491b4195);
                const password = passwordInput.value.trim();
                
                if (!password) {
                    showMessage('請輸入密碼', 'warning');
                    return;
                }
                
                try {
                    // 驗證密碼
                    showMessage('驗證密碼...', 'info');
                    const isValid = await _55a98efb81ca032a(password);
                    
                    if (!isValid) {
                        _79ee66af71767ed6++;
                        const remaining = _88ed4bfd11783a41 - _79ee66af71767ed6;
                        
                        if (remaining <= 0) {
                            _42e2ba542215ea50 = true;
                            passwordInput.disabled = true;
                            passwordInput.nextElementSibling.disabled = true;
                            showMessage('已超過最大嘗試次數，頁面已鎖定。', 'danger');
                            return;
                        }
                        
                        showMessage(`密碼錯誤，剩餘 ${remaining} 次嘗試機會。`, 'warning');
                        passwordInput.classList.add('error-shake');
                        setTimeout(() => passwordInput.classList.remove('error-shake'), 500);
                        
                        const remainingSpan = document.getElementById('remaining-secrets');
                        if (remainingSpan) {
                            remainingSpan.textContent = remaining;
                        }
                        return;
                    }
                    
                    // 解密內容
                    showMessage('密碼正確，開始解密...', 'success');
                    const decryptedContent = await _4675d3493d27c8a2(_baf0e322491b4195, password);
                    
                    // 轉換 Markdown 為 HTML
                    const htmlContent = markdownToHtml(decryptedContent);
                    
                    // 顯示解密內容
                    const passwordContainer = document.querySelector('.password-input-container');
                    if (passwordContainer) {
                        passwordContainer.style.display = 'none';
                    }
                    
                    const decryptedDiv = document.getElementById('decrypted-' + _baf0e322491b4195);
                    if (decryptedDiv) {
                        decryptedDiv.innerHTML = htmlContent;
                        decryptedDiv.style.display = 'block';
                        decryptedDiv.classList.add('success-animation');
                    }
                    
                    // 重新高亮程式碼
                    if (typeof Prism !== 'undefined') {
                        Prism.highlightAllUnder(decryptedDiv);
                    }
                    
                } catch (error) {
                    showMessage(`解密失敗: ${error.message}`, 'danger');
                }
            };
            
            // 基本的安全措施
            document.addEventListener('contextmenu', e => e.preventDefault());
            document.addEventListener('selectstart', e => e.preventDefault());
            document.addEventListener('keydown', (e) => {
                if (e.key === 'F12' || 
                    (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'C')) ||
                    (e.ctrlKey && (e.key === 'u' || e.key === 'U'))) {
                    e.preventDefault();
                    return false;
                }
            });
            
        })();
        
        // 輔助函數
        function showMessage(message, type) {
            const oldAlert = document.querySelector('.temp-alert');
            if (oldAlert) oldAlert.remove();
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} temp-alert`;
            alertDiv.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'times-circle'}"></i>
                ${message}
            `;
            
            const container = document.querySelector('.main-container');
            container.insertBefore(alertDiv, container.firstChild);
            
            setTimeout(() => {
                if (alertDiv.parentNode) alertDiv.remove();
            }, 3000);
        }
        
        function markdownToHtml(markdown) {
            let html = markdown;
            
            // 基本的 Markdown 轉換
            html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
            html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
            html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');
            html = html.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
            html = html.replace(/`([^`]*)`/g, '<code>$1</code>');
            html = html.replace(/\*\*([^*]*)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*([^*]*)\*/g, '<em>$1</em>');
            html = html.replace(/^- (.*)$/gm, '<li>$1</li>');
            html = html.replace(/^\d+\. (.*)$/gm, '<li>$1</li>');
            html = html.replace(/((?:<li>.*<\/li>\s*)+)/gs, '<ul>$1</ul>');
            html = html.replace(/\n\n/g, '</p><p>');
            html = html.replace(/\n/g, '<br>');
            html = '<p>' + html + '</p>';
            html = html.replace(/<p>(\s*<\/p>)/g, '');
            
            return html;
        }
        
        function showSecrets() {
            const secretsNavItem = document.getElementById('secrets-nav-item');
            const secretsTab = document.getElementById('secrets-tab');
            
            if (secretsNavItem && secretsTab) {
                secretsNavItem.classList.remove('d-none');
                const tab = new bootstrap.Tab(secretsTab);
                tab.show();
                showMessage('🔍 發現隱藏內容！請輸入密碼解鎖...', 'info');
            } else {
                showMessage('❌ 找不到加密內容。', 'warning');
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const passwordInputs = document.querySelectorAll('input[type="password"]');
            passwordInputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const button = input.nextElementSibling;
                        if (button && button.onclick) {
                            button.click();
                        }
                    }
                });
            });
            
            if (typeof Prism !== 'undefined') {
                Prism.highlightAll();
            }
            
            window.showSecrets = showSecrets;
        });
        </script>
        
</body>
</html>
